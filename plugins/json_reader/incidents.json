{"5567": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 2 DAYS AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Elbow Lake and Elbow Lake #2 Fires\";\r\n\tvar defLat =  45.589444444444;\r\n\tvar defLng =  -113.27944444444;\r\n\tvar defLon =  -113.27944444444;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  45.589444444444;\r\n\tvar detailLng =  -113.27944444444;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  45.589 latitude, -113.279 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><p>The Elbow Lake fires were contained on August 31, 2017. These fires will be monitored and accessed for any additional activity.</p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-01T10:21:56-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Tuesday August 29th, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">D. Suko</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Size</th><td class=\"cell3\">2 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">100%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Thursday August 31st, 2017 approx.   06:15 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Lodgepole, Subalpine Fir</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>The fire was contained August 31, 2017</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Monitor </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>All personnel will come off the fire today, September 1, 2017.</p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Red Flag Warning in effect until Sept. 1, 9:00 p.m.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Elbow Lake fires were contained on August 31, 2017. These fires will be monitored and accessed for any additional", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5567/", "type": "text/html", "rel": "alternate"}], "title": "Elbow Lake and Elbow Lake #2 Fires (Wildfire)", "geo_lat": "45.589444444444", "summary": "The Elbow Lake fires were contained on August 31, 2017. These fires will be monitored and accessed for any additional", "county": "Beaverhead County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Elbow Lake and Elbow Lake #2 Fires (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5567/", "published": "Fri, 01 Sep 2017 10:22:51 -05:00", "geo_long": "-113.27944444444", "where": {"type": "Point", "coordinates": [-113.27944444444, 45.589444444444]}, "id": "https://inciweb.nwcg.gov/incident/5567/"}, "5397": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">CLOSURE</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Meyers Fire Closure Area September 2, 2017</strong><br/>The area closure on the Beaverhead-Deerlodge National Forest around the Meyers Fire has been expanded to include areas in the Anaconda-Pintler Wilderness. This includes the Continental Divide Trail... <a class=\"more\" href=\"/incident/article/5397/39791/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 2 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Meyers Fire\";\r\n\tvar defLat =  45.995277777778;\r\n\tvar defLng =  -113.57972222222;\r\n\tvar defLon =  -113.57972222222;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  45.995277777778;\r\n\tvar detailLng =  -113.57972222222;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  45.995 latitude, -113.58 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><p><a href=\"https://www.facebook.com/1540138089548920/videos/2018631701699554/\" target=\"_self\"><font size=\"3\">Operations Briefing Video for September 2nd, 2017</font></a><font size=\"2\"><font color=\"#000000\"><b style=\"mso-bidi-font-weight: normal;\"><br/> <br/>Current Size: </b> 30,486 acres<br/><b style=\"mso-bidi-font-weight: normal;\">Resources Assigned</b>: 322 </font></font></p><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p align=\"center\" style=\"margin: 4pt 0in; text-align: center;\"><br/><font size=\"3\">Inciweb is currently having trouble with uploading the map. Please click </font><a href=\"https://www.facebook.com/1540138089548920/photos/pcb.2018144715081586/2018143965081661/?type=3&amp;theater\" target=\"_blank\"><font size=\"3\">here</font></a><font size=\"3\"> to see the map on Facebook.</font></p><p align=\"center\" style=\"margin: 4pt 0in; text-align: center;\"><font color=\"#000000\"><b>Extreme fire conditions. No campfires allowed.</b></font><br/> <br/> </p><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 4pt 0in;\"><font size=\"2\"><font color=\"#000000\"><b style=\"mso-bidi-font-weight: normal;\">Status:</b> The fire is burning in mixed conifer stands, primarily lodgepole pine, Douglas fir, and subalpine fir, with numerous standing dead trees. There are residences still at risk in the Moose Lake, Frog Pond, Springer Memorial Park and Bonanza areas.</font></font></p><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 4pt 0in;\"><font size=\"2\"><font color=\"#000000\"><b style=\"mso-bidi-font-weight: normal;\">Yesterday\u2019s Activities: </b>Fire activity was not as intense as on Thursday, but the periphery did continue to expand in several areas with some short-range spotting, torching and fire runs occurring. The eastern edge of the fire south of Moose Lake advanced beyond the Continental Divide Trail into Deer Lodge County, with some additional spotting ahead of the fire. The Moose Lake and East Fork Bitterroot communities remain in a pre-evacuation warning status. Along the fire\u2019s west edge, ground crews made progress on control lines and burn outs, and continued structure protection measures in the Frog Pond and East Fork Bitterroot communities. Hand crews and heavy equipment neared completion of a control line running east from Zeke\u2019s Meadow, which itself was partially burned out today to increase holding capabilities along the north edge.</font></font></p><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 4pt 0in;\"><font size=\"2\"><font color=\"#000000\"><b style=\"mso-bidi-font-weight: normal;\">Current Resources: Three</b> 20-person crews, <b style=\"mso-bidi-font-weight: normal;\">twenty</b> engines, <b style=\"mso-bidi-font-weight: normal;\">four</b> pieces of heavy equipment (dozers, masticators), <b style=\"mso-bidi-font-weight: normal;\">ten </b>water tenders, and <b style=\"mso-bidi-font-weight: normal;\">three</b> helicopters. Total personnel: <b style=\"mso-bidi-font-weight: normal;\">322</b>.</font></font></p><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 4pt 0in;\"><font size=\"2\"><font color=\"#000000\"><b style=\"mso-bidi-font-weight: normal;\">Today\u2019s Activities:</b> Fire weather will intensify again today and tomorrow after yesterday\u2019s slight reprieve. Spotting of \u00bc to \u00bd mile may occur. Fire activity will increase, especially along the southwest, south, and southeast edges of the fire. Fire staff will work on building a machine and hand line ahead of the southwest edge of the fire to protect the East Fork Bitterroot structures. Structure protection efforts will continue here, at Frog Pond, Moose Lake, and other isolated buildings. Crews will continue burn out operations to reduce unburned fuels between the fire and the Frog Pond area. Because of the potential for increased fire activity along the east side, the Moose Lake community will be a main focus of attention today.</font></font></p><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 4pt 0in;\"><font size=\"2\"><font color=\"#000000\"><b style=\"mso-bidi-font-weight: normal;\">Evacuations: </b>The Frog Pond area is under an evacuation order. Moose Lake residents are under an evacuation warning. Additionally, an evacuation warning is in effect on East Fork Rd from FS Rd 5778 to Little East Fork Rd (FS RD 724) on the Bitterroot National Forest.</font></font></p><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 4pt 0in;\"><font size=\"2\"><font color=\"#000000\"><b style=\"mso-bidi-font-weight: normal;\">Restrictions/Closures: </b>Bitterroot National Forest emergency closure orders are in effect for upper areas of the East Fork Bitterroot River.<b style=\"mso-bidi-font-weight: normal;\"> </b>Beaverhead-Deerlodge National Forest<b style=\"mso-bidi-font-weight: normal;\"> </b>emergency closure orders are in effect around the fire area.<b style=\"mso-bidi-font-weight: normal;\"> </b>The closure of Forest Roads 893, 8684 and 8685 was rescinded at 6:00AM Friday, September 1, 2017. A temporary flight restriction (TFR) is in effect surrounding the Meyers Fire area. Granite County is under Stage 2 fire restrictions for private lands in the county. Amended Stage 1 fire restrictions have gone into effect today which prohibit <b style=\"mso-bidi-font-weight: normal;\">ALL</b> campfires in southwestern Montana, including in fire rings and developed recreation areas. </font></font></p><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 4pt 0in;\"><font color=\"#000000\"><font size=\"2\"><b style=\"mso-bidi-font-weight: normal;\">For further information</b>, </font></font><font color=\"#000000\" size=\"2\">follow the </font><a href=\"https://www.facebook.com/US-Forest-Service-Beaverhead-Deerlodge-National-Forest-1540138089548920/\"><font color=\"#0000ff\" size=\"2\">Beaverhead-Deerlodge National Forest Facebook</font></a><font color=\"#000000\" size=\"2\"> and </font><a href=\"https://www.facebook.com/DiscoverBitterrootNF\"><font color=\"#0000ff\" size=\"2\">Bitterroot National Forest Facebook</font></a><font color=\"#000000\" size=\"2\"> pages.</font></p><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T20:48:43-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Friday July 14th, 2017 approx.   05:30 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">25 miles SW of Philipsburg, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Irv Leach, ICT2</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Wildfire</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">333</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">30,486 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">5%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Saturday October 21st, 2017 approx.   12:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>The fire is primarily burning within mixed conifer stands dominated by lodgepole pine, Douglas-fir and subalpine fir with a moderate dead/down component from beetle kill.  Bug killed standing timber comprises approximately 20-40% of the area.  ERC-G is above 97%.  100 and 1000 fuel moistures are 6% and 7%, respectively.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Moderate to mostly extreme fire behavior with sustained uphill runs, group torching, and long-range range spotting.</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Division I will continue structure prep in high priority areas within the northeast side of the two subdivisions in the East Fork Bitterroot drainage and continue strategy for containment lines utilizing heavy equipment and hand crews.  Burn operations are being conducted in Division K to keep wildfire from impacting structures. Line prep utilizing hand crews in DIV T for potential line on the 4th. Line improvement in Division T from Zeke's Meadow to Lone Pine Ridge. Continue to monitor fire progression in Divisions A, E, K, T, and W. Continue to support IA responsibilities within the designated Initial Attack Responsibility area. Continue to implement structure protection measures at Moose Lake, Frog Pond, and Senate Mine. Implement suppression strategies commensurate with values at risk. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>12 Hours: Along the northern perimeter (Div R) the fire will continue to move to the north and east near Zeke Meadows. Spotting potential will be \u00bc to \u00bd mile. </p>\n<p>Along the western perimeter (Div K) the fire will move east of the Frog Pond Burn area.  The fire will also continue backing into the wind to the west.   </p>\n<p>Along the southern perimeter (Div I) the fire will back into the wind to the west and move upslope to the northeast within Section 35 at the Div K/I break.  The fire will also move east of Cliff Point and south into the 2000 Mussigbrod Burn.  Spotting potential will be \u00bd to 1 mile.</p>\n<p>Along the eastern perimeter (Div E) near DP 19 (Moose Lake Road) the fire will continue moving to the east of the Moose Creek Road.  Spotting potential will be \u00bc to \u00bd mile.  Possible for crown fire activity to moderate due to smoke from fire in Divs K and I. </p>\n<p>24 Hours: Fire activity expected to intensify due to continued warm and dry conditions and a Haines of 6 (high).</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>The Meyers fire area continues to include 3621 final acres of the Whetstone Ridge Fire.</p>\n<p>Land Ownership: USFS - 30,470 acres; Private - 16 acres.</p>\n<p>The structure group has triaged and/or prepared 82 structures nearest to the fire.  These numbers are for both Meyers and Whetstone Ridge fires.  </p>\n<p>Cost for the Whetstone Ridge fire is currently captured under the Meyers fire.</p>\n<p>A timber task force (not shown on the Resources list) is currently working  on control lines in the East Fork Bitterroot.</p>\n<p>A long-term strategy has been developed to aid in mitigation efforts for hazards posed by numerous snags, and that includes management action points, identification of contingency lines and point protection for communities several miles from current perimeter based on the extended time needed to acquire sufficient new resources and maneuver our current resources.  </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Observed today: </p>\n<p>Thermal belts continued to develop early Saturday morning with temperatures around 6500-7000' remaining warmer at around 60\u00b0F, with humidity recoveries limited to around 35%. Recoveries were better at lower and higher elevations on the fire where temperatures were generally in the upper 30s to mid-40s\u00b0F with recoveries to 60-70%. Near critical conditions developed during the burning period as temperatures rose to 80-88\u00b0F with humidity values dropping to 13-17%. Winds increased compared to Friday, with ridgetop winds from the west at 20-25 mph. 20-ft valley winds increased during the late afternoon to 10-14 mph with gusts as high as 30 mph. Mostly sunny skies were observed with high pressure across the fire area Saturday. </p>\n<p>Forecasted:</p>\n<p>Sunday will have a continuation of the warming trend, and conditions will become even more unstable with critical conditions expected. A Red Flag Warning will be in place for the Meyers Fire.  Morning temperatures between 6000-7000ft in the thermal belts will be in the upper 60s and lower 70s with humidity values starting the day in just around 20-25%. High temperatures will generally be in the mid 80s to near 90 with humidity values dropping as low as 10%.  Haines index values will reach 6 (High) during much of the burning period. Increased winds and gusty conditions will be similar to Saturday with sustained winds of 10-15 mph, with gusts to around 30 mph after 1500 from the WNW. Ridgetop winds will be 20-25 mph. Inversions will redevelop Sunday night, but will be broken down as a cold front moves from east to west into the early hours by around sunrise, with northeast winds expected to develop. </p>\n<p></p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Operations Briefing Video for September 2nd, 2017 Current Size:  30,486 acresResources Assigned: 322  Inciweb is currently having trouble with uploading the map. Please click here to see the map on Facebook.Extreme fire conditions. No campfires allowed.   Status: The fire is burning in mixed conifer stands, primarily lodgepole pine, Douglas fir, and subalpine fir, with numerous standing dead trees. There are residences still at risk in the Moose Lake, Frog Pond, Springer Memorial Park and Bonanza areas. Yesterday\u2019s Activities: Fire activity was not as intense as on Thursday, but the periphery did continue to expand in several areas with some short-range spotting, torching and fire runs occurring. The eastern edge of the fire south of Moose Lake advanced beyond the Continental Divide Trail into Deer Lodge County, with some additional spotting ahead of the fire. The Moose Lake and East Fork Bitterroot communities remain in a pre-evacuation warning status. Along the fire\u2019s west edge,...", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5397/", "type": "text/html", "rel": "alternate"}], "title": "Meyers Fire (Wildfire)", "geo_lat": "45.995277777778", "summary": "Operations Briefing Video for September 2nd, 2017 Current Size:  30,486 acresResources Assigned: 322  Inciweb is currently having trouble with uploading the map. Please click here to see the map on Facebook.Extreme fire conditions. No campfires allowed.   Status: The fire is burning in mixed conifer stands, primarily lodgepole pine, Douglas fir, and subalpine fir, with numerous standing dead trees. There are residences still at risk in the Moose Lake, Frog Pond, Springer Memorial Park and Bonanza areas. Yesterday\u2019s Activities: Fire activity was not as intense as on Thursday, but the periphery did continue to expand in several areas with some short-range spotting, torching and fire runs occurring. The eastern edge of the fire south of Moose Lake advanced beyond the Continental Divide Trail into Deer Lodge County, with some additional spotting ahead of the fire. The Moose Lake and East Fork Bitterroot communities remain in a pre-evacuation warning status. Along the fire\u2019s west edge,...", "county": "Granite County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Meyers Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5397/", "published": "Sat, 02 Sep 2017 20:48:43 -05:00", "geo_long": "-113.57972222222", "where": {"type": "Point", "coordinates": [-113.57972222222, 45.995277777778]}, "id": "https://inciweb.nwcg.gov/incident/5397/"}, "5396": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">NEWS RELEASE</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Fire Fact Sheet - July 24, 2017</strong><br/> July 24, 2017   Contact: Public Affairs Officer - Tod McKay  Phone: 406-363-7122  Cell: 406-531-1130      What: Bitterroot NF Fire Update   Location: Bitterroot National Forest     Dominic Butte... <a class=\"more\" href=\"/incident/article/5396/36874/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 7/27/2017</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Dominic Butte\";\r\n\tvar defLat =  46.322222222222;\r\n\tvar defLng =  -113.92361111111;\r\n\tvar defLon =  -113.92361111111;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  46.322222222222;\r\n\tvar detailLng =  -113.92361111111;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  46.322 latitude, -113.924 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Fire Perimeter Map\" src=\"https://inciweb.nwcg.gov/photos/MTBRF/2017-07-20-1704-Dominic-Butte/highlight/2017_07_21-21.03.03.604-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTBRF/2017-07-20-1704-Dominic-Butte/picts/2017_07_21-21.03.03.604-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTBRF/2017-07-20-1704-Dominic-Butte/picts/2017_07_21-21.03.03.604-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font size=\"2\">Firefighters are working to suppress a wildland fire burning on the Stevensville Ranger District east of Corvallis in the Sapphire Mountains near Willow Mountain Lookout and Dominic Point. The fire is approximately 55 acres in size and is currently 60% contained. The fire was reported on Wednesday, July 19 after a lightning event moved across the northern end of the Bitterroot National Forest the night before. 80 personnel are assigned to this incident. <br/><br/>Please respect the airspace and do not fly drones in this area. </font><br/><br/></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-07-27T14:48:54-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Wednesday July 19th, 2017 approx.   03:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">Sapphire Mountains east of Corvallis near Willow Mountain Lookout and Dominic Point</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Jon Rupp</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Wildfire </td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">80</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">55 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">60%</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Heavy timber and brush along with heavy dead and down fuels. Numerous snags present a serious safety threat to firefighters, especially in high winds situations.    </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Firefighters have been making good  progress this week on continuing mop-up activities further into the black (fire interior).  Fire managers will continue using aircraft to contain any active torching that occurs on the upper, north end of the fire in the old Dominic Point burn from 2010.  The area closure remains in effect for Willow Creek Road and numerous  trails.  See closure map posted here for more details.    </p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Keep the fire north of Willow Mountain Road, west of Willow Lookout and east of Deep Creek.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>Mop up an appropriate distance (2 chains) approx. 132 feet into the black to prevent spotting ouside of containment lines.     </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>The Bitterroot National Forest and Ravalli County are going into Stage II Fire Restrictions Thursday, July 27th.  This means campfires and all other fires on the forest are prohibited along with smoking outside of designated areas.  Firewood cutting (chainsaws) is also prohibited after 1pm.  Camping stoves (Liquid petroleum) that can be turned on and off are allowed.  Violating fire  restrictions can lead to fines of up to $5,000 and six months in jail.  For more details visit http://firerestrictions.us        </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Chance of thunderstorms this afternoon including gusty winds, lightning and heavy rainfall.   </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Firefighters are working to suppress a wildland fire burning on the Stevensville Ranger District east of Corvallis in the Sapphire Mountains near Willow Mountain Lookout and Dominic Point. The fire is approximately 55 acres in size and is currently 60% contained. The fire was reported on Wednesday, July 19 after a lightning event moved across the northern end of the Bitterroot National Forest the night before. 80 personnel are assigned to this incident. Please respect the airspace and do not fly drones in this area.", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5396/", "type": "text/html", "rel": "alternate"}], "title": "Dominic Butte (Wildfire)", "geo_lat": "46.322222222222", "summary": "Firefighters are working to suppress a wildland fire burning on the Stevensville Ranger District east of Corvallis in the Sapphire Mountains near Willow Mountain Lookout and Dominic Point. The fire is approximately 55 acres in size and is currently 60% contained. The fire was reported on Wednesday, July 19 after a lightning event moved across the northern end of the Bitterroot National Forest the night before. 80 personnel are assigned to this incident. Please respect the airspace and do not fly drones in this area.", "county": "Ravalli County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Dominic Butte (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5396/", "published": "Thu, 27 Jul 2017 14:49:11 -05:00", "geo_long": "-113.92361111111", "where": {"type": "Point", "coordinates": [-113.92361111111, 46.322222222222]}, "id": "https://inciweb.nwcg.gov/incident/5396/"}, "5399": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 7/31/2017</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Lodgepole Complex\";\r\n\tvar defLat =  47.318333333333;\r\n\tvar defLng =  -107.75805555556;\r\n\tvar defLon =  -107.75805555556;\r\n\tvar defZom =  10;\r\n\t\r\n\tvar detailLat =  47.318333333333;\r\n\tvar detailLng =  -107.75805555556;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.318 latitude, -107.758 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Large trailer with square baled painted Jordan Bound\" src=\"https://inciweb.nwcg.gov/photos/MTMCD/2017-07-20-2331-Lodgepole-Complex/highlight/2017_07_31-09.53.37.286-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTMCD/2017-07-20-2331-Lodgepole-Complex/picts/2017_07_31-09.53.37.286-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTMCD/2017-07-20-2331-Lodgepole-Complex/picts/2017_07_31-09.53.37.286-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font color=\"#000000\"><font size=\"4\"><font face=\"Arial\"><p style=\"color: rgb(34, 34, 34); text-transform: none; text-indent: 0px; letter-spacing: normal; font-style: normal; font-weight: normal; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; word-spacing: 0px; white-space: normal; unicode-bidi: embed; direction: ltr; -ms-word-break: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\"><font size=\"3\"><font face=\"Arial\"><b><u>Monday, July 31 \u2013 9:30 a.m.</u></b></font></font></p><p style=\"color: rgb(34, 34, 34); text-transform: none; text-indent: 0px; letter-spacing: normal; font-style: normal; font-weight: normal; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; word-spacing: 0px; white-space: normal; unicode-bidi: embed; direction: ltr; -ms-word-break: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\"><font size=\"3\"><b>270,723 acres \u2013 93% Contained</b></font><br/> <br/></p><p style=\"color: rgb(34, 34, 34); text-transform: none; text-indent: 0px; letter-spacing: normal; font-style: normal; font-weight: normal; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; word-spacing: 0px; white-space: normal; unicode-bidi: embed; direction: ltr; -ms-word-break: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\"><font size=\"3\"></font></p><p style=\"color: rgb(34, 34, 34); text-transform: none; text-indent: 0px; letter-spacing: normal; font-style: normal; font-weight: normal; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; word-spacing: 0px; white-space: normal; unicode-bidi: embed; direction: ltr; -ms-word-break: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\"><font size=\"3\">(Final Update) Firefighters will continue fire repairs and mop-up. Command of the fire has been turned over to a local Type 3 organization. </font></p><p style=\"color: rgb(34, 34, 34); text-transform: none; text-indent: 0px; letter-spacing: normal; font-style: normal; font-weight: normal; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; word-spacing: 0px; white-space: normal; unicode-bidi: embed; direction: ltr; -ms-word-break: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\"><br/></p><p style=\"color: rgb(34, 34, 34); text-transform: none; text-indent: 0px; letter-spacing: normal; font-style: normal; font-weight: normal; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; word-spacing: 0px; white-space: normal; unicode-bidi: embed; direction: ltr; -ms-word-break: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\"><font size=\"3\"></font></p><p style=\"color: rgb(34, 34, 34); text-transform: none; text-indent: 0px; letter-spacing: normal; font-style: normal; font-weight: normal; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; word-spacing: 0px; white-space: normal; unicode-bidi: embed; direction: ltr; -ms-word-break: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\"><font size=\"3\">Sixteen homes have been destroyed as well as an unspecified but significant amount of fencing and haystacks. Numerous secondary structures have also been destroyed. McCone Electric has lost over 120 power poles. An additional 16 structures not included above were identified via satellite imagery as destroyed but type of use has not yet been determined.</font></p></font><p style=\"color: rgb(34, 34, 34); text-transform: none; text-indent: 0px; letter-spacing: normal; font-style: normal; font-weight: normal; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; word-spacing: 0px; white-space: normal; unicode-bidi: embed; direction: ltr; -ms-word-break: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\"></p><p style=\"color: rgb(34, 34, 34); text-transform: none; text-indent: 0px; letter-spacing: normal; font-size: 12.8px; font-style: normal; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; word-spacing: 0px; white-space: normal; unicode-bidi: embed; direction: ltr; -ms-word-break: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\"><font face=\"Arial\"></font></p></font><p style=\"color: rgb(34, 34, 34); text-transform: none; text-indent: 0px; letter-spacing: normal; font-size: 12.8px; font-style: normal; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; word-spacing: 0px; white-space: normal; unicode-bidi: embed; direction: ltr; -ms-word-break: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\"><font face=\"Arial\"></font></p></font><p style=\"color: rgb(34, 34, 34); text-transform: none; text-indent: 0px; letter-spacing: normal; font-size: 12.8px; font-style: normal; margin-top: 0pt; margin-bottom: 0pt; margin-left: 0in; word-spacing: 0px; white-space: normal; unicode-bidi: embed; direction: ltr; -ms-word-break: normal; orphans: 2; widows: 2; background-color: rgb(255, 255, 255); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\"><font face=\"Arial\"></font></p></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-07-31T09:49:43-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Unknown</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Wednesday July 19th, 2017 approx.   03:17 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">52 miles WNW of Jordan, MT.</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Type 3</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Complex Incident</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Size</th><td class=\"cell3\">270,723 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">93%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Wednesday August 02nd, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Pine, grass, dead/downed, sagebrush (general habitat). Primary core Sage Grouse habitat affected south of Highway 200 near Sand Springs.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Minimal smoldering</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Mop-up and continue with fireline rehabilitation.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>Mop up and continue fire line rehab. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>Command of the incident transitioned from the Type 2 IMT a local Type 3 organization at 6PM Sunday, July 30. </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Monday: High temp of 100, Minimum RH or 12%, S winds 7 mph. Tuesday: High temp of 90, minimum Rh of 20%, gusty winds with a chance of thunderstorms</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Monday, July 31 \u2013 9:30 a.m.270,723 acres \u2013 93% Contained (Final Update) Firefighters will continue fire repairs and mop-up. Command of the fire has been turned over to a local Type 3 organization. Sixteen homes have been destroyed as well as an unspecified but significant amount of fencing and haystacks. Numerous secondary structures have also been destroyed. McCone Electric has lost over 120 power poles. An additional 16 structures not included above were identified via satellite imagery as destroyed but type of use has not yet been", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5399/", "type": "text/html", "rel": "alternate"}], "title": "Lodgepole Complex (Wildfire)", "geo_lat": "47.318333333333", "summary": "Monday, July 31 \u2013 9:30 a.m.270,723 acres \u2013 93% Contained (Final Update) Firefighters will continue fire repairs and mop-up. Command of the fire has been turned over to a local Type 3 organization. Sixteen homes have been destroyed as well as an unspecified but significant amount of fencing and haystacks. Numerous secondary structures have also been destroyed. McCone Electric has lost over 120 power poles. An additional 16 structures not included above were identified via satellite imagery as destroyed but type of use has not yet been", "county": "Garfield County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Lodgepole Complex (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5399/", "published": "Mon, 31 Jul 2017 09:54:48 -05:00", "geo_long": "-107.75805555556", "where": {"type": "Point", "coordinates": [-107.75805555556, 47.318333333333]}, "id": "https://inciweb.nwcg.gov/incident/5399/"}, "5520": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">CLOSURE</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>9-1-17 Trail Closures due to Scalp Fire, Order #D04-151-S-17</strong><br/> D04-151-S-17FLATHEAD NATIONAL FOREST 650 Wolfpack Way Kalispell, MT 59901 Forest Supervisor\u2019s Order   TRAIL RESTRICTION ORDER   Switchback Pass Trail #177, Clack Creek Trail #160, Clack Trilobite.. <a class=\"more\" href=\"/incident/article/5520/39688/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 1:03 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Scalp Fire\";\r\n\tvar defLat =  47.956666666667;\r\n\tvar defLng =  -113.07138888889;\r\n\tvar defLon =  -113.07138888889;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  47.956666666667;\r\n\tvar detailLng =  -113.07138888889;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.957 latitude, -113.071 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Scalp Fire from Spotted Bear LO, 8-27-2017 @ 1830\" src=\"https://inciweb.nwcg.gov/photos/MTFNF/2017-08-18-1315-Scalp/highlight/2017_08_27-20.00.12.334-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTFNF/2017-08-18-1315-Scalp/picts/2017_08_27-20.00.12.334-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTFNF/2017-08-18-1315-Scalp/picts/2017_08_27-20.00.12.334-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p>The Scalp Fire was reported at approximately 7:00pm on Tuesday, August 15th. The incident is located 3 miles south of Gooseberry Cabin, on Bow Mountain, in the Bob Marshall Wilderness on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role, with consideration for public and fire fighter safety as well as point protection of infrastructure. The fire is visible from both Spotted Bear and Beartop Lookouts. The fire is being managed by the Spotted Bear Ranger District. <br/> <br/><br/><u>Summary</u><br/><br/>Early morning IR flight on 9-2 detected 4,687 acres. The Scalp Fire was very active in Scalp Creek this afternoon. It is also backing into Open Creek on the Lewis and Clark National Forest. IR flight is planned for the overnight.</p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T21:27:01-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning/ Natural</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Tuesday August 15th, 2017 approx.   07:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">Bow Mountain in the Bob Marshall Wilderness</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Mike Mansson</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">The Fire Management Strategy Is 90% Monitor And 10% Point Protection.</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">2</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">4,678 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Friday December 01st, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber (litter and understory), heavy timber and snags.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Early morning IR flight on 9-2 detected 4,687 acres. The Scalp Fire was very active in Scalp Creek this afternoon. It is also backing into Open Creek on the Lewis and Clark National Forest. IR flight is planned for the overnight.</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Monitor fire with aerial resources, ground reconnaissance and lookouts. Structure protection plans are in place for Gooseberry Cabin if needed. Continue public information trapline and communicating with outfitters and guides in the wilderness.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>Possible torching with rollout and associated short uphill runs.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>Fire is being managed to allow its natural ecological role in the Wilderness.</p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Hot and dry weather is expected to continue.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Scalp Fire was reported at approximately 7:00pm on Tuesday, August 15th. The incident is located 3 miles south of Gooseberry Cabin, on Bow Mountain, in the Bob Marshall Wilderness on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role, with consideration for public and fire fighter safety as well as point protection of infrastructure. The fire is visible from both Spotted Bear and Beartop Lookouts. The fire is being managed by the Spotted Bear Ranger District.  SummaryEarly morning IR flight on 9-2 detected 4,687 acres. The Scalp Fire was very active in Scalp Creek this afternoon. It is also backing into Open Creek on the Lewis and Clark National Forest. IR flight is planned for the", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5520/", "type": "text/html", "rel": "alternate"}], "title": "Scalp Fire (Wildfire)", "geo_lat": "47.956666666667", "summary": "The Scalp Fire was reported at approximately 7:00pm on Tuesday, August 15th. The incident is located 3 miles south of Gooseberry Cabin, on Bow Mountain, in the Bob Marshall Wilderness on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role, with consideration for public and fire fighter safety as well as point protection of infrastructure. The fire is visible from both Spotted Bear and Beartop Lookouts. The fire is being managed by the Spotted Bear Ranger District.  SummaryEarly morning IR flight on 9-2 detected 4,687 acres. The Scalp Fire was very active in Scalp Creek this afternoon. It is also backing into Open Creek on the Lewis and Clark National Forest. IR flight is planned for the", "county": "Flathead County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Scalp Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5520/", "published": "Sat, 02 Sep 2017 21:27:01 -05:00", "geo_long": "-113.07138888889", "where": {"type": "Point", "coordinates": [-113.07138888889, 47.956666666667]}, "id": "https://inciweb.nwcg.gov/incident/5520/"}, "5474": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">NEWS RELEASE</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Fire Update, 9/2</strong><br/> Fire Information Line: 406-272-2082    Location: Gibralter Fire is located seven miles east of Eureka, MT Current Size: 6,657 Acres Cause: Lightning Containment: 27% Personnel: 81 Email:... <a class=\"more\" href=\"/incident/article/5474/39712/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 1:56 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Gibralter Ridge Fire\";\r\n\tvar defLat =  48.857222222222;\r\n\tvar defLng =  -114.85722222222;\r\n\tvar defLon =  -114.85722222222;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  48.857222222222;\r\n\tvar detailLng =  -114.85722222222;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  48.857 latitude, -114.857 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Forest map showing topography lines and streams with the fire area colore in red.\" src=\"https://inciweb.nwcg.gov/photos/MTKNF/2017-08-08-1142-Gibralter-Ridge-Fire/highlight/2017_09_01-15.20.07.513-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTKNF/2017-08-08-1142-Gibralter-Ridge-Fire/picts/2017_09_01-15.20.07.513-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTKNF/2017-08-08-1142-Gibralter-Ridge-Fire/picts/2017_09_01-15.20.07.513-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p>Evacuation update: Lincoln Co. Sheriff has modified the evacuation warnings. As of 8/31/2017, a PRE-EVACUATION WARNING is in effect for Sherman Creek, Griffith Creek, Therriault Pass Road, Stevens Creek, Glen Lake, and Sinclair Creek (south/west of West Road) areas. Permits are no longer required for entry. Residents should be aware that the evacuation situation will be updated if fire activity changes. <br/></p><p>On 08-31-2017 Pearson's type 2 team assumed command of the fire from the Kootenai Type 3 team. On Thursday (8/24) strong southwest winds pushed the fire about 1500 acres to the northeast. It spotted across the ridge systems and burned together higher on the ridge. It has continued to burn down towards Grave Creek Road which is an effective fuel break. Yesterday a spot fire was found on the west facing slope above Grave Creek; it was dampened with helicopter water drops. <br/><br/>History: The Gibralter Ridge Fire was one of several fires in the greater Eureka, Montana area. These fires were caused by lightning late Monday night (August 7th). The Gibralter Ridge Fire grew overnight to approximately 900 acres and was threatening structures and residences to the east of Eureka, MT. </p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T21:01:05-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Monday August 07th, 2017 approx.   09:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">7 miles east of Eureka, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Shawn Pearson, Bob Habeck (t), Type 2 Incident Management Team</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Lightning Caused Fire With Structures And Residences Threatened.</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">81</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">6,585 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">27%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Tuesday October 31st, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber with grassy understory; steep and inaccessible terrain</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Moderate fire behavior has been observed. Single tree torching, and fire backing down hill has been observed. Fire behavior picked up today with dryer weather. </p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Night shift still continues for protection of values at risk in Divisions G and T. Day shift will continue to mop up, hold and patrol.  an old access road was opened up in Williams Creek for fire access as needed.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>24 hours: Drying weather will allow additional growth to the northeast.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>As of 8/31, residents are in pre-evacuation warning status. </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Breezy winds and low humidity's will continue into Sunday. Hot and dry conditions will continue for this weekend. </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Evacuation update: Lincoln Co. Sheriff has modified the evacuation warnings. As of 8/31/2017, a PRE-EVACUATION WARNING is in effect for Sherman Creek, Griffith Creek, Therriault Pass Road, Stevens Creek, Glen Lake, and Sinclair Creek (south/west of West Road) areas. Permits are no longer required for entry. Residents should be aware that the evacuation situation will be updated if fire activity changes. On 08-31-2017 Pearson's type 2 team assumed command of the fire from the Kootenai Type 3 team. On Thursday (8/24) strong southwest winds pushed the fire about 1500 acres to the northeast. It spotted across the ridge systems and burned together higher on the ridge. It has continued to burn down towards Grave Creek Road which is an effective fuel break. Yesterday a spot fire was found on the west facing slope above Grave Creek; it was dampened with helicopter water drops. History: The Gibralter Ridge Fire was one of several fires in the greater Eureka, Montana area. These fires were...", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5474/", "type": "text/html", "rel": "alternate"}], "title": "Gibralter Ridge Fire (Wildfire)", "geo_lat": "48.857222222222", "summary": "Evacuation update: Lincoln Co. Sheriff has modified the evacuation warnings. As of 8/31/2017, a PRE-EVACUATION WARNING is in effect for Sherman Creek, Griffith Creek, Therriault Pass Road, Stevens Creek, Glen Lake, and Sinclair Creek (south/west of West Road) areas. Permits are no longer required for entry. Residents should be aware that the evacuation situation will be updated if fire activity changes. On 08-31-2017 Pearson's type 2 team assumed command of the fire from the Kootenai Type 3 team. On Thursday (8/24) strong southwest winds pushed the fire about 1500 acres to the northeast. It spotted across the ridge systems and burned together higher on the ridge. It has continued to burn down towards Grave Creek Road which is an effective fuel break. Yesterday a spot fire was found on the west facing slope above Grave Creek; it was dampened with helicopter water drops. History: The Gibralter Ridge Fire was one of several fires in the greater Eureka, Montana area. These fires were...", "county": "Lincoln County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Gibralter Ridge Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5474/", "published": "Sat, 02 Sep 2017 21:01:05 -05:00", "geo_long": "-114.85722222222", "where": {"type": "Point", "coordinates": [-114.85722222222, 48.857222222222]}, "id": "https://inciweb.nwcg.gov/incident/5474/"}, "5525": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">CLOSURE</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>9-2-17 Trail Closure due to Reef Fire, Order #D04-152-S-17</strong><br/> D04-152-S-17FLATHEAD NATIONAL FOREST 650 Wolfpack Way Kalispell, MT 59901 Forest Supervisor\u2019s Order   TRAIL RESTRICTION ORDER   Cardinal Peak Divide # 136, Cabin Creek #205, Pilot Peak #128 and... <a class=\"more\" href=\"/incident/article/5525/39795/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 1:33 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Reef Fire\";\r\n\tvar defLat =  47.3475;\r\n\tvar defLng =  -113.40166666667;\r\n\tvar defLon =  -113.40166666667;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  47.3475;\r\n\tvar detailLng =  -113.40166666667;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.348 latitude, -113.402 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Looking to the SW at Crescent MT and activty on the Rice Ridge Fire, 8-25-2017\" src=\"https://inciweb.nwcg.gov/photos/MTFNF/2017-08-22-1020-Reef-Fire/highlight/2017_08_25-20.14.39.548-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTFNF/2017-08-22-1020-Reef-Fire/picts/2017_08_25-20.14.39.548-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTFNF/2017-08-22-1020-Reef-Fire/picts/2017_08_25-20.14.39.548-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><br/>The Reef Fire was reported at approximately 5:45 pm on Sunday, August 13th. The incident is located near Count Peak in the Bob Marshall Wilderness on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role, with consideration for public and fire fighter safety, point protection of historic resources and trail infrastructure. The fire is being managed by the Spotted Bear Ranger District. <br/><br/><u>Summary</u><br/><br/>Early morning IR flight on 9-2 detected 1,329 acres. Jumbo Lookout observed very active fire behavior with the fire progressing to Goat Mountain, the Puma Creek drainage and Puma Peak. The fire has mostly stayed on the south side of Babcock Creek.</p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T21:23:37-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning/ Natural</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Sunday August 13th, 2017 approx.   05:45 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">near Count Peak in the Bob Marshall Wilderness</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Greg Gulan</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">The Fire Management Strategy Is 90% Monitor And 10% Point Zone Protection. </td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">2</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">1,329 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Sunday October 01st, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber (litter and understory), sub-alpine fir with a heavy snag component. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Early morning IR flight on 9-2 detected 1,329 acres. Jumbo Lookout observed very active fire behavior with the fire progressing to Goat Mountain, the Puma Creek drainage and Puma Peak. The fire has mostly stayed on the south side of Babcock Creek.</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Monitor with aerial resources from Jumbo Lookout. Continue coordinating with Rice Ridge Fire on the Seeley Lake District. Continue the public information trapline and communicating with outfitters and guides in the wilderness. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>Creeping and smoldering. Occasional torching and short uphill runs due to rollout. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>Trail Closure (FNF #130 and FNF #123) is in place due to the Rice Ridge Fire. </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Weather will continue to be hot and dry for the next several days. </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Reef Fire was reported at approximately 5:45 pm on Sunday, August 13th. The incident is located near Count Peak in the Bob Marshall Wilderness on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role, with consideration for public and fire fighter safety, point protection of historic resources and trail infrastructure. The fire is being managed by the Spotted Bear Ranger District. SummaryEarly morning IR flight on 9-2 detected 1,329 acres. Jumbo Lookout observed very active fire behavior with the fire progressing to Goat Mountain, the Puma Creek drainage and Puma Peak. The fire has mostly stayed on the south side of Babcock", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5525/", "type": "text/html", "rel": "alternate"}], "title": "Reef Fire (Wildfire)", "geo_lat": "47.3475", "summary": "The Reef Fire was reported at approximately 5:45 pm on Sunday, August 13th. The incident is located near Count Peak in the Bob Marshall Wilderness on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role, with consideration for public and fire fighter safety, point protection of historic resources and trail infrastructure. The fire is being managed by the Spotted Bear Ranger District. SummaryEarly morning IR flight on 9-2 detected 1,329 acres. Jumbo Lookout observed very active fire behavior with the fire progressing to Goat Mountain, the Puma Creek drainage and Puma Peak. The fire has mostly stayed on the south side of Babcock", "county": "Powell County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Reef Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5525/", "published": "Sat, 02 Sep 2017 21:24:15 -05:00", "geo_long": "-113.40166666667", "where": {"type": "Point", "coordinates": [-113.40166666667, 47.3475]}, "id": "https://inciweb.nwcg.gov/incident/5525/"}, "5510": {"content": "<div id=\"content\">\n<p>There is a problem completing the request you have made. Please try again in a few minutes.</p>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Sprague Fire was reported the evening of August 10 and is burning above Crystal Ford on the Gunsight Pass Trail. The Northern Rockies Type II Wildland Fire Management Team is now managing the fire.Daily updates are available here: https://inciweb.nwcg.gov/incident/news/5510/Maps of the fire perimeter: https://inciweb.nwcg.gov/incident/maps/5510/Visit http://go.nps.gov/glacconditions for trail and road info.A fire information line will be staffed 8am-8pm.Please call 406-888-7077 if you have questions about the fire and how it might impact your visit.You may be able to view the fire from Glacier National Park's webcams: https://www.nps.gov/glac/learn/photosmultimedia/webcams.htm", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5510/", "type": "text/html", "rel": "alternate"}], "title": "Sprague Fire (Wildfire)", "geo_lat": "48.607222222222", "summary": "The Sprague Fire was reported the evening of August 10 and is burning above Crystal Ford on the Gunsight Pass Trail. The Northern Rockies Type II Wildland Fire Management Team is now managing the fire.Daily updates are available here: https://inciweb.nwcg.gov/incident/news/5510/Maps of the fire perimeter: https://inciweb.nwcg.gov/incident/maps/5510/Visit http://go.nps.gov/glacconditions for trail and road info.A fire information line will be staffed 8am-8pm.Please call 406-888-7077 if you have questions about the fire and how it might impact your visit.You may be able to view the fire from Glacier National Park's webcams: https://www.nps.gov/glac/learn/photosmultimedia/webcams.htm", "county": "Flathead County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Sprague Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5510/", "published": "Sat, 02 Sep 2017 22:51:49 -05:00", "geo_long": "-113.82861111111", "where": {"type": "Point", "coordinates": [-113.82861111111, 48.607222222222]}, "id": "https://inciweb.nwcg.gov/incident/5510/"}, "5528": {"content": "<div id=\"content\">\n<p>There is a problem completing the request you have made. Please try again in a few minutes.</p>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Crucifixion Creek Fire was reported August 11, 2017 by an aerial detection flight. The fire is located in the Badger Two Medicine area on the Rocky Mountain Ranger District. The fire is in rough terrain of heavy timber and rocky, discontinuous vegetation. Fire management officials and the Incident Commander type 4 are managing the fire with a confine and contain strategy in place. Trail closures are in place along the S. Fork of Badger trail from the junction with trail #144 south to the junction with trail #121, near Badger Pass, as well as trail #145 Elbow Creek and Trail #146 Blue Lake Spur (along the Crucifixion Creek drainage) that are closed in their entirety. The IC and 3 fire personnel are working from the Badger Cabin Administrative site to monitor the remote fire. The fire has grown to approximately 650 acres. Prior large fire events from two years ago are present on the landscape east of the current fire activity. There is no immediate threat to any structures at this...", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5528/", "type": "text/html", "rel": "alternate"}], "title": "Crucifixion Creek Fire (Wildfire)", "geo_lat": "48.17", "summary": "The Crucifixion Creek Fire was reported August 11, 2017 by an aerial detection flight. The fire is located in the Badger Two Medicine area on the Rocky Mountain Ranger District. The fire is in rough terrain of heavy timber and rocky, discontinuous vegetation. Fire management officials and the Incident Commander type 4 are managing the fire with a confine and contain strategy in place. Trail closures are in place along the S. Fork of Badger trail from the junction with trail #144 south to the junction with trail #121, near Badger Pass, as well as trail #145 Elbow Creek and Trail #146 Blue Lake Spur (along the Crucifixion Creek drainage) that are closed in their entirety. The IC and 3 fire personnel are working from the Badger Cabin Administrative site to monitor the remote fire. The fire has grown to approximately 650 acres. Prior large fire events from two years ago are present on the landscape east of the current fire activity. There is no immediate threat to any structures at this...", "county": "Pondera County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Crucifixion Creek Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5528/", "published": "Sat, 02 Sep 2017 20:49:50 -05:00", "geo_long": "-113.09444444444", "where": {"type": "Point", "coordinates": [-113.09444444444, 48.17]}, "id": "https://inciweb.nwcg.gov/incident/5528/"}, "5507": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">NEWS RELEASE</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Fire Safety Through Labor Day Weekend</strong><br/>Confederated Salish &amp; Kootenai Division of Fire News Release For Immediate Release  September 2, 2017Fire Safety Through Labor Day WeekendPOLSON, Mont. \u2013 The safety of firefighters and the public... <a class=\"more\" href=\"/incident/article/5507/39725/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 12 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Blue Bay Fire\";\r\n\tvar defLat =  47.832222222222;\r\n\tvar defLng =  -114.00583333333;\r\n\tvar defLon =  -114.00583333333;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  47.832222222222;\r\n\tvar detailLng =  -114.00583333333;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.832 latitude, -114.006 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"A group of firefighters build a fireline with shovels, pulaskis, and other hand tools on a steep, forested slope.\" src=\"https://inciweb.nwcg.gov/photos/MTFHA/2017-08-15-1014-Blue-Bay/highlight/2017_08_26-12.48.54.505-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTFHA/2017-08-15-1014-Blue-Bay/picts/2017_08_26-12.48.54.505-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTFHA/2017-08-15-1014-Blue-Bay/picts/2017_08_26-12.48.54.505-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font color=\"#000000\" face=\"Calibri\" size=\"3\">Blue Bay Fire acreage remains 490 acres; containment is 80 percent. </font><font color=\"#000000\" face=\"Calibri\" size=\"3\">Aircraft continue to play a critical role in firefighting efforts due to steep and inaccessible terrain. Helicopters continue dropping water to cool hot spots, and slow the fire\u2019s growth and provide safer conditions for firefighters constructing fireline. Firefighters will continue to burn out unburned pockets of vegetation as necessary to secure the fire edge. A BAER (Burned Area Emergency Response) Team is examining the fire area and developing a plan for how to mitigate the potential negative after-effects of wildland fires. </font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T09:25:46-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Thursday August 10th, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">10 air miles northeast of Polson, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">McCrea</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Wildfire\n\n</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">65</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">490 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">80%</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber (grass, litter, and understory), and closed timber litter.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Minimal fire behavior. Isolated torching, creeping, and smoldering observed.</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Work hot spots, improve lines.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>None.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>Firefighters will continue to secure firelines. Human exposure to falling snags and trees in burned areas will be minimized. </p>\n<p>Homes and other outbuildings are approximately 1/2 mile from the fire and are not immediately threatened. </p>\n<p>Concerned citizens are encouraged to understand Ready.Set.Go measures and to work with the Lake County Disaster Emergency Services to prepare for and learn about evacuation notices. </p>\n<p></p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Warm and dry weather in the forecast.</p>\n<p></p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Blue Bay Fire acreage remains 490 acres; containment is 80 percent. Aircraft continue to play a critical role in firefighting efforts due to steep and inaccessible terrain. Helicopters continue dropping water to cool hot spots, and slow the fire\u2019s growth and provide safer conditions for firefighters constructing fireline. Firefighters will continue to burn out unburned pockets of vegetation as necessary to secure the fire edge. A BAER (Burned Area Emergency Response) Team is examining the fire area and developing a plan for how to mitigate the potential negative after-effects of wildland fires.", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5507/", "type": "text/html", "rel": "alternate"}], "title": "Blue Bay Fire (Wildfire)", "geo_lat": "47.832222222222", "summary": "Blue Bay Fire acreage remains 490 acres; containment is 80 percent. Aircraft continue to play a critical role in firefighting efforts due to steep and inaccessible terrain. Helicopters continue dropping water to cool hot spots, and slow the fire\u2019s growth and provide safer conditions for firefighters constructing fireline. Firefighters will continue to burn out unburned pockets of vegetation as necessary to secure the fire edge. A BAER (Burned Area Emergency Response) Team is examining the fire area and developing a plan for how to mitigate the potential negative after-effects of wildland fires.", "county": "Lake County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Blue Bay Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5507/", "published": "Sat, 02 Sep 2017 10:34:57 -05:00", "geo_long": "-114.00583333333", "where": {"type": "Point", "coordinates": [-114.00583333333, 47.832222222222]}, "id": "https://inciweb.nwcg.gov/incident/5507/"}, "5453": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 6 DAYS AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Morgan and Butler Fires\";\r\n\tvar defLat =  45.535833333333;\r\n\tvar defLng =  -113.81361111111;\r\n\tvar defLon =  -113.81361111111;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  45.535833333333;\r\n\tvar detailLng =  -113.81361111111;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  45.536 latitude, -113.814 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><p>Both the Morgan and the Butler Fires are contained and in patrol status. All area closures associated with these fires have been rescinded.</p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-08-28T10:17:00-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Saturday July 29th, 2017 approx.   03:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Tosse - USFS </td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">106</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">10 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">100%</td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Fires are contained and in patrol status.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>Area closures have been rescinded.</p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Hot and dry</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Both the Morgan and the Butler Fires are contained and in patrol status. All area closures associated with these fires have been", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5453/", "type": "text/html", "rel": "alternate"}], "title": "Morgan and Butler Fires (Wildfire)", "geo_lat": "45.535833333333", "summary": "Both the Morgan and the Butler Fires are contained and in patrol status. All area closures associated with these fires have been", "county": "Beaverhead County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Morgan and Butler Fires (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5453/", "published": "Mon, 28 Aug 2017 10:17:00 -05:00", "geo_long": "-113.81361111111", "where": {"type": "Point", "coordinates": [-113.81361111111, 45.535833333333]}, "id": "https://inciweb.nwcg.gov/incident/5453/"}, "5414": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">ANNOUNCEMENT</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Current Evacuation Orders and Warnings</strong><br/>  Current Evacuation Orders and Warnings issued by the Missoula County Sheriff's Department  8/24/2017 The following area has been put under an evacuation ORDER due to an immediate fire threat near... <a class=\"more\" href=\"/incident/article/5414/39405/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 5 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Rice Ridge Fire\";\r\n\tvar defLat =  47.268055555556;\r\n\tvar defLng =  -113.48527777778;\r\n\tvar defLon =  -113.48527777778;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  47.268055555556;\r\n\tvar detailLng =  -113.48527777778;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.268 latitude, -113.485 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Rice Ridge Fire Perimeter Map - September 2, 2017\" src=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-24-2216-Rice-Ridge-Fire/highlight/2017_09_02-09.52.34.569-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-24-2216-Rice-Ridge-Fire/picts/2017_09_02-09.52.34.569-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-24-2216-Rice-Ridge-Fire/picts/2017_09_02-09.52.34.569-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font size=\"4\">The Rice Ridge Fire, caused by lightning, started July 24th. The fire is located northeast of Seeley Lake, Montana on the Lolo National Forest. The community of Seeley Lake is threatened by this fire, multiple evacuation orders and warnings are in effect. The Rice Ridge Fire is currently under command of John Thompson's Central Montana Incident Management Team.<br/><br/><b>UPDATE 9.2.2017, 4:45 pm</b>: Fire activity increased this afternoon under red flag conditions due to low relative humidities, high temperatures, high winds, and extremely dry fuels causing multiple spots outside the fire perimeter. The southern portion of the fire is putting up a significant column which is visible from the town of Seeley Lake. This area of the fire is predominately spreading in a east/northeast direction back towards the main body of the fire. The southeastern area of the fire is experiencing significant spotting due to the westerly winds.<br/><br/><br/></font></p><font size=\"4\"> </font><a href=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-24-2216-Rice-Ridge-Fire/related_files/pict20170802-095129-0.pdf\" target=\"_self\"><font size=\"4\">Click here for today's update - 9/2/17</font></a><br/> <br/><br/><a href=\"https://inciweb.nwcg.gov/incident/map/5414/0/72100/\" target=\"_self\"><font size=\"4\">Click here for today's map - 9/2/17</font></a><br/> <br/><br/><font size=\"4\"> </font><a href=\"https://inciweb.nwcg.gov/incident/article/5414/39722/\" target=\"_self\"><font size=\"4\">Click here for today's air quality report - 9/2/17</font></a><br/><br/><br/><br/> <br/><font size=\"4\"> <br/></font></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T09:42:58-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Monday July 24th, 2017 approx.   04:30 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">John Thompson's Central Montana Incident Management Team</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Wildfire In Inaccessible Terrain</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">682</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">40,164 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">18%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Sunday October 01st, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Lodgepole and mixed conifer,with much dead and down</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Please see today's update for details.</p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Southwest winds will start in increase to 12-15 mph on the ridges with temperatures in the 80s and humidity in the teens. This will be a critical fire weather day, and there is a Fire Weather Watch in effect for the next day, Sunday.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Rice Ridge Fire, caused by lightning, started July 24th. The fire is located northeast of Seeley Lake, Montana on the Lolo National Forest. The community of Seeley Lake is threatened by this fire, multiple evacuation orders and warnings are in effect. The Rice Ridge Fire is currently under command of John Thompson's Central Montana Incident Management Team.UPDATE 9.2.2017, 4:45 pm: Fire activity increased this afternoon under red flag conditions due to low relative humidities, high temperatures, high winds, and extremely dry fuels causing multiple spots outside the fire perimeter. The southern portion of the fire is putting up a significant column which is visible from the town of Seeley Lake. This area of the fire is predominately spreading in a east/northeast direction back towards the main body of the fire. The southeastern area of the fire is experiencing significant spotting due to the westerly winds. Click here for today's update - 9/2/17 Click here for today's map - 9/2/17 ...", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5414/", "type": "text/html", "rel": "alternate"}], "title": "Rice Ridge Fire (Wildfire)", "geo_lat": "47.268055555556", "summary": "The Rice Ridge Fire, caused by lightning, started July 24th. The fire is located northeast of Seeley Lake, Montana on the Lolo National Forest. The community of Seeley Lake is threatened by this fire, multiple evacuation orders and warnings are in effect. The Rice Ridge Fire is currently under command of John Thompson's Central Montana Incident Management Team.UPDATE 9.2.2017, 4:45 pm: Fire activity increased this afternoon under red flag conditions due to low relative humidities, high temperatures, high winds, and extremely dry fuels causing multiple spots outside the fire perimeter. The southern portion of the fire is putting up a significant column which is visible from the town of Seeley Lake. This area of the fire is predominately spreading in a east/northeast direction back towards the main body of the fire. The southeastern area of the fire is experiencing significant spotting due to the westerly winds. Click here for today's update - 9/2/17 Click here for today's map - 9/2/17 ...", "county": "Missoula County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Rice Ridge Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5414/", "published": "Sat, 02 Sep 2017 17:52:23 -05:00", "geo_long": "-113.48527777778", "where": {"type": "Point", "coordinates": [-113.48527777778, 47.268055555556]}, "id": "https://inciweb.nwcg.gov/incident/5414/"}, "5356": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">ANNOUNCEMENT</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Last Update </strong><br/>There will be no further updates for the Tongue River Complex after July 14, 2017, unless significant fire activity <a class=\"more\" href=\"/incident/article/5356/36471/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 7/15/2017</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Tongue River Complex\";\r\n\tvar defLat =  45.301666666667;\r\n\tvar defLng =  -106.53305555556;\r\n\tvar defLon =  -106.53305555556;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  45.301666666667;\r\n\tvar detailLng =  -106.53305555556;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  45.302 latitude, -106.533 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Map - July 14, 2017\" src=\"https://inciweb.nwcg.gov/photos/MTGNF/2017-07-12-0047-Tongue-River-Complex/highlight/2017_07_14-12.45.45.721-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTGNF/2017-07-12-0047-Tongue-River-Complex/picts/2017_07_14-12.45.45.721-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTGNF/2017-07-12-0047-Tongue-River-Complex/picts/2017_07_14-12.45.45.721-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 6pt 0in 6pt -40.3pt; mso-pagination: none; mso-layout-grid-align: none;\"><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 6pt 5.4pt 6pt 4.5pt; mso-pagination: none; mso-layout-grid-align: none;\"><font face=\"Times New Roman\"><font color=\"#000000\">The Tongue River Complex consists of two separate fires, Lee Creek and Witten. </font><font color=\"#000000\">Both fires are burning in timber, grass, and brush in rough terrain.</font><font color=\"#000000\"> </font><font color=\"#000000\">The Witten fire is approximately 18 miles south of Lame Deer, Montana and the Lee Creek fire is approximately 30 miles south of Ashland.</font><font color=\"#000000\"> </font><font color=\"#000000\">Mike Almas\u2019s Northern Rockies Incident Management Team (IMT) assumed command of the fire on July 10, 2017 at 0600.</font></font><br/> </p><p style=\"margin: 0in 0in 6pt 4.5pt; mso-pagination: none; mso-layout-grid-align: none;\"><font color=\"#000000\"><font face=\"Times New Roman\"><b style=\"mso-bidi-font-weight: normal;\">Evacuations: </b>No evacuations are in effect at this time.</font></font><br/> </p><p dir=\"ltr\" style=\"margin: 0in 0in 6pt 4.5pt; mso-pagination: none; mso-layout-grid-align: none;\"><font color=\"#000000\"><font face=\"Times New Roman\"><b style=\"mso-bidi-font-weight: normal;\">Road Closures &amp; Special Announcements: </b>No road or area closures are active at this time. The Incident Management Team and local fire officials would like to express their appreciation to area residents and community members for not accessing the fire perimeter.<br/><br/>By Executive Order, the Northern Cheyenne Tribal President, in consultation with the Superintendent of the Bureau of Indian Affairs, Tribal Forestry Director and Fire Management Officials placed certain restrictions on activities that will reduce the risk of igniting wildland fires. The fire restriction are as follows: <br/><br/> \u00b7 No lighting of fireworks<br/> \u00b7 No trash burning<br/> \u00b7 Campfires only in designated areas and must be attended to at all times<br/> \u00b7 Sweat Lodge fires at established locations are strongly advised and must be attended to at all times<br/> \u00b7 No smoking except in closed vehicles or in designated areas<br/> \u00b7 All persons traveling on \"back roads\" are required to stay on established roads due to the increasing risk of fire danger<br/><br/>The order, signed July 9, 2017, is effective until rescinded.<br/> <br/><br/><br/></font></font><br/> <br/></p><p style=\"margin: 6pt 0in 6pt -40.3pt; mso-pagination: none; mso-layout-grid-align: none;\"><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 0in 0in 6pt 4.5pt; mso-pagination: none; mso-layout-grid-align: none;\"><font face=\"Times New Roman\"><font color=\"#000000\"></font></font></p><p style=\"margin: 6pt 0in 6pt -40.3pt; mso-pagination: none; mso-layout-grid-align: none;\"><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 6pt 0in 6pt -40.3pt; mso-pagination: none; mso-layout-grid-align: none;\"></p><p style=\"margin: 6pt 0in 6pt -40.3pt; mso-pagination: none; mso-layout-grid-align: none;\"></p> <font face=\"Times New Roman\" size=\"3\"> </font> <p style=\"margin: 6pt 0in 6pt -40.3pt; mso-pagination: none; mso-layout-grid-align: none;\"></p><p><font face=\"Times New Roman\">.</font> </p> <font face=\"Times New Roman\" size=\"3\"> </font> <font face=\"Times New Roman\" size=\"3\"> </font> <font face=\"Times New Roman\"><p style=\"margin: 6pt 0in 6pt -40.3pt; mso-pagination: none; mso-layout-grid-align: none;\"></p><font color=\"#000000\"><p style=\"margin: 6pt 0in 6pt -40.3pt; mso-pagination: none; mso-layout-grid-align: none;\"></p><p style=\"margin: 6pt 5.4pt 6pt 4.5pt; mso-pagination: none; mso-layout-grid-align: none;\"></p><p style=\"margin: 6pt 0in 6pt -40.3pt; mso-pagination: none; mso-layout-grid-align: none;\"><font size=\"3\"> </font><font face=\"Times New Roman\" size=\"3\"> </font> </p></font><p style=\"margin: 6pt 0in 6pt -40.3pt; mso-pagination: none; mso-layout-grid-align: none;\"></p></font><p style=\"margin: 6pt 0in 6pt -40.3pt; mso-pagination: none; mso-layout-grid-align: none;\"></p><p style=\"margin: 6pt 0in 6pt -40.3pt; mso-pagination: none; mso-layout-grid-align: none;\"></p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-07-15T11:53:09-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Unknown</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Friday July 07th, 2017 approx.   08:30 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">18 miles south of Lame Deer</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Mike Almas</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">216</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">28,957 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">90%</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber, short grass, and brush</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Minimal fire activity with some creeping and smoldering.</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Firefighters will continue patrol and suppression repair of fire lines on the Witten fire. Firefighters will coordinate Traffic and safety with logging operators along the northwest and west side.</p>\n<p>The Lee Creek fire is 100% contained. Suppression repair has also been completed.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>The Witten fire is 28,957 acres and 80% contained.  </p>\n<p>Lee Creek fire is 4,008 acres (change due to GPS perimeter mapping on the ground)and 100% contained.</p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Above normal temperatures and low humidities will occur tomorrow and continue through the weekend.  There is also a potential for late afternoon dry thunderstorms Friday.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Tongue River Complex consists of two separate fires, Lee Creek and Witten. Both fires are burning in timber, grass, and brush in rough terrain. The Witten fire is approximately 18 miles south of Lame Deer, Montana and the Lee Creek fire is approximately 30 miles south of Ashland. Mike Almas\u2019s Northern Rockies Incident Management Team (IMT) assumed command of the fire on July 10, 2017 at 0600. Evacuations: No evacuations are in effect at this time. Road Closures & Special Announcements: No road or area closures are active at this time. The Incident Management Team and local fire officials would like to express their appreciation to area residents and community members for not accessing the fire perimeter.By Executive Order, the Northern Cheyenne Tribal President, in consultation with the Superintendent of the Bureau of Indian Affairs, Tribal Forestry Director and Fire Management Officials placed certain restrictions on activities that will reduce the risk of igniting wildland...", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5356/", "type": "text/html", "rel": "alternate"}], "title": "Tongue River Complex (Wildfire)", "geo_lat": "45.301666666667", "summary": "The Tongue River Complex consists of two separate fires, Lee Creek and Witten. Both fires are burning in timber, grass, and brush in rough terrain. The Witten fire is approximately 18 miles south of Lame Deer, Montana and the Lee Creek fire is approximately 30 miles south of Ashland. Mike Almas\u2019s Northern Rockies Incident Management Team (IMT) assumed command of the fire on July 10, 2017 at 0600. Evacuations: No evacuations are in effect at this time. Road Closures & Special Announcements: No road or area closures are active at this time. The Incident Management Team and local fire officials would like to express their appreciation to area residents and community members for not accessing the fire perimeter.By Executive Order, the Northern Cheyenne Tribal President, in consultation with the Superintendent of the Bureau of Indian Affairs, Tribal Forestry Director and Fire Management Officials placed certain restrictions on activities that will reduce the risk of igniting wildland...", "county": "Rosebud County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Tongue River Complex (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5356/", "published": "Sat, 15 Jul 2017 11:53:09 -05:00", "geo_long": "-106.53305555556", "where": {"type": "Point", "coordinates": [-106.53305555556, 45.301666666667]}, "id": "https://inciweb.nwcg.gov/incident/5356/"}, "5416": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">ANNOUNCEMENT</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Sliderock Evacuation changed from Order (Red) to Warning (Yellow)</strong><br/>At 19:00 (7:00 pm) Tuesday, August 15, 2017, the Granite County Sheriff determined that the Evacuation Order for the area, within and, surrounding the Sliderock Fire on the Sapphire Complex can be... <a class=\"more\" href=\"/incident/article/5416/38192/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 8/24/2017</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Sliderock Fire\";\r\n\tvar defLat =  46.5875;\r\n\tvar defLng =  -113.58444444444;\r\n\tvar defLon =  -113.58444444444;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  46.5875;\r\n\tvar detailLng =  -113.58444444444;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  46.588 latitude, -113.584 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><p><font size=\"5\">As of July 24th, the Sliderock, Goat Creek, and Little Hogback Fires are known as the Sapphire Complex. All information on the Goat Creek Fire is available on the Sapphire Complex page at https://inciweb.nwcg.gov/incident/5364/</font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-08-24T10:01:17-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Thursday July 13th, 2017 approx.   02:01 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">Nine miles south of Beavertail Pond and three miles east of Rock Creek Road in the Missoula Ranger District.</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Northern Rockies Pearson IMT 2 </td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Lightning Ignited Fire Burning In Remote Terrain</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Size</th><td class=\"cell3\">874 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">75%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Tuesday October 31st, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber, litter, grass, and understory.  </p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Projected Incident Activity</th><td class=\"cell3\"><p> </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "As of July 24th, the Sliderock, Goat Creek, and Little Hogback Fires are known as the Sapphire Complex. All information on the Goat Creek Fire is available on the Sapphire Complex page at", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5416/", "type": "text/html", "rel": "alternate"}], "title": "Sliderock Fire (Wildfire)", "geo_lat": "46.5875", "summary": "As of July 24th, the Sliderock, Goat Creek, and Little Hogback Fires are known as the Sapphire Complex. All information on the Goat Creek Fire is available on the Sapphire Complex page at", "county": "Granite County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Sliderock Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5416/", "published": "Thu, 24 Aug 2017 10:01:17 -05:00", "geo_long": "-113.58444444444", "where": {"type": "Point", "coordinates": [-113.58444444444, 46.5875]}, "id": "https://inciweb.nwcg.gov/incident/5416/"}, "5585": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED  1 MIN. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"West Fork Fire\";\r\n\tvar defLat =  48.507777777778;\r\n\tvar defLng =  -115.63333333333;\r\n\tvar defLon =  -115.63333333333;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  48.507777777778;\r\n\tvar detailLng =  -115.63333333333;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  48.508 latitude, -115.633 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><p><b><font size=\"2\">West Fork Fire </font></b><br/><font size=\"2\">Fact Sheet<br/>September 3, 2017 <br/><br/>Location: West Fork Fire is located 5 miles North of Kootenai River Road.<br/> Cause: Lightning Current Size: 1600 acres <br/>Contact: westforkfire2017@gmail.com <br/>Announcement: A public meeting will be held for the West Fork Fire on Sunday September 3, 2017 at 4:00 PM at Libby Middle/High School, 150 Education Way, Libby, MT. <br/><br/>Fire: The West Fork Fire is located in the Quartz Creek/Bobtail Ridge area on the Libby Ranger District. The West Fork Fire started Wednesday morning. A local Type 3 Fire Response Team is in place providing fire suppression strategies. The team will continue to use heavy equipment to construct shaded fuel breaks with weather dictating line construction activities. The Fire Team is using J. Neil\u2019s Park to stage equipment. Please be cautious and drive slowly when accessing the park. <br/><br/>Evacuations: Lincoln County Sheriff\u2019s Office is working closely with local fire departments and the Fire Response Team to identify opportunities to work with landowners to keep them aware of the fire situation. A Pre-Evacuation Warning has been issued by the Lincoln County Sheriff\u2019s Office for the upper end of Bobtail Road north of Bobtail Cutoff, Hutton Drive, Bobtail Cut-off, including Winter Road and Whitetail Road, Pipe Creek Road from Forest Way, including Lodge Pole Road, Blue Mountain Lookout Road and Doak Creek Road, and Creekside Road to 17 Mile Road. <br/><br/>Closures: Go to the Kootenai webpage at https://www.fs.usda.gov/kootenai for the latest on Closure Orders and KNF fire vicinity map. Lincoln County Sheriff\u2019s Office is asking the public to avoid the Pipe Creek Road, Kootenai River Road, Quartz Creek Road, Quartz Mountain Road, Bobtail Road and Bobtail Cutoff areas to allow for safe fire response and public safety. The fall hunting season officially started yesterday with archery season, please avoid active fire areas. Forecasted Weather: A red flag warning will be in effect on Sunday from noon to 9:00 PM. Hot and dry conditions will continue today with breezy afternoon winds. Winds are expected to pick up sometime between 3 and 6 pm. A Canadian cold front will bring a shift in wind direction Sunday night with winds becoming north to northeasterly. The fire is actively burning so people can expect to see smoke in the air. Check todaysair.mt.gov for real time updates on air quality and outdoor activity recommendations. <br/><br/>Fire Restrictions: Stage II Fire Restrictions are in effect for Lincoln County and Kootenai National Forest due to extreme fire danger. Current fire conditions can be found at www.firerestrictions.us. </font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-03T11:29:54-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Saturday August 30th, 3017 approx.   10:45 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">7 miles NW of Libby</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Rider/Sunell(t)  Type 3 Team</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">54</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">800 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber(Grass and Understory)</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Moderate fire activity with group tree torching, uphill fire runs, and spotting</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Projected Incident Activity</th><td class=\"cell3\"><p>Fire will continue to grow with continued winds. It will back down to Bobtail Ridge toward the Bobtail residential area.  Over next 24 hrs, fire has the potential to push closer towards the Pipe Cr area. </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>There is a Red Flag Warning for Sunday from 12 noon to 9 p.m. for low RH (8-13%) and gusty winds 10-20 mph, gusts to 30. Extremly poor overnight recovery tonight with humidity 20-30%.  Very low afternoon humidity and a very unstable atmosphere on Sunday will continue until winds shift to the east on Sunday into Monday.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "language": null, "value": "West Fork Fire Fact SheetSeptember 3, 2017 Location: West Fork Fire is located 5 miles North of Kootenai River Road. Cause: Lightning Current Size: 1600 acres Contact: westforkfire2017@gmail.com Announcement: A public meeting will be held for the West Fork Fire on Sunday September 3, 2017 at 4:00 PM at Libby Middle/High School, 150 Education Way, Libby, MT. Fire: The West Fork Fire is located in the Quartz Creek/Bobtail Ridge area on the Libby Ranger District. The West Fork Fire started Wednesday morning. A local Type 3 Fire Response Team is in place providing fire suppression strategies. The team will continue to use heavy equipment to construct shaded fuel breaks with weather dictating line construction activities. The Fire Team is using J. Neil\u2019s Park to stage equipment. Please be cautious and drive slowly when accessing the park. Evacuations: Lincoln County Sheriff\u2019s Office is working closely with local fire departments and the Fire Response Team to identify opportunities to..."}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5585/", "type": "text/html", "rel": "alternate"}], "title": "West Fork Fire (Wildfire)", "geo_lat": "", "summary": "West Fork Fire Fact SheetSeptember 3, 2017 Location: West Fork Fire is located 5 miles North of Kootenai River Road. Cause: Lightning Current Size: 1600 acres Contact: westforkfire2017@gmail.com Announcement: A public meeting will be held for the West Fork Fire on Sunday September 3, 2017 at 4:00 PM at Libby Middle/High School, 150 Education Way, Libby, MT. Fire: The West Fork Fire is located in the Quartz Creek/Bobtail Ridge area on the Libby Ranger District. The West Fork Fire started Wednesday morning. A local Type 3 Fire Response Team is in place providing fire suppression strategies. The team will continue to use heavy equipment to construct shaded fuel breaks with weather dictating line construction activities. The Fire Team is using J. Neil\u2019s Park to stage equipment. Please be cautious and drive slowly when accessing the park. Evacuations: Lincoln County Sheriff\u2019s Office is working closely with local fire departments and the Fire Response Team to identify opportunities to...", "county": null, "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "language": null, "value": "West Fork Fire (Wildfire)"}, "link": "https://inciweb.nwcg.gov/incident/5585/", "published": "Sun, 03 Sep 2017 11:16:03 -05:00", "geo_long": "-", "where": {}, "id": "https://inciweb.nwcg.gov/incident/5585/"}, "5410": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">ANNOUNCEMENT</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Pre-evacuation Notice for Alice Creek Basin and Tom's Gulch Area</strong><br/>      Upon consultation with the Great Basin Incident Management Team 5, Sheriff Dutton is ordering pre-evacuation notices be given in the Alice Creek Basin and Tom's Gulch area. The team reported... <a class=\"more\" href=\"/incident/article/5410/39807/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED  1 MIN. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Alice Creek Fire\";\r\n\tvar defLat =  47.154166666667;\r\n\tvar defLng =  -112.50166666667;\r\n\tvar defLon =  -112.50166666667;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  47.154166666667;\r\n\tvar detailLng =  -112.50166666667;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.154 latitude, -112.502 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"At 3:30 Aug. 2, the Alice Creek Fire became active along the Alice Mountain Ridge. Photo by Corinne Wetzel, PIO\" src=\"https://inciweb.nwcg.gov/photos/MTHLF/2017-07-24-1434-Alice-Creek-Fire/highlight/2017_09_02-16.43.52.479-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTHLF/2017-07-24-1434-Alice-Creek-Fire/picts/2017_09_02-16.43.52.479-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTHLF/2017-07-24-1434-Alice-Creek-Fire/picts/2017_09_02-16.43.52.479-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font size=\"3\"><font face=\"Times New Roman\"> </font> </font></p><p><font size=\"3\"> <font face=\"Calibri\"><b><font face=\"'Times New Roman'\">AUGUSTA, MT \u2013 </font></b></font></font><font face=\"'Times New Roman'\" size=\"3\">Firefighters saw the Alice Creek Fire grow an additional 437 acres yesterday, mostly along the northern flank in upper drainage of East Fork of Falls Creek (drains to Dearborn Canyon). In the late afternoon, on the west flank, fire spotted into Wildcat Gulch. National Guard helicopters are dropping water to cool the fire in active areas while a handcrew is working to keep the fire west of Alice Mountain Ridge. <br/><br/>Red flag conditions will prevail through the weekend. These conditions are for critically dry, hot windy weather. Winds from the northwest with gusts up to 28 mph are expected in the late afternoon. This could cause the fire to become very active, producing visible columns of smoke. Due to these conditions, the burning period is lasting well into the early morning hours. <br/><br/></font><font face=\"'Times New Roman'\" size=\"3\">On the northeastern flank, firefighters have made good progress containing the fire from the northern tip (\u201cthe Hunting Lodge\u201d), south to Bedrock Creek. When wind is favorable, a handcrew is slowly working their way east along a logging road with drip torches to clean up edges of the fire. This will enforce containment of the fire. From the \u201cHunting Lodge\u201d, a dozer is beginning to work north, constructing a dozer line following the Falls Creek Ridge (drainage to Dearborn Creek). <br/><br/></font><font face=\"'Times New Roman'\" size=\"3\">Feller bunchers working with engines have been widening a road system that curves in a half circle from Bedrock Creek to the North Fork of Green Creek (does not include the south fork of Green Creek). Firefighters are cooperating with ranchers and other landowners adjacent to the fire area to share information and evolving plans that may affect their property if winds push the fire directly east. These conversations are essential to all involved as firefighters are highly sensitive to their concerns, and understand the fire is threatening the essence of their livelihoods. Firefighters, landowners, emergency response personnel, including the Wolf Creek fire responders and law enforcement, are participating in this contingency planning that may involve laying fire on the ground. These ongoing conversations will ensure the safety of firefighters and landowners and keep communication channels open. Fire managers wish to ensure these targeted landowners understand who is performing the activities, how they will occur and for what purpose. <br/><br/>Structure protection equipment are also in the southeast flank of the fire (Elk Meadow/Evergreen community) and the northern flank of the fire (Dearborn community) working with affected landowners. <br/><br/>Along the southeastern flank, two feller bunchers and crews are strengthened the line from the road in Green Creek to Lewis and Clark Pass to Bedrock Creek. Two chinook helicopters, capable of dropping 2,000 pounds of water per drop, are providing air support to firefighters. <br/><br/>Though Elk Meadows remains under mandatory evacuations the Lewis and Clark County Sheriff is authorizing limited and controlled access to the properties for Elk Meadow residents who need access to their property to recover essential items. Residents will be escorted in and out by the Sheriff. Please call </font><a href=\"tel:406-447-8293\"><font face=\"'Times New Roman'\" size=\"3\">406-447-8293</font></a><font face=\"'Times New Roman'\" size=\"3\">. Law enforcement officers from Everglades National Park are assisting the fire management organization. They are cross deputized by the Lewis and Clark County Sheriff and will be supporting them with road guard duty until County deputies re-join the organization Sunday. <br/><br/></font><font face=\"'Times New Roman'\" size=\"3\">A community meeting was held in Wolf Creek yesterday. There were about 50 attendees who received information about the fire's history, weather conditions, and multi-agency cooperation. <br/><br/></font><font face=\"'Times New Roman'\" size=\"3\">The National Guard Chinook helicopters are very large and may catch the eye of drivers along Hwy. 200. Signs marking their dip sites will are asking people to not stop along the roadway. Look at the aircraft dipping may be dangerous to other drivers.<br/><br/><b>SIZE: </b>7,440 acres<b> CONTAINMENT: </b>5% (between the Lewis and Clark Trailhead and Alice Creek) <br/><br/><b>RESOURCES:</b> Personnel: 204 Crews: 2 Engines: 16 Skidgens: 3 Dozers: 4 Helicopters: 3 <br/><br/><b>EVACUATIONS/ PRE-EVACUATIONS: </b>Lewis and Clark County Sheriff issued <b>mandatory evacuations </b>for residences in the Elk Meadows (Evergreen) subdivision and to ranches on Road 434/435 (north of Highway 200). A <b>Pre-evacuation notice</b> was given to residences located near Elk Meadows subdivision (about mile-marker 93) along Hwy 200 up to mile-marker 98. A Red Cross shelter is available in Helena at First Assembly of God Church (2210 Dodge Ave.) if needed. Please call 1-800-272-6668 for assistance. <br/><font face=\"'Times New Roman'\" size=\"3\"><b><br/>ROAD CLOSURES: </b>Lewis and Clark Co. Sheriff officers established road blocks at Elk Meadows driveway, the intersection of Hwy. 200 and Hwy. 434 and the intersection of Flat Creek Rd and Hwy. 434 to prevent unnecessary traffic from entering the fire area. <br/><br/></font><font face=\"'Times New Roman'\"><font size=\"3\"><b>TRAIL &amp; AREA CLOSURES: </b>Due to the fire activity, an area closure is in place that affects multiple trails and roads. A trail re-route is established for hikers along the Continental Divide National Scenic Trail. A map of the area closure is posted at: </font><a href=\"https://inciweb.nwcg.gov/incident/article/5410/39087/\"><font color=\"#0000ff\" size=\"3\">https://inciweb.nwcg.gov/incident/article/5410/39087/</font></a><font size=\"3\"> </font></font></font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T17:08:05-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Saturday July 22nd, 2017 approx.   06:37 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">16 miles northeast of Lincoln, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Russ Bird</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">On July 22 When The Fire Started, Firefighters Took Action To Put This Fire Out. Due To Inaccessible Terrain And Standing Dead Trees (at Least 99 Per Acre), Firefighters Were Not Able To Work Directly Against The Fire's Edge To Contain It. Instead, They Used Aircraft To Drop Retardant And Water To Slow The Fire's Growth. Where Possible, They Began Using Existing Trails To Construct Containment Lines To Stop The Fire\u2019s Growth. \n\nProlonged Hot, Dry And Windy Weather Arrived Aug. 24.  These Conditions Overpowered Aircraft And Eventually Forced Firefighters To Back Away As Extreme Fire Behavior Occurred. The Fire Made Long Runs In The Standing Dead Timber, Increasing The Fire\u2019s Growth And Activity Significantly. Since Aug. 24 Through Aug. 28, The Fire Has Grown Over 4,300 Acres. \n\nThe Alice Creek Fire Is Now Burning Near The Continental Divide In The Alice Creek Drainage, Falls Creek Drainage, Red Mountain And Lewis And Clark Pass Areas. Given The Steep Topography And Abundant Standing Dead Trees, Firefighters Are Taking Advantage Of Ridges, Areas Where The Timber Transitions To Grass And Other Natural Barriers To Stop The Fire\u2019s Growth. \n\nFirefighters Are Taking Proactive Measures To Protect Community Homes And Infrastructure In The Elk Meadows/evergreen Subdivision. \n\nFirefighters Are Using Opportunities Provided By Previous Burns, The Scapegoat Wilderness And The Adjacent Inventoried Roadless Area To Allow The Fire To Move Away From Values At Risk.\n\n\nResource Advisors Are Working With Firefighters To Help Them Take Actions That Prevent Aquatic Species From Being Transported Across The Continental Divide. They Are Also There To Assist With Reducing Wildland Fire Impacts, Especially In The Alice Creek Historical District Which Includes The Road To The Buffalo And The Lewis And Clark Trail.\n</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">204</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">7,440 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">5%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Monday October 02nd, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Dense timber with a litter and grass understory</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>3:30: </p>\n<p>The Fire is producing a visible smoke column that is coming from the western flank of the fire in Falls Creek Drainage. Around 11:30 today, airtankers dropped retardant along the Alice Mountain ridge top to try and keep it from crossing into Wildcat Gulch. </p>\n<p>Aircraft have been grounded because the winds are too strong for them to fly. When it is safe to do so, the helicopters will return to dropping water to cool hot spots. </p>\n<p>Though Elk Meadows remains under mandatory evacuations the Lewis and Clark County Sheriff is authorizing limited and controlled access to the properties for Elk Meadow residents who need access to their property to recover essential items. Please call 406-447-8293.  Your name and phone number will be collected by an on-duty dispatcher and given to a deputy.  The deputy will return the telephone call and make arrangements with the homeowner to access the property.  Law enforcement  dispatchers ask Elk Meadow residents to remain patient as access to the property will be contingent upon the availability of a deputy and subject to modifications due changes in fire behavior.</p>\n<p>Information locations to receive hard copies of the update and map are as follows:</p>\n<p> </p>\n<p>Augusta Area </p>\n<p>\u2022 Most businesses in Augusta </p>\n<p>\u2022 Info Board next to the General Store</p>\n<p>\u2022 Augusta Post Office </p>\n<p> </p>\n<p>Dearborn Area</p>\n<p>\u2022 Intersection of Dearborn Canyon Road &amp; Hwy 435, </p>\n<p>\u2022 Dearborn Trailhead </p>\n<p>\u2022 Dearborn Memorial Chapel </p>\n<p>\u2022 Hoon Spike Camp \t</p>\n<p>Wolf Creek Area </p>\n<p>\u2022 Little Wolf Creek Canyon</p>\n<p>\u2022 Wolf Creek Post Office</p>\n<p>\u2022 Fire Hall</p>\n<p>\u2022 Exxon Gas/Canyon Creek Store</p>\n<p></p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Keep new fire growth in West Falls Creek drainage from crossing over Alice Mountain ridge using aircraft to keep the fire cool.</p>\n<p>Keep ranchers and landowners directly east of the fire informed of fire activity and prepare for emergency response if winds push the fire further east.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>The fire is growing in all directions, depending on terrain slopes.  Growth is occurring on the southwestern flank today in West Falls Creek area. It is making short uphill runs with some group tree torching. </p>\n<p>Additional resources are beginning to arrive to help existing fire management resources.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>Mandatory evacuations remain in-place for residents in the Evergreen Subdivision (Elk Meadows subdivision); and ranches west of Road 434/435 north of Highway 200, due to the fire growth. </p>\n<p>Pre-evacuation notices were issued for residences off of Highway 200 between Elk Meadows (Evergreen) subdivision up to mile-marker 102.</p>\n<p>If interested in signing up for emergency notifications, sign up for Smart911 at: https://www.smart911.com/smart911/registration/registrationLanding.action </p>\n<p></p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p></p>\n<p>A Red Flag warning remains in effect for very low humidity and thunderstorms, through Thursday evening. </p>\n<p></p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "AUGUSTA, MT \u2013 Firefighters saw the Alice Creek Fire grow an additional 437 acres yesterday, mostly along the northern flank in upper drainage of East Fork of Falls Creek (drains to Dearborn Canyon). In the late afternoon, on the west flank, fire spotted into Wildcat Gulch. National Guard helicopters are dropping water to cool the fire in active areas while a handcrew is working to keep the fire west of Alice Mountain Ridge. Red flag conditions will prevail through the weekend. These conditions are for critically dry, hot windy weather. Winds from the northwest with gusts up to 28 mph are expected in the late afternoon. This could cause the fire to become very active, producing visible columns of smoke. Due to these conditions, the burning period is lasting well into the early morning hours. On the northeastern flank, firefighters have made good progress containing the fire from the northern tip (\u201cthe Hunting Lodge\u201d), south to Bedrock Creek. When wind is favorable, a handcrew...", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5410/", "type": "text/html", "rel": "alternate"}], "title": "Alice Creek Fire (Wildfire)", "geo_lat": "47.154166666667", "summary": "AUGUSTA, MT \u2013 Firefighters saw the Alice Creek Fire grow an additional 437 acres yesterday, mostly along the northern flank in upper drainage of East Fork of Falls Creek (drains to Dearborn Canyon). In the late afternoon, on the west flank, fire spotted into Wildcat Gulch. National Guard helicopters are dropping water to cool the fire in active areas while a handcrew is working to keep the fire west of Alice Mountain Ridge. Red flag conditions will prevail through the weekend. These conditions are for critically dry, hot windy weather. Winds from the northwest with gusts up to 28 mph are expected in the late afternoon. This could cause the fire to become very active, producing visible columns of smoke. Due to these conditions, the burning period is lasting well into the early morning hours. On the northeastern flank, firefighters have made good progress containing the fire from the northern tip (\u201cthe Hunting Lodge\u201d), south to Bedrock Creek. When wind is favorable, a handcrew...", "county": "Lewis and Clark County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Alice Creek Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5410/", "published": "Sat, 02 Sep 2017 17:08:05 -05:00", "geo_long": "-112.50166666667", "where": {"type": "Point", "coordinates": [-112.50166666667, 47.154166666667]}, "id": "https://inciweb.nwcg.gov/incident/5410/"}, "5437": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 1:07 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Liberty Fire\";\r\n\tvar defLat =  47.138611111111;\r\n\tvar defLng =  -113.77972222222;\r\n\tvar defLon =  -113.77972222222;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  47.138611111111;\r\n\tvar detailLng =  -113.77972222222;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.139 latitude, -113.78 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Liberty Fire Closure Area Map 9/2/17\" src=\"https://inciweb.nwcg.gov/photos/MTFHA/2017-07-31-1439-Liberty-Fire/highlight/2017_09_02-09.47.08.045-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTFHA/2017-07-31-1439-Liberty-Fire/picts/2017_09_02-09.47.08.045-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTFHA/2017-07-31-1439-Liberty-Fire/picts/2017_09_02-09.47.08.045-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font size=\"3\"><br/></font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T08:26:57-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Saturday July 15th, 2017 approx.   06:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">17 Miles SE of Arlee Montana in the South Fork Primitive Area.</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">GB IMT 3\nTaiga Rohrer</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Wildfire</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">478</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">15,545 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">22%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Sunday October 15th, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber (Litter and Understory</p>\n<p>Closed Timber Litter</p>\n<p>Timber (Grass and Understory)</p>\n<p>Heavy Dead/Down Component under the canopy</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Narrative:</p>\n<p>Temperatures still linger in the lower 80's and relative humidities remain in mid to upper teens. Skies </p>\n<p>were mostly clear allowing fire activity to increase earlier in the day.  As fire becomes active group </p>\n<p>torching occurs in the Gold Creek Peak and Black Mountain areas, while fire continues to back into </p>\n<p>Liberty Meadows.  The fire remains active in the Gold Creek Meadows and South Fork Jocko River area </p>\n<p>and  continues its westward advancement into the Rattlesnake Wilderness area and the Flathead South </p>\n<p>Fork Jocko Tribal Primitive Area.</p>\n<p></p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Resources on Divisions M, T, and U continue to maintain, improve, patrol, and hold containment lines,suppress spot fires, and mitigate hazard trees near road systems, through the use of mechanized </p>\n<p>equipment and handcrews, to impede fires progress. As weather conditions allow, firing operations off </p>\n<p>containnment lines to deepen said lines will continue. Aircraft is being used when available to support </p>\n<p>checking of fire growth and control spots. Divisions A, B, and C continue to be in monitor status in areas </p>\n<p>where fire continues to burn in the Rattlesnake Wilderness and the South Jocko Tribal Primitive Area. </p>\n<p>Some checking action has been underway in the western part of Division C. Suppression repair has </p>\n<p>begun on Divisions A and B and suppression repair needs are being evaluated on Division C and M. Fire resources continue to provide initial attack capability of new starts within the TFR.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>12 hours:</p>\n<p>Hot and dry weather conditions remained over fire today as temperatures rose to the upper </p>\n<p>70's to 80's and relative humidity dropped into the upper teens. Skies were mostly clear throughout the day, and winds were somewhat gusty.    Fire was active mostly on Divisions A, B, C, and U, where little suppression work has been accomplished to date.  Fire is mostly </p>\n<p>moving uphill in Divisions A and B, through heavy dead and downed fuels, with some torching. Fire is backing slowly downhill toward Liberty Creek, and should reach the riparian area by sometime Saturday, September 2.  Fire on Divisions M and T continues to burn within primary </p>\n<p>containment lines. The potential of spotting over containment lines is greatly reduced, as the line is blackened and effective mop-up is accomplished.</p>\n<p> </p>\n<p>24 hours:</p>\n<p>Gusty west to northwest winds should persist over the fire area, under mostly sunny skies. </p>\n<p>Temperatures should increase into the 80's, relative humidity should be in the low- to mid-teens, with Haines Index of 4.  Fire will remain active on Divisions A, B, C and U with uphill crown runs possible, and backing continuing into Liberty Creek in Division C.  Heat in divisions M and T will continue to decrease, as large fuels burn out and are mopped up.  Potential for spotting over containment lines is rapidly decreasing.</p>\n<p>48 hours:</p>\n<p>High pressure continues to build, and winds will be mostly terrain driven.  Fire should reach </p>\n<p>some points of the riparian area adjacent to Liberty Creek today.  Fire will remain active in the </p>\n<p>Primitive Area of Divisions A, B and U.  Decreasing fire activity is expected in Divisions M, T, and the lined portion of U. </p>\n<p>72 hours:</p>\n<p>High pressure remains with mostly sunny conditions, temperatures warming and humidity decreasing to the mid-teens.  Weather conditions continue to support active fire within the </p>\n<p>Primitive Area of Divisions A and B.  Backing will continue in Division C toward Liberty Creek.</p>\n<p>Anticipated after 72 hours:</p>\n<p>High pressure with warmer and drier conditions and decreased winds will </p>\n<p>support moderate to active fire within Divisions A and B.   Burnout of large fuels </p>\n<p>should be nearly complete in Divisions M, T, and U.</p>\n<p> </p>\n<p></p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>Confine Contain strategy has not changed.  Reduction in percent completion from original several weeks </p>\n<p>is due to a more accurate reflection of remaining operational needs and reporting strategy.  </p>\n<p>The operational strategy is due to factors including elevated risk for personnel constructing direct line in </p>\n<p>heavy timber and snags with a low probability of success. Instead an indirect containment strategy is </p>\n<p>used with natural fuel barriers and light fuels with little or no hazardous snags and constructed fire line.  </p>\n<p>Approximately 33.7 miles of indirect line has been constructed and 12.9 miles of direct containment line </p>\n<p>has been completed.  Indirect containment lines are not complete or considered \"controlled\" lines until </p>\n<p>the fire has reached those lines or they have been burnt out.  Control means little likelihood that fire will </p>\n<p>escape the line.  Change in completion percent reflects that the east side of the fire will not be </p>\n<p>completed until fire is held at the lines - approximately 70% of current fire perimeter.  The remaining </p>\n<p>30%, or west side of fire, will be managed under a confinement strategy within Wilderness and </p>\n<p>Primitive areas and few containment lines will actually be put in place due to resource concerns, low </p>\n<p>probability of spread, and increased risk in heavy timber. </p>\n<p> </p>\n<p>Management Action Points have been developed for implementation in the long term strategy. </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Observed: </p>\n<p>Dry westerly flow prevailed across the incident on Friday as upper </p>\n<p>level high pressure was building along the west coast.  Winds were </p>\n<p>primarily terrain driven across the mid slopes and valleys before </p>\n<p>becoming west to northwest at 10 to 15 mph in the afternoon while </p>\n<p>west to northwest winds up to 20 mph prevailed all day along the </p>\n<p>ridge tops. Highs topped out on the upper 70s to lower 80s in the </p>\n<p>higher elevations and mid-80s in the lower elevations. Humidity dropped into the mid to upper teens across the incident. </p>\n<p>Forecasted: </p>\n<p>Dry conditions will continue on Saturday as the upper level high pressure continues to build over the region. Minimum humidity </p>\n<p>recovery is expected to be poor, only recovering into the 30th percentile. Highs on Saturday are expected to climb into the lower </p>\n<p>to mid-80s in the higher elevations and into the lower 90s in the </p>\n<p>valleys. Humidity will drop into the teens across the entire incident. </p>\n<p>Winds are forecast to increase to the WSW at 10 to 15 mph during the afternoon with gusts near 20 mph along the ridge tops. </p></td></tr></table>\n</div>", "summary_detail": null, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5437/", "type": "text/html", "rel": "alternate"}], "title": "Liberty Fire (Wildfire)", "geo_lat": "47.138611111111", "summary": null, "county": "Missoula County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Liberty Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5437/", "published": "Sat, 02 Sep 2017 21:50:24 -05:00", "geo_long": "-113.77972222222", "where": {"type": "Point", "coordinates": [-113.77972222222, 47.138611111111]}, "id": "https://inciweb.nwcg.gov/incident/5437/"}, "5375": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">ANNOUNCEMENT</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Community Open House - September 5, 2017</strong><br/>The Lolo Peak Fire Community Open House is scheduled for Tuesday, September 5, 2017 at 7:00pm. The open house will be held at the Stevensville High School, 300 Park Street, Stevensville, MT <a class=\"more\" href=\"/incident/article/5375/39707/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 7 MIN. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Lolo Peak Fire\";\r\n\tvar defLat =  46.675;\r\n\tvar defLng =  -114.27;\r\n\tvar defLon =  -114.27;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  46.675;\r\n\tvar detailLng =  -114.27;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  46.675 latitude, -114.27 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Lolo Peak Fire Information Map September 2, 2017\" src=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-17-1952-Lolo-Peak-Fire/highlight/2017_09_02-14.55.42.257-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-17-1952-Lolo-Peak-Fire/picts/2017_09_02-14.55.42.257-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-17-1952-Lolo-Peak-Fire/picts/2017_09_02-14.55.42.257-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font size=\"5\">Click on the links below for additional information: <br/> </font><font size=\"5\"><a href=\"https://www.facebook.com/lolonationalforest/videos/861918027300323/\" target=\"_self\">Evening Briefing September 2, 2017<br/></a><br/></font><a href=\"http://tinyurl.com/y8n6d53l\" target=\"_self\"><font size=\"5\">Interactive IR Map</font></a><br/></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T22:37:15-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning/natural</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Saturday July 15th, 2017 approx.   02:34 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">10 miles southwest of Lolo, Montana</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Doug Turman Northern Rockies National Incident Management Team 2</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Lolo Peak Fire Is A Long Duration Wildfire With The Potential To Reach The Corridors Of Highway 12 And Highway 93. </td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">476</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">42,687 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">31%</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Above 7,000 feet, generally sparse and/or patchy sub-alpine fir with dead Whitebark pine. Below 7,000 feet mixed conifers that vary in composition, density, and dead/down levels. With more Lodgepole pine, higher intensity burning and with more Larch, less intense burning.  Lower elevations near containment lines are Ponderosa pine with grass under-story.  </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Rates of spread on the head of the fire are moderately slow in mixed conifer forest and slow in Ponderosa pine. Spotting significantly contributes to fire spread, especially in mixed conifer.</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Branch 1 Continue to maintain anchor points, mop up, hold completed line and patrol.  Branch II Burnout continues south of One Horse Canyon. Hold completed line and continue to mop up as appropriate. Fire managers will continue to assess for opportunities to mitigate risk and engage in suppression activities to stay ahead of the interior fire front. Structure group - patrol, monitor, and mop up in all accessible areas of the branch. Support other functions as necessary. Support local agencies with initial attack resources within the established temporary flight restriction area.  (TFR) Night Shift: Monitor, patrol, and continue day shift suppression actions as needed.    </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>***Fire Weather Watch in effect from Sunday afternoon through Monday evening*** Active fire movement will continue into the evening due to poor relative humidity recovery.  The fire is burning actively south of One Horse Creek. Active fire behavior is expected as weather conditions continue to be hot, dry and windy. Uphill runs with spotting will be possible with single and group torching likely. This fire behavior is expected along the entire southern flank of the fire.   </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>Unified command remains in place between Turman's Type 1 Incident Management Team, Missoula County Rural Fire and Ravalli County Fire Warden.  Reported containment reflects portions of the perimeter where the fire has been engaged at control lines and has been contained. A large portion of the fire along the southwest, south, and southeast perimeter has not reached containment lines at this time.   </p>\n<p></p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>***FIRE WEATHER WATCH IN EFFECT FROM SUNDAY AFTERNOON THROUGH MONDAY EVENING***  Gusty winds and very low humidity many combine to create Red Flag conditions Sunday afternoon and evening. Wind will shift to east Sunday night and remain dry, extending Red Flag conditions through Monday evening. Winds: West 10 to 20 mph, gusting to 30 mph Sunday night through Monday evening. Minimum humidity: 8 to 13 percent.      </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Click on the links below for additional information:  Evening Briefing September 2, 2017Interactive IR", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5375/", "type": "text/html", "rel": "alternate"}], "title": "Lolo Peak Fire (Wildfire)", "geo_lat": "46.675", "summary": "Click on the links below for additional information:  Evening Briefing September 2, 2017Interactive IR", "county": "Missoula County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Lolo Peak Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5375/", "published": "Sat, 02 Sep 2017 22:50:57 -05:00", "geo_long": "-114.27", "where": {"type": "Point", "coordinates": [-114.27, 46.675]}, "id": "https://inciweb.nwcg.gov/incident/5375/"}, "5541": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 12 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Conrow Fire\";\r\n\tvar defLat =  45.933611111111;\r\n\tvar defLng =  -111.98888888889;\r\n\tvar defLon =  -111.98888888889;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  45.933611111111;\r\n\tvar detailLng =  -111.98888888889;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  45.934 latitude, -111.989 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Topographic map showing perimeter of Conrow Fire\" src=\"https://inciweb.nwcg.gov/photos/MTBDF/2017-08-27-1223-Conrow/highlight/2017_09_02-10.59.25.179-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTBDF/2017-08-27-1223-Conrow/picts/2017_09_02-10.59.25.179-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTBDF/2017-08-27-1223-Conrow/picts/2017_09_02-10.59.25.179-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font size=\"4\"><b><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font><font face=\"Times New Roman\"> </font> <font face=\"Times New Roman\"> </font> </b></font></p><font size=\"4\"><b><u>Saturday, September 2 - 9:45 a.m.</u><br/><i>2,727 acres - 95% contained <br/><br/></i></b> Crews will mop-up and patrol. The spike camps will be removed and returned to Whitehall. Additional resources will be released as the fire threat diminishes.<br/><br/>This fire will transition to a local Type IV organization on Sunday morning, September 3rd. They will have a smaller presence commensurate with the expected daily fire activity in the future. There will be an aerial or ground presence monitoring the fire. It is expected that periodic columns of smoke may rise out of the fires interior as unburned fuels ignite.<br/><b><i> <br/>Future updates will be posted only if significant activities occur.</i></b><br/><b> </b><br style=\"margin: 0px; padding: 0px; text-align: left; color: rgb(0, 0, 0); text-transform: none; text-indent: 0px; letter-spacing: normal; font-family: Arial; font-size: medium; font-style: normal; font-weight: normal; word-spacing: 0px; white-space: normal; orphans: 2; widows: 2; background-color: rgb(217, 212, 195); font-variant-ligatures: normal; font-variant-caps: normal; -webkit-text-stroke-width: 0px; text-decoration-style: initial; text-decoration-color: initial;\"/><br/><br/></font><font face=\"Arial\" size=\"4\"><p align=\"LEFT\"></p></font><br/><br/><font face=\"Arial\"><b><font size=\"3\"> </font></b><font size=\"3\"><b> </b></font></font></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-01T18:57:23-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Thursday August 24th, 2017 approx.   10:30 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">7 NE of Whitehall, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Tyler Hecht-Qualfifie</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">169</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">2,727 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">95%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Wednesday September 06th, 2017 approx.   06:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Tall Grass, Brush, Timber (litter and understory)</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Minimal - creeping, backing, smoldering. Fire continues to burn on the surface, and understory of a green island. The green island is comprised of mixed conifer and is located at the interior of the burned area.</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Resources will continue to mop up and patrol the fire perimeter.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>Minimal fire behavior is expected. Firefighters will continue mop up and patrol.</p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>A red flag warning is in effect until 9PM Friday.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Saturday, September 2 - 9:45 a.m.2,727 acres - 95% contained  Crews will mop-up and patrol. The spike camps will be removed and returned to Whitehall. Additional resources will be released as the fire threat diminishes.This fire will transition to a local Type IV organization on Sunday morning, September 3rd. They will have a smaller presence commensurate with the expected daily fire activity in the future. There will be an aerial or ground presence monitoring the fire. It is expected that periodic columns of smoke may rise out of the fires interior as unburned fuels ignite. Future updates will be posted only if significant activities occur.", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5541/", "type": "text/html", "rel": "alternate"}], "title": "Conrow Fire (Wildfire)", "geo_lat": "45.933611111111", "summary": "Saturday, September 2 - 9:45 a.m.2,727 acres - 95% contained  Crews will mop-up and patrol. The spike camps will be removed and returned to Whitehall. Additional resources will be released as the fire threat diminishes.This fire will transition to a local Type IV organization on Sunday morning, September 3rd. They will have a smaller presence commensurate with the expected daily fire activity in the future. There will be an aerial or ground presence monitoring the fire. It is expected that periodic columns of smoke may rise out of the fires interior as unburned fuels ignite. Future updates will be posted only if significant activities occur.", "county": "Jefferson County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Conrow Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5541/", "published": "Sat, 02 Sep 2017 10:59:44 -05:00", "geo_long": "-111.98888888889", "where": {"type": "Point", "coordinates": [-111.98888888889, 45.933611111111]}, "id": "https://inciweb.nwcg.gov/incident/5541/"}, "5419": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">NEWS RELEASE</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Buffalo Fire July 30, 9 a.m. update</strong><br/>   July 30, 2017 9 a.m.   Buffalo Fire Update                 Fire Information (406) 852-2091 BuffaloFire2017@gmail.com      https://inciweb.nwcg.gov/incident/5419/          Incident: Lightning on... <a class=\"more\" href=\"/incident/article/5419/37102/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 7/31/2017</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Buffalo Fire\";\r\n\tvar defLat =  45.041111111111;\r\n\tvar defLng =  -105.73083333333;\r\n\tvar defLon =  -105.73083333333;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  45.041111111111;\r\n\tvar detailLng =  -105.73083333333;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  45.041 latitude, -105.731 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Members of the J. Franco Type 2 Crew 14 dig out a smoldering root along the fire line of the Buffalo Fire on Thursday, July 28, 2017. Mop-up, removing or extinguishing all burning material along the fire perimeter, is well under way for the 3,104-acre fir\" src=\"https://inciweb.nwcg.gov/photos/MTMCD/2017-07-25-1121-Buffalo-Fire/highlight/2017_07_28-18.37.23.745-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTMCD/2017-07-25-1121-Buffalo-Fire/picts/2017_07_28-18.37.23.745-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTMCD/2017-07-25-1121-Buffalo-Fire/picts/2017_07_28-18.37.23.745-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font face=\"Arial\" size=\"3\"><b><u>Monday, July 31 - 9:00 a.m.<br/></u>3,020 acres - 100% contained</b><br/><br/>(Final Update) Shawn Taylor's Type 3 team has assumed command of the Buffalo Fire. Mop up and patrol of the fire perimeter will continue as will the rehabilitation of dozer lines and other disturbance associated with suppression activities.</font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-07-31T09:59:13-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Monday July 24th, 2017 approx.   12:45 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">31 miles SW of Broadus, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Shawn Turner</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Size</th><td class=\"cell3\">3,020 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">100%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Sunday July 30th, 2017 approx.   08:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Pine, grass, sagebrush</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Minimal smoldering</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Continue mop up and suppression repair activities. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>Crews continue to mop up and patrol containment lines.  Suppression repair activities are continuing. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>Transfer of command of the Buffalo Fire from Alaska Type 1 IMT  to Turner's Type 3 organization will occurred Sunday morning, July 30.</p>\n<p></p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Monday, July 31 - 9:00 a.m.3,020 acres - 100% contained(Final Update) Shawn Taylor's Type 3 team has assumed command of the Buffalo Fire. Mop up and patrol of the fire perimeter will continue as will the rehabilitation of dozer lines and other disturbance associated with suppression", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5419/", "type": "text/html", "rel": "alternate"}], "title": "Buffalo Fire (Wildfire)", "geo_lat": "45.041111111111", "summary": "Monday, July 31 - 9:00 a.m.3,020 acres - 100% contained(Final Update) Shawn Taylor's Type 3 team has assumed command of the Buffalo Fire. Mop up and patrol of the fire perimeter will continue as will the rehabilitation of dozer lines and other disturbance associated with suppression", "county": "Powder River County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Buffalo Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5419/", "published": "Mon, 31 Jul 2017 10:01:11 -05:00", "geo_long": "-105.73083333333", "where": {"type": "Point", "coordinates": [-105.73083333333, 45.041111111111]}, "id": "https://inciweb.nwcg.gov/incident/5419/"}, "5544": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">NEWS RELEASE</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Wednesday Evening Fire Update</strong><br/>Fire resources worked a full day ensuring that the fire does not have any potential to rekindle or loft embers over the fire line. Fire resources will be demobilized tomorrow, Thursday, August 31st... <a class=\"more\" href=\"/incident/article/5544/39470/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 3 DAYS AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Mendenhall Fire\";\r\n\tvar defLat =  45.664166666667;\r\n\tvar defLng =  -110.20472222222;\r\n\tvar defLon =  -110.20472222222;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  45.664166666667;\r\n\tvar detailLng =  -110.20472222222;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  45.664 latitude, -110.205 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Firefighter mopping up hot spot\" src=\"https://inciweb.nwcg.gov/photos/MTMTS/2017-08-27-2314-Mendenhall-Fire/highlight/2017_08_30-10.33.15.447-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTMTS/2017-08-27-2314-Mendenhall-Fire/picts/2017_08_30-10.33.15.447-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTMTS/2017-08-27-2314-Mendenhall-Fire/picts/2017_08_30-10.33.15.447-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font face=\"Arial\" size=\"3\">The Mendenhall Fire was reported at 1:10 p.m. on August 26, 2017. Local fire resources responded quickly to the fire, in conjunction with the Sweet Grass &amp; Park County Sheriff\u2019s Office initiating evacuations for residents on the West Boulder Road within Sweet Grass County. The Big Timber Volunteer Fire Department and other local fire resources did a great job in stopping the spread of the fire and providing structure protection. Big Timber Fire Volunteer Fire Department, McLeod Rural Fire Crew, Park County Rural Fire, Montana DNRC and U.S. Forest Service were among the initial attack resources. The Montana Department of Natural Resources and Conservation\u2019s County Assist Team was brought in to provide support local fire resources in the effort to suppress the fire. The team was in-briefed Sunday at 6:00 p.m. and assumed management of the fire at that time.<br/> <br/>CHECK OUT OUR FIRE FACEBOOK PAGE FOR MORE PICTURES <b><a href=\"https://www.facebook.com/MendenhallFire/\" target=\"_blank\">@MendenhallFire </a></b></font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-08-30T21:04:45-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Under Investigation</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Saturday August 26th, 2017 approx.   01:15 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">1/2 mile W of McLeod, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">David Hamilton, MT Dept. of Natural Resources and Conservation, County Assist Team</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Full Suppression Management Strategy</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">134</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">1,275 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">100%</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Short Grass, Brush, and Timber</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Fire resources will be demobilized tomorrow, Thursday, August 31st and be re-assigned to another fire. The MT DNRC County Assist Team will be turning the fire over to Chief Novotny with Sweet Grass County Fire Department at 6:00 am tomorrow and also be re-assigned to another fire.   </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Mendenhall Fire was reported at 1:10 p.m. on August 26, 2017. Local fire resources responded quickly to the fire, in conjunction with the Sweet Grass & Park County Sheriff\u2019s Office initiating evacuations for residents on the West Boulder Road within Sweet Grass County. The Big Timber Volunteer Fire Department and other local fire resources did a great job in stopping the spread of the fire and providing structure protection. Big Timber Fire Volunteer Fire Department, McLeod Rural Fire Crew, Park County Rural Fire, Montana DNRC and U.S. Forest Service were among the initial attack resources. The Montana Department of Natural Resources and Conservation\u2019s County Assist Team was brought in to provide support local fire resources in the effort to suppress the fire. The team was in-briefed Sunday at 6:00 p.m. and assumed management of the fire at that time. CHECK OUT OUR FIRE FACEBOOK PAGE FOR MORE PICTURES @MendenhallFire", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5544/", "type": "text/html", "rel": "alternate"}], "title": "Mendenhall Fire (Wildfire)", "geo_lat": "45.664166666667", "summary": "The Mendenhall Fire was reported at 1:10 p.m. on August 26, 2017. Local fire resources responded quickly to the fire, in conjunction with the Sweet Grass & Park County Sheriff\u2019s Office initiating evacuations for residents on the West Boulder Road within Sweet Grass County. The Big Timber Volunteer Fire Department and other local fire resources did a great job in stopping the spread of the fire and providing structure protection. Big Timber Fire Volunteer Fire Department, McLeod Rural Fire Crew, Park County Rural Fire, Montana DNRC and U.S. Forest Service were among the initial attack resources. The Montana Department of Natural Resources and Conservation\u2019s County Assist Team was brought in to provide support local fire resources in the effort to suppress the fire. The team was in-briefed Sunday at 6:00 p.m. and assumed management of the fire at that time. CHECK OUT OUR FIRE FACEBOOK PAGE FOR MORE PICTURES @MendenhallFire", "county": "Sweet Grass County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Mendenhall Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5544/", "published": "Wed, 30 Aug 2017 21:06:06 -05:00", "geo_long": "-110.20472222222", "where": {"type": "Point", "coordinates": [-110.20472222222, 45.664166666667]}, "id": "https://inciweb.nwcg.gov/incident/5544/"}, "5389": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 7/27/2017</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Crying Fire\";\r\n\tvar defLat =  47.323333333333;\r\n\tvar defLng =  -108.03472222222;\r\n\tvar defLon =  -108.03472222222;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  47.323333333333;\r\n\tvar detailLng =  -108.03472222222;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.323 latitude, -108.035 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Crying Fire BLM PhotoBy Anika Peila July 23_2017\" src=\"https://inciweb.nwcg.gov/photos/MTLED/2017-07-19-2020-Crying-Fire/highlight/2017_07_24-17.33.40.061-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTLED/2017-07-19-2020-Crying-Fire/picts/2017_07_24-17.33.40.061-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTLED/2017-07-19-2020-Crying-Fire/picts/2017_07_24-17.33.40.061-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"background: white; margin: 0in 0in 0pt; line-height: normal;\"><b><u></u></b><font size=\"3\"><b><u>Thursday, July 27- 4:45 p.m.</u></b><br/></font></p><p style=\"background: white; margin: 0in 0in 0pt; line-height: normal;\"><font size=\"3\"><br/></font></p><p style=\"background: white; margin: 0in 0in 0pt; line-height: normal;\"><font size=\"4\">7,925 acres - 100% contained<br/></font></p><p style=\"background: white; margin: 0in 0in 0pt; line-height: normal;\"><font size=\"4\"><br/></font></p><font color=\"#000000\" face=\"Times New Roman\" size=\"4\"> </font><p style=\"background: white; margin: 0in 0in 0pt; line-height: normal;\"><font size=\"4\"> </font></p><font color=\"#000000\" face=\"Times New Roman\" size=\"4\"> </font><p style=\"background: white; margin: 0in 0in 0pt; line-height: normal;\"><font size=\"4\">Located in Petroleum County west of the Musselshell River and about 50 miles north of Winnett, Mont., t</font><font size=\"3\"><font size=\"4\">he Crying Fire was reported mid-day July 19, 2017 and burned in grass, sage and timber on BLM, Private, State and Charles M. Russ<font size=\"4\">ell National Wildlife Refuge lands. The fire was lightning caused.Crews responded from the U.S. Bureau of Land Management, U.S. Fish &amp; Wildlife Service, U.S. Forest Service, Montana Dept. of Natural Resources and Petroleum County. No accidents or injuries occurred. Two outbuildings were lost.</font></font></font><br/></p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-07-27T17:45:25-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning/natural</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Wednesday July 19th, 2017 approx.   12:15 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">50 miles north of Winnett, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Curtis Ritzman</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Wildfire</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Size</th><td class=\"cell3\">7,295 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">100%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Wednesday July 26th, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Short Grass (1 foot), Brush (2 feet),Timber (Grass and Understory)</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Projected Incident Activity</th><td class=\"cell3\"><p>No expected growth projected.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Thursday, July 27- 4:45 p.m.7,925 acres - 100% contained   Located in Petroleum County west of the Musselshell River and about 50 miles north of Winnett, Mont., the Crying Fire was reported mid-day July 19, 2017 and burned in grass, sage and timber on BLM, Private, State and Charles M. Russell National Wildlife Refuge lands. The fire was lightning caused.Crews responded from the U.S. Bureau of Land Management, U.S. Fish & Wildlife Service, U.S. Forest Service, Montana Dept. of Natural Resources and Petroleum County. No accidents or injuries occurred. Two outbuildings were lost.", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5389/", "type": "text/html", "rel": "alternate"}], "title": "Crying Fire (Wildfire)", "geo_lat": "47.323333333333", "summary": "Thursday, July 27- 4:45 p.m.7,925 acres - 100% contained   Located in Petroleum County west of the Musselshell River and about 50 miles north of Winnett, Mont., the Crying Fire was reported mid-day July 19, 2017 and burned in grass, sage and timber on BLM, Private, State and Charles M. Russell National Wildlife Refuge lands. The fire was lightning caused.Crews responded from the U.S. Bureau of Land Management, U.S. Fish & Wildlife Service, U.S. Forest Service, Montana Dept. of Natural Resources and Petroleum County. No accidents or injuries occurred. Two outbuildings were lost.", "county": "Petroleum County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Crying Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5389/", "published": "Thu, 27 Jul 2017 17:47:41 -05:00", "geo_long": "-108.03472222222", "where": {"type": "Point", "coordinates": [-108.03472222222, 47.323333333333]}, "id": "https://inciweb.nwcg.gov/incident/5389/"}, "5355": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 7/17/2017</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Blue Ridge Complex\";\r\n\tvar defLat =  47.409166666667;\r\n\tvar defLng =  -107.81138888889;\r\n\tvar defLon =  -107.81138888889;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  47.409166666667;\r\n\tvar detailLng =  -107.81138888889;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.409 latitude, -107.811 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Unburned trees with burned surface below\" src=\"https://inciweb.nwcg.gov/photos/MTMCD/2017-07-11-2342-Blue-Ridge-Complex/highlight/2017_07_12-19.38.12.581-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTMCD/2017-07-11-2342-Blue-Ridge-Complex/picts/2017_07_12-19.38.12.581-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTMCD/2017-07-11-2342-Blue-Ridge-Complex/picts/2017_07_12-19.38.12.581-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font size=\"3\"><font face=\"Arial\"><b><u>Monday, July 17 - 6:00 a.m.</u></b><br/><font color=\"#000000\"> </font></font></font></p><p style=\"margin: 0in 0in 0pt; line-height: normal;\"><font face=\"Arial\" size=\"3\"></font></p><font color=\"#000000\" size=\"3\"><p style=\"margin: 0in 0in 0pt; line-height: normal;\"><font face=\"Arial\"> </font></p><p style=\"margin: 0in 0in 0pt; line-height: normal;\"><font face=\"Arial\">1,733 acres, 100% contained<br/><br/> </font></p><p style=\"margin: 0in 0in 0pt; line-height: normal;\"><font face=\"Arial\">3,034 acres - 85% contained</font><br/><br/>Fire fighters continue to monitor fire due to heavy dead/down fuels that required extensive mop-up. Full containment is expected later today</p><p style=\"margin: 0in 0in 0pt; line-height: normal;\"><font face=\"Arial\"> </font></p></font><p style=\"margin: 0in 0in 0pt; line-height: normal;\"></p><p style=\"margin: 0in 0in 0pt; line-height: normal;\"></p><p style=\"margin: 0in 0in 0pt; line-height: normal;\"><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 0in 0in 0pt; line-height: normal;\"><br/><font color=\"#000000\"><font color=\"#131313\" face=\"Arial\" size=\"3\"></font><br/><font face=\"Arial\" size=\"3\"> </font></font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-07-17T07:32:30-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Unknown</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Monday July 10th, 2017 approx.   11:10 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">39 miles NW of Jordan, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Breninger</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">74</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">3,034 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">85%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Monday July 17th, 2017 approx.   06:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Hardwood litter, Timber (Grass and Understory)Brush (2 feet)</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Minimal smoldering</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Continue to monitor fire due to heavy dead/down fuels that required extensive mop-up.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>No projected spread at this time.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>IA resources were released and fire transitioned to ICT4 to monitor containment lines.</p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Temperatures are predicted in the triple digits tomorrow.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Monday, July 17 - 6:00 a.m.  1,733 acres, 100% contained 3,034 acres - 85% containedFire fighters continue to monitor fire due to heavy dead/down fuels that required extensive mop-up. Full containment is expected later today", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5355/", "type": "text/html", "rel": "alternate"}], "title": "Blue Ridge Complex (Wildfire)", "geo_lat": "47.409166666667", "summary": "Monday, July 17 - 6:00 a.m.  1,733 acres, 100% contained 3,034 acres - 85% containedFire fighters continue to monitor fire due to heavy dead/down fuels that required extensive mop-up. Full containment is expected later today", "county": "Garfield County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Blue Ridge Complex (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5355/", "published": "Mon, 17 Jul 2017 07:36:17 -05:00", "geo_long": "-107.81138888889", "where": {"type": "Point", "coordinates": [-107.81138888889, 47.409166666667]}, "id": "https://inciweb.nwcg.gov/incident/5355/"}, "5519": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">CLOSURE</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>8-29-17 Trail Closures due to Dolly Varden Fire, Order #D04-149-S-17</strong><br/> D04-149-S-17FLATHEAD NATIONAL FOREST 650 Wolfpack Way Kalispell, MT 59901 Forest Supervisor\u2019s Order    TRAIL RESTRICTION ORDER   Chair Mountain Connector Trail #686, a section of the Chair... <a class=\"more\" href=\"/incident/article/5519/39794/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 1:32 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Dolly Varden Fire\";\r\n\tvar defLat =  48.012222222222;\r\n\tvar defLng =  -113.17833333333;\r\n\tvar defLon =  -113.17833333333;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  48.012222222222;\r\n\tvar detailLng =  -113.17833333333;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  48.012 latitude, -113.178 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Dolly Varden 8-27-2017\" src=\"https://inciweb.nwcg.gov/photos/MTFNF/2017-08-18-1239-Dolly-Varden/highlight/2017_08_27-20.02.34.218-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTFNF/2017-08-18-1239-Dolly-Varden/picts/2017_08_27-20.02.34.218-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTFNF/2017-08-18-1239-Dolly-Varden/picts/2017_08_27-20.02.34.218-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 0in 0in 8pt;\">The Dolly Varden Fire was reported at approximately 7:30pm on Tuesday, August 15th. The incident is located 5\u00bd miles southeast of Schafer Meadows Work Center, above Dolly Varden Creek, in the Great Bear Wilderness on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role, with consideration for public and fire fighter safety, point protection of historic resources and trail infrastructure. The fire is being managed by the Spotted Bear Ranger District. <br/> <br/><u>Summary</u><br/><br/>The fire is currently 185 acres. Incremental growth due to creeping and backing downhill was observed below the trail. Additional closures on Dolly Varden and Argosy Trails are in place. A Wildland Fire Module from New Mexico is currently working out of Schafer Meadows to monitor fire activity. Smoke is also visible from Spotted Bear Lookout.</p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T21:25:32-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning/ Natural</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Tuesday August 15th, 2017 approx.   07:30 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">Dolly Varden Creek/Chair Mountain in the Great Bear Wilderness</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Duty Officer</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">The Fire Management Strategy Is 85% Monitor And 15% Point Protection.</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">3</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">185 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Wednesday November 01st, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber (litter and understory), heavy timber and snags.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Incremental growth due to creeping and backing downhill was observed below the trail. Additional closures on Dolly Varden and Argosy Trails are in place.</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Monitor fire with aerial resources and from Schafer Meadows Work Center. Point protection around structures at Schafer Meadows Work Center. Continue public information trapline and communicating with outfitters and guides in the wilderness. A Wildland Fire Module from New Mexico is staffing Schafer Meadows Work Center. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>Flanking, backing, and rollout with possible torching.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>The Schafer Meadows Work Center is a major center of USFS operations for the Middle Fork area. It hosts an open airstrip, corrals, campground, and seven structures on the National Register of Historic Places, including the Historic Ranger Station. It is actively used for administrative purposes. </p>\n<p>THE FOLLOWING TRAILS ARE CLOSED:</p>\n<p>FS Trail #686 in its entirety.</p>\n<p>FS Trail #241 from the junction with FS Trail #173 to the junction with FS Trail #346.</p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Hot and dry conditions are expected to continue.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Dolly Varden Fire was reported at approximately 7:30pm on Tuesday, August 15th. The incident is located 5\u00bd miles southeast of Schafer Meadows Work Center, above Dolly Varden Creek, in the Great Bear Wilderness on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role, with consideration for public and fire fighter safety, point protection of historic resources and trail infrastructure. The fire is being managed by the Spotted Bear Ranger District.  SummaryThe fire is currently 185 acres. Incremental growth due to creeping and backing downhill was observed below the trail. Additional closures on Dolly Varden and Argosy Trails are in place. A Wildland Fire Module from New Mexico is currently working out of Schafer Meadows to monitor fire activity. Smoke is also visible from Spotted Bear", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5519/", "type": "text/html", "rel": "alternate"}], "title": "Dolly Varden Fire (Wildfire)", "geo_lat": "48.012222222222", "summary": "The Dolly Varden Fire was reported at approximately 7:30pm on Tuesday, August 15th. The incident is located 5\u00bd miles southeast of Schafer Meadows Work Center, above Dolly Varden Creek, in the Great Bear Wilderness on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role, with consideration for public and fire fighter safety, point protection of historic resources and trail infrastructure. The fire is being managed by the Spotted Bear Ranger District.  SummaryThe fire is currently 185 acres. Incremental growth due to creeping and backing downhill was observed below the trail. Additional closures on Dolly Varden and Argosy Trails are in place. A Wildland Fire Module from New Mexico is currently working out of Schafer Meadows to monitor fire activity. Smoke is also visible from Spotted Bear", "county": "Flathead County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Dolly Varden Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5519/", "published": "Sat, 02 Sep 2017 21:25:49 -05:00", "geo_long": "-113.17833333333", "where": {"type": "Point", "coordinates": [-113.17833333333, 48.012222222222]}, "id": "https://inciweb.nwcg.gov/incident/5519/"}, "5557": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 2 DAYS AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Stone Lake Fire\";\r\n\tvar defLat =  45.685555555556;\r\n\tvar defLng =  -113.27305555556;\r\n\tvar defLon =  -113.27305555556;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  45.685555555556;\r\n\tvar detailLng =  -113.27305555556;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  45.686 latitude, -113.273 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Modified fire restrictions\" src=\"https://inciweb.nwcg.gov/photos/MTBDF/2017-08-30-1030-Stone-Lake-Fire/highlight/2017_08_31-10.38.08.995-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTBDF/2017-08-30-1030-Stone-Lake-Fire/picts/2017_08_31-10.38.08.995-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTBDF/2017-08-30-1030-Stone-Lake-Fire/picts/2017_08_31-10.38.08.995-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p>The Stone Lake fire was contained August 31, 2017, at 6:15. The fire will be monitored for any further activity.</p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-01T10:18:19-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Wednesday August 27th, 2014 approx.   02:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">Approximately 15 miles SW of Wise River MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">US Forest Service, Wisdom District</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Size</th><td class=\"cell3\">8 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">100%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Thursday August 31st, 2017 approx.   06:15 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Whitebark Pine</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>The fire is contained and will be in monitor and patrol status.</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>All personnel will be coming off the fire today.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Stone Lake fire was contained August 31, 2017, at 6:15. The fire will be monitored for any further", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5557/", "type": "text/html", "rel": "alternate"}], "title": "Stone Lake Fire (Wildfire)", "geo_lat": "45.685555555556", "summary": "The Stone Lake fire was contained August 31, 2017, at 6:15. The fire will be monitored for any further", "county": "Beaverhead County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Stone Lake Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5557/", "published": "Fri, 01 Sep 2017 10:19:56 -05:00", "geo_long": "-113.27305555556", "where": {"type": "Point", "coordinates": [-113.27305555556, 45.685555555556]}, "id": "https://inciweb.nwcg.gov/incident/5557/"}, "5549": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">ANNOUNCEMENT</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Evacuation Order lifted by Ravalli County Sheriff's Office </strong><br/>Announcement by Ravalli County Sheriff Steve Holton at 8:35am on Sept. 1st: \"Residents on Nez Perce Road evacuated due to the Nelson Creek Fire can now return home under a Warning status. Residents... <a class=\"more\" href=\"/incident/article/5549/39644/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 6 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Nelson Creek\";\r\n\tvar defLat =  45.815555555556;\r\n\tvar defLng =  -114.31972222222;\r\n\tvar defLon =  -114.31972222222;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  45.815555555556;\r\n\tvar detailLng =  -114.31972222222;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  45.816 latitude, -114.32 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"map\" src=\"https://inciweb.nwcg.gov/photos/MTBRF/2017-08-29-1141-Nelson-Creek/highlight/2017_09_02-15.26.18.827-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTBRF/2017-08-29-1141-Nelson-Creek/picts/2017_09_02-15.26.18.827-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTBRF/2017-08-29-1141-Nelson-Creek/picts/2017_09_02-15.26.18.827-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font face=\"Arial\"><font size=\"3\"><font color=\"#000000\">Firefighters are working to suppress a wildland fire burning on the West Fork Ranger District </font><font color=\"#000000\">near Nelson Creek Trailhead.</font><font color=\"#000000\"> The fire is 270 acres in size and 30% contained. It was discovered on Monday, August 28 by the Bare Cone Lookout. The cause is unknown. Most</font><font color=\"#000000\"> of the new growth yesterday occurred on the north side, away from homes and property. 105 firefighters and four engines are working to contain the fire. Crews have constructed hand and dozer line along with sprinklers and a hose lay along Nelson Creek to keep the fire north of the forest boundary. Helicopters will be utilized again today to limit fire spread and growth. The Evacuation Order for 65 homes has been lowered to a warning and Nez Perce Road and Magruder Corridor Road are now open to the public. </font></font></font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T16:40:42-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Unknown</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Monday August 28th, 2017 approx.   02:45 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Shane Olpin</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">105</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">270 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">30%</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Heavy timber especially in Nelson Creek area.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>The Evacuation Order has been reduced to a Warning for 65 homes in the Nez Perce Road area from West Fork Road including Lapwai, Fox Lanes and Bear Hollow Court.  Residents can now return home but should remain prepared to evacuate due to critical fire behavior.  For updates install the free Ravalli County Sheriff's app for mobile devices to receive evacuation info and updates sent right to your phone.          </p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Ensure firefighter and public safety are the first and highest priority.  Keep the fire southwest of Nelson Creek and north of the forest boundary.  Hold and improve hand line and dozer line around the fire along the west flank. Continue structure assessments along Nez Perce Corridor.  Utilize air resources and helicopters as needed (water drops) to limit fire spread.  Continue to set-up hose lay along Nelson Creek.    </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>Since 8/28, 3 Type one helicopters, 3 Type two helicopters and 1 Type 3 helicopter have been dropping water (bucket drops) to support firefighters working on the ground.  All total, these ships have dropped  428,959 gallons of water on the Nelson Creek fire to keep it from growing larger and from reaching homes and property!        </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>There is a fire weather watch in effect from Sunday afternoon through Sunday evening.  A ridge of high pressure will continue to build over the Northern Rockies the next few days causing extremely warm and dry conditions.  Each afternoon westerly winds will be mixing down into the valleys while the ridges should remain steady throughout the night.  An even drier airmass will push into the region on Sunday causing very low humidities combined with winds creating critical fire conditions and increasing fire behavior.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Firefighters are working to suppress a wildland fire burning on the West Fork Ranger District near Nelson Creek Trailhead. The fire is 270 acres in size and 30% contained. It was discovered on Monday, August 28 by the Bare Cone Lookout. The cause is unknown. Most of the new growth yesterday occurred on the north side, away from homes and property. 105 firefighters and four engines are working to contain the fire. Crews have constructed hand and dozer line along with sprinklers and a hose lay along Nelson Creek to keep the fire north of the forest boundary. Helicopters will be utilized again today to limit fire spread and growth. The Evacuation Order for 65 homes has been lowered to a warning and Nez Perce Road and Magruder Corridor Road are now open to the public.", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5549/", "type": "text/html", "rel": "alternate"}], "title": "Nelson Creek (Wildfire)", "geo_lat": "45.815555555556", "summary": "Firefighters are working to suppress a wildland fire burning on the West Fork Ranger District near Nelson Creek Trailhead. The fire is 270 acres in size and 30% contained. It was discovered on Monday, August 28 by the Bare Cone Lookout. The cause is unknown. Most of the new growth yesterday occurred on the north side, away from homes and property. 105 firefighters and four engines are working to contain the fire. Crews have constructed hand and dozer line along with sprinklers and a hose lay along Nelson Creek to keep the fire north of the forest boundary. Helicopters will be utilized again today to limit fire spread and growth. The Evacuation Order for 65 homes has been lowered to a warning and Nez Perce Road and Magruder Corridor Road are now open to the public.", "county": "Ravalli County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Nelson Creek (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5549/", "published": "Sat, 02 Sep 2017 16:40:42 -05:00", "geo_long": "-114.31972222222", "where": {"type": "Point", "coordinates": [-114.31972222222, 45.815555555556]}, "id": "https://inciweb.nwcg.gov/incident/5549/"}, "5552": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 3 DAYS AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Mount Haggin Fire\";\r\n\tvar defLat =  46.085555555556;\r\n\tvar defLng =  -113.07694444444;\r\n\tvar defLon =  -113.07694444444;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  46.085555555556;\r\n\tvar detailLng =  -113.07694444444;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  46.086 latitude, -113.077 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><p>The Mount Haggin Fire west of Hearst Lake has had no significant changes today. Both DNRC and Forest Service firefighters remain on the fire with help from a state type 2 helicopter performing bucket drops. The fire's size is still being called in at 10+ acres and has 10% containment line around it. As firefighters work on this fire the public should still anticipate small smoke plumes coming from the fire. Firefighters have experienced single tree torching but not much spread.</p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-08-30T16:32:35-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Under Investigation</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Monday August 28th, 2017 approx.   01:30 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">West of Hearst Lake near Anaconda</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">DNRC-Anaconda Unit</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Wildfire Started In Steep Rocky Terrain. </td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">24</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">10 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">10%</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Steep rocky terrain</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Some single tree torching and small smoke plumes. </p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Projected Incident Activity</th><td class=\"cell3\"><p>Full Suppression</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Mount Haggin Fire west of Hearst Lake has had no significant changes today. Both DNRC and Forest Service firefighters remain on the fire with help from a state type 2 helicopter performing bucket drops. The fire's size is still being called in at 10+ acres and has 10% containment line around it. As firefighters work on this fire the public should still anticipate small smoke plumes coming from the fire. Firefighters have experienced single tree torching but not much", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5552/", "type": "text/html", "rel": "alternate"}], "title": "Mount Haggin Fire (Wildfire)", "geo_lat": "46.085555555556", "summary": "The Mount Haggin Fire west of Hearst Lake has had no significant changes today. Both DNRC and Forest Service firefighters remain on the fire with help from a state type 2 helicopter performing bucket drops. The fire's size is still being called in at 10+ acres and has 10% containment line around it. As firefighters work on this fire the public should still anticipate small smoke plumes coming from the fire. Firefighters have experienced single tree torching but not much", "county": "Deer Lodge County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Mount Haggin Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5552/", "published": "Wed, 30 Aug 2017 16:32:35 -05:00", "geo_long": "-113.07694444444", "where": {"type": "Point", "coordinates": [-113.07694444444, 46.085555555556]}, "id": "https://inciweb.nwcg.gov/incident/5552/"}, "5582": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 6 MIN. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"East Fork Fire\";\r\n\tvar defLat =  48.17;\r\n\tvar defLng =  -109.62222222222;\r\n\tvar defLon =  -109.62222222222;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  48.17;\r\n\tvar detailLng =  -109.62222222222;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  48.17 latitude, -109.622 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Video Fire Update. September 2\" src=\"https://inciweb.nwcg.gov/photos/MTMTS/2017-09-02-1422-East-Fork-Fire/highlight/2017_09_02-17.16.24.014-CDh264.mp4\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTMTS/2017-09-02-1422-East-Fork-Fire/picts/2017_09_02-17.16.24.014-CDh264.mp4\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTMTS/2017-09-02-1422-East-Fork-Fire/picts/2017_09_02-17.16.24.014-CDh264.mp4\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font face=\"\" size=\"4\">Click this link for a <a href=\"https://inciweb.nwcg.gov/incident/photograph/5582/3/72219/\" target=\"_self\">Video Update, September 2</a><br/><br/>This information will be updated as more information is available. Please stay tuned.<br/><br/>County, State and Federal firefighters and Volunteer firefighters from Blaine and Hill Counties have done an outstanding job of coming together to conduct an aggressive and effective initial attack on this fire. The fire is at 21,000 acres at this time. An incident command post is set up at Beaver Creek Park. A fire information phone line is being established, and that phone number will be shared when it is available.<br/><br/>The East Fork Fire is burning on the Chippewa Cree Reservation, and in Blaine County and Hill County in north central Montana, south of Havre. At this time, the majority of the fire is in check, and not expected to spread. Other parts of the fire still have intense heat and work is underway to secure these areas of the fire. At this time, there are no operational needs for conducting additional burn outs on the perimeter, nor the interior of the fire.<br/><br/>Weather today proved to be beneficial to firefighting efforts with slightly cooler temperatures and slightly higher relative humidity levels. Winds did not gust today as they have been over the previous several days. <br/><br/>For Sunday, September 3, the forecasted weather is returning to conditions that may promote fire activity and fire spread. A Red Flag Warning is in effect for Sunday for dry fuels and high winds. Winds will shift to come from the northeast and gust to 22 mph in the afternoon, then increase to as much as 31 mph in the evening.<br/><br/>A Type 1 Interagency Incident Management team made up of county, state and federal firefighters are on scene to help support the local organizations and bring much needed resources to the firefighting efforts.<br/><br/>Beaver Creek Road is open from 5th Avenue through to Taylor Road, and to Rocky Boys Agency.<br/><br/>Beaver Creek Park is closed to recreation, and Hill County Sheriff's Department is asking the public to stay out of the area for firefighter safety - the side roads within the park are still closed to the public.<br/><br/>Sucker Creek Road is closed between Beaver Creek and Clear Creek.</font><br/> <br/> </p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T18:58:38-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Sunday August 27th, 2017 approx.   03:30 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">South of Harve, Montana</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Eli Grooms</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Size</th><td class=\"cell3\">21,000 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Tall grass and timber</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Projected Incident Activity</th><td class=\"cell3\"><p>A fire Weather Watch is in effect.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Click this link for a Video Update, September 2This information will be updated as more information is available. Please stay tuned.County, State and Federal firefighters and Volunteer firefighters from Blaine and Hill Counties have done an outstanding job of coming together to conduct an aggressive and effective initial attack on this fire. The fire is at 21,000 acres at this time. An incident command post is set up at Beaver Creek Park. A fire information phone line is being established, and that phone number will be shared when it is available.The East Fork Fire is burning on the Chippewa Cree Reservation, and in Blaine County and Hill County in north central Montana, south of Havre. At this time, the majority of the fire is in check, and not expected to spread. Other parts of the fire still have intense heat and work is underway to secure these areas of the fire. At this time, there are no operational needs for conducting additional burn outs on the perimeter, nor the interior of...", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5582/", "type": "text/html", "rel": "alternate"}], "title": "East Fork Fire (Wildfire)", "geo_lat": "48.17", "summary": "Click this link for a Video Update, September 2This information will be updated as more information is available. Please stay tuned.County, State and Federal firefighters and Volunteer firefighters from Blaine and Hill Counties have done an outstanding job of coming together to conduct an aggressive and effective initial attack on this fire. The fire is at 21,000 acres at this time. An incident command post is set up at Beaver Creek Park. A fire information phone line is being established, and that phone number will be shared when it is available.The East Fork Fire is burning on the Chippewa Cree Reservation, and in Blaine County and Hill County in north central Montana, south of Havre. At this time, the majority of the fire is in check, and not expected to spread. Other parts of the fire still have intense heat and work is underway to secure these areas of the fire. At this time, there are no operational needs for conducting additional burn outs on the perimeter, nor the interior of...", "county": "Hill County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "East Fork Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5582/", "published": "Sat, 02 Sep 2017 22:51:29 -05:00", "geo_long": "-109.62222222222", "where": {"type": "Point", "coordinates": [-109.62222222222, 48.17]}, "id": "https://inciweb.nwcg.gov/incident/5582/"}, "5539": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">ANNOUNCEMENT</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Additional Evacuation Orders</strong><br/>Lincoln Co. Sheriff has issued an additional Evacuation Order for the West Kootenai North and South Zones. At this time these Evacuation Orders affect the communities of Dodge Creek, Spring Creek,... <a class=\"more\" href=\"/incident/article/5539/39800/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 2 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Caribou Fire\";\r\n\tvar defLat =  48.973055555556;\r\n\tvar defLng =  -115.44111111111;\r\n\tvar defLon =  -115.44111111111;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  48.973055555556;\r\n\tvar detailLng =  -115.44111111111;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  48.973 latitude, -115.441 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"West Kootenai Community Caribou Fire 9-2\" src=\"https://inciweb.nwcg.gov/photos/MTKNF/2017-08-26-1426-Caribou-Fire/highlight/2017_09_02-19.47.02.420-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTKNF/2017-08-26-1426-Caribou-Fire/picts/2017_09_02-19.47.02.420-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTKNF/2017-08-26-1426-Caribou-Fire/picts/2017_09_02-19.47.02.420-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p>The Lincoln County Sheriff has issued a <b>pre-evacuation warning </b>for all zones in the West Kootenai area. There is a good probability of a need to evacuate. It is recommended to move any people requiring extraordinary care, large mobile property, and livestock (if feasible and deemed necessary). </p><p>Beginning Saturday morning (9/2/2017), Law Enforcement will be going door to door throughout the West Kootenai to insure all residents are aware of the Pre-Evacuation Warning.</p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T20:53:07-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Friday August 11th, 2017 approx.   10:45 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">18 miles NW of Eureka, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Shawn Pearson, Bob Habeck (t), Type 2 Incident Management Team</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Strategy: 50% Confine And 50% Full Suppression</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">137</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">6,781 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Monday October 30th, 2017 approx.   10:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber (litter and understory) Burning in subalpine fir, and dead and down spruce</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Extreme fire behavior, long range spotting, group tree torching. Third day of extreme fire behavior, with wind driven runs with long range spotting </p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Safely use all available crews, air and heavy equipment to protect values at risk around structures in Spring Creek, Dodge Creek, and West Kootenai population protection areas. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>Red Flag on Sunday for wind gusts as high as 30 mph and relative humidity in the lower teens.  </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Red flag alert for Sunday with gusts to 30 MPH and hot dry conditions.  Sunday night the winds will switch and come out of the north with gusts to 30 mph pushing the fire to the south. </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Lincoln County Sheriff has issued a pre-evacuation warning for all zones in the West Kootenai area. There is a good probability of a need to evacuate. It is recommended to move any people requiring extraordinary care, large mobile property, and livestock (if feasible and deemed necessary). Beginning Saturday morning (9/2/2017), Law Enforcement will be going door to door throughout the West Kootenai to insure all residents are aware of the Pre-Evacuation", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5539/", "type": "text/html", "rel": "alternate"}], "title": "Caribou Fire (Wildfire)", "geo_lat": "48.973055555556", "summary": "The Lincoln County Sheriff has issued a pre-evacuation warning for all zones in the West Kootenai area. There is a good probability of a need to evacuate. It is recommended to move any people requiring extraordinary care, large mobile property, and livestock (if feasible and deemed necessary). Beginning Saturday morning (9/2/2017), Law Enforcement will be going door to door throughout the West Kootenai to insure all residents are aware of the Pre-Evacuation", "county": "Lincoln County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Caribou Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5539/", "published": "Sat, 02 Sep 2017 20:53:07 -05:00", "geo_long": "-115.44111111111", "where": {"type": "Point", "coordinates": [-115.44111111111, 48.973055555556]}, "id": "https://inciweb.nwcg.gov/incident/5539/"}, "5538": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 12 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Ditch Creek Fire\";\r\n\tvar defLat =  46.919166666667;\r\n\tvar defLng =  -111.20055555556;\r\n\tvar defLon =  -111.20055555556;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  46.919166666667;\r\n\tvar detailLng =  -111.20055555556;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  46.919 latitude, -111.201 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Firefighter hiking up the handline on the edge of the fire\" src=\"https://inciweb.nwcg.gov/photos/MTHLF/2017-08-25-1915-Ditch-Creek-Cire/highlight/2017_08_30-09.30.09.829-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTHLF/2017-08-25-1915-Ditch-Creek-Cire/picts/2017_08_30-09.30.09.829-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTHLF/2017-08-25-1915-Ditch-Creek-Cire/picts/2017_08_30-09.30.09.829-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p>The Ditch Creek Fire was reported on Thursday, August 24th. Meagher County and Forest Service responded and have been working in unified command since that time. The fire is burning in Douglas fir, sagebrush, and grass.</p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T11:21:40-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">East of Tenderfoot drainage in the Little Belt Mountains</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Meagher County, White Sulphur Springs Ranger District</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">46</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">127 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">86%</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber, sagebrush, grass</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Fire crews have done a great job securing the perimeter of the fire and will continue mopping up and gridding for hot spots. </p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Remarks</th><td class=\"cell3\"><p>A fire crew has been reassigned from this fire to the East Fork Fire; other resources will continue to be demobilized when appropriate.</p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Fire weather watch is in effect for continued hot, dry conditions with winds 5-10 mph.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Ditch Creek Fire was reported on Thursday, August 24th. Meagher County and Forest Service responded and have been working in unified command since that time. The fire is burning in Douglas fir, sagebrush, and", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5538/", "type": "text/html", "rel": "alternate"}], "title": "Ditch Creek Fire (Wildfire)", "geo_lat": "46.919166666667", "summary": "The Ditch Creek Fire was reported on Thursday, August 24th. Meagher County and Forest Service responded and have been working in unified command since that time. The fire is burning in Douglas fir, sagebrush, and", "county": "Meagher County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Ditch Creek Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5538/", "published": "Sat, 02 Sep 2017 11:21:40 -05:00", "geo_long": "-111.20055555556", "where": {"type": "Point", "coordinates": [-111.20055555556, 46.919166666667]}, "id": "https://inciweb.nwcg.gov/incident/5538/"}, "5558": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">ANNOUNCEMENT</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Evacuation Notice and Public Meeting Notice</strong><br/> Evacuation Notice: The Fire Management Team, in conjunction with the Sanders County Sheriff\u2019s office, has decided to implement evacuation procedures on the Sheep Gap fire. The evacuation will... <a class=\"more\" href=\"/incident/article/5558/39779/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 6 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Sheep Gap\";\r\n\tvar defLat =  47.495;\r\n\tvar defLng =  -115.06;\r\n\tvar defLon =  -115.06;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  47.495;\r\n\tvar detailLng =  -115.06;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.495 latitude, -115.06 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Sheep Gap Fire view from plane 8-30, 9:30 am\" src=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-08-30-1109-Sheep-Gap/highlight/2017_08_30-21.01.32.356-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-08-30-1109-Sheep-Gap/picts/2017_08_30-21.01.32.356-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-08-30-1109-Sheep-Gap/picts/2017_08_30-21.01.32.356-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p>The Sheep Gap Fire started by lightning and was detected on Aug. 29th around 5:00 pm on the Plains/Thompson Falls Ranger District. The fire started in steep terrain with heavy timber. The fire is located 9 miles west north west of Plains, 3 miles south west of Weeksville, just south of Highway 200. The Forest managed the fire with a Type 3 organization through September 2. The Sheep Gap fire along with other fires along the Highway 200 corridor will be managed by a Type 2 organization. <br/> <br/>There are evacuation warnings and road and area closures associated with the Sheep Gap fire. Please see the \"maps\" and \"closures\" tabs.<br/></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T12:20:22-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Tuesday August 29th, 2017 approx.   04:15 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">The fire is located south of Clark Fork River, East of Thompson Falls, MT</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">51</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">2,242 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Sunday October 15th, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Moderate, Running, Group Torching</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Continue checking for and securing spots on the northern edge of the fire. Continue working on contingency line along the private land in the bottom.</p>\n<p></p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>Expect the fire to continue moving to the southeast with the wind over the next operational period with spotting anticipated.  </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p> Warm and dry conditions remain over the fire area. Increased temperatures are</p>\n<p>expected through the weekend with no precipitation forecasted. Low relative</p>\n<p>humidity's and potential for gusty winds remain a concern.</p>\n<p> </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Sheep Gap Fire started by lightning and was detected on Aug. 29th around 5:00 pm on the Plains/Thompson Falls Ranger District. The fire started in steep terrain with heavy timber. The fire is located 9 miles west north west of Plains, 3 miles south west of Weeksville, just south of Highway 200. The Forest managed the fire with a Type 3 organization through September 2. The Sheep Gap fire along with other fires along the Highway 200 corridor will be managed by a Type 2 organization.  There are evacuation warnings and road and area closures associated with the Sheep Gap fire. Please see the \"maps\" and \"closures\"", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5558/", "type": "text/html", "rel": "alternate"}], "title": "Sheep Gap (Wildfire)", "geo_lat": "47.495", "summary": "The Sheep Gap Fire started by lightning and was detected on Aug. 29th around 5:00 pm on the Plains/Thompson Falls Ranger District. The fire started in steep terrain with heavy timber. The fire is located 9 miles west north west of Plains, 3 miles south west of Weeksville, just south of Highway 200. The Forest managed the fire with a Type 3 organization through September 2. The Sheep Gap fire along with other fires along the Highway 200 corridor will be managed by a Type 2 organization.  There are evacuation warnings and road and area closures associated with the Sheep Gap fire. Please see the \"maps\" and \"closures\"", "county": "Sanders County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Sheep Gap (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5558/", "published": "Sat, 02 Sep 2017 17:01:24 -05:00", "geo_long": "-115.06", "where": {"type": "Point", "coordinates": [-115.06, 47.495]}, "id": "https://inciweb.nwcg.gov/incident/5558/"}, "5378": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">NEWS RELEASE</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Smoke Outlook for September 2, 2017</strong><br/>Smoke: Somewhat better air quality will continue across the area today with daytime west winds, becoming calmer overnight, allowing smoke to settle back down into valleys by early morning. Increased.. <a class=\"more\" href=\"/incident/article/5378/39727/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 2 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Burdette Fire\";\r\n\tvar defLat =  46.865833333333;\r\n\tvar defLng =  -114.62388888889;\r\n\tvar defLon =  -114.62388888889;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  46.865833333333;\r\n\tvar detailLng =  -114.62388888889;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  46.866 latitude, -114.624 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Map showing extent of Sunrise Burdette Fires as of  August 31, 2017\" src=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-18-1353-Burdette-Fire/highlight/2017_08_31-09.36.37.321-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-18-1353-Burdette-Fire/picts/2017_08_31-09.36.37.321-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-18-1353-Burdette-Fire/picts/2017_08_31-09.36.37.321-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p>The Southwest Montana All Hazard Type 3 Incident Management Team will be managing the Burdette and Sunrise Fires under the direction of the Western Montana Type 2 Incident Management Team lead by Rick Connell. <br/><br/>The Burdette Fire is a lightning-caused fire that started on July 16th, 2017. It is currently 649 acres with 90% containment and has experienced minimal growth over the last week. It is burning in steep, heavily-timbered terrain with numerous hazard trees and very limited access. The fire is not currently staffed as the terrain would be dangerous for firefighters on the ground and it poses little threat to surrounding communities. Aerial resources, however, are monitoring the fire daily and will implement additional suppression actions if needed. </p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T20:48:12-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Sunday July 16th, 2017 approx.   04:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">23 miles southwest of Superior, Montana</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Rick Connell, Western Montana Type 2 Team</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Size</th><td class=\"cell3\">649 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">90%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Monday October 30th, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Closed Timber Litter</p>\n<p>A few smokes remain on the northeast corner of the fire only. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Minimal</p>\n<p>Smoldering</p>\n<p>Creeping</p>\n<p>Northeast portion of the fire contains a little heat, only a few smokes visible. Fire is smoldering and in heavy downed fuels. Fire movement is more dependent upon available fuels. Fuel loading varies across the landscape. Primarily a surface fire burning in downed fuels. </p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>The northeast corner remains uncontrolled and is being monitored by air attack. No ground resources</p>\n<p>are on the fire.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>The potential for fire movement is slight; fire will continue to be monitored by air attack. The Western Montana Type II Incident Management Team is managing both the Sunrise and Burdette Fires. All new suppression costs are added to the Sunrise fire. </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Southwest Montana All Hazard Type 3 Incident Management Team will be managing the Burdette and Sunrise Fires under the direction of the Western Montana Type 2 Incident Management Team lead by Rick Connell. The Burdette Fire is a lightning-caused fire that started on July 16th, 2017. It is currently 649 acres with 90% containment and has experienced minimal growth over the last week. It is burning in steep, heavily-timbered terrain with numerous hazard trees and very limited access. The fire is not currently staffed as the terrain would be dangerous for firefighters on the ground and it poses little threat to surrounding communities. Aerial resources, however, are monitoring the fire daily and will implement additional suppression actions if needed.", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5378/", "type": "text/html", "rel": "alternate"}], "title": "Burdette Fire (Wildfire)", "geo_lat": "46.865833333333", "summary": "The Southwest Montana All Hazard Type 3 Incident Management Team will be managing the Burdette and Sunrise Fires under the direction of the Western Montana Type 2 Incident Management Team lead by Rick Connell. The Burdette Fire is a lightning-caused fire that started on July 16th, 2017. It is currently 649 acres with 90% containment and has experienced minimal growth over the last week. It is burning in steep, heavily-timbered terrain with numerous hazard trees and very limited access. The fire is not currently staffed as the terrain would be dangerous for firefighters on the ground and it poses little threat to surrounding communities. Aerial resources, however, are monitoring the fire daily and will implement additional suppression actions if needed.", "county": "Mineral County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Burdette Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5378/", "published": "Sat, 02 Sep 2017 20:48:12 -05:00", "geo_long": "-114.62388888889", "where": {"type": "Point", "coordinates": [-114.62388888889, 46.865833333333]}, "id": "https://inciweb.nwcg.gov/incident/5378/"}, "5363": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">ANNOUNCEMENT</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Moose Lake area residents are under RED Evacutaion Order</strong><br/>Effective immediately - Moose Lake area residents are ORDERED to leave the area. Incident conditions present an immediate threat to persons within this area. You are given notice that your area is... <a class=\"more\" href=\"/incident/article/5363/37234/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 8/3/2017</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Whetstone Ridge Fire\";\r\n\tvar defLat =  46.048888888889;\r\n\tvar defLng =  -113.64666666667;\r\n\tvar defLon =  -113.64666666667;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  46.048888888889;\r\n\tvar detailLng =  -113.64666666667;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  46.049 latitude, -113.647 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Plume of smoke as seen from the Ross Fork Rd. at ICP\" src=\"https://inciweb.nwcg.gov/photos/MTBDF/2017-07-14-1842-Whetestone-Ridge/highlight/2017_08_02-09.25.44.979-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTBDF/2017-07-14-1842-Whetestone-Ridge/picts/2017_08_02-09.25.44.979-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTBDF/2017-07-14-1842-Whetestone-Ridge/picts/2017_08_02-09.25.44.979-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p>The Whetstone Ridge and Meyers fires grew together on Tuesday, August 1, 2017, and as of today are designated as the Meyers Fire. The critical fire of Tuesday did not return yesterday. As a result, structure protection efforts in the Moose Lake area made significant progress and will continue today with continued favorable weathers. Weather today is expected to be cooler like yesterday with north northwest winds. NO STRUCTURES WERE LOST.<br/> <br/> Crews also continued to reinforce the lines and seek opportunities to utilize timber management equipment to improve the value of road #5106 as a containment line. Crews continued to monitor for spotting outside the fire perimeter threatening values at risk and implemented structure protection and initial attach actions as needed.<br/> <br/> A new start, Old Dominion fire, was detected on July 31, 2017, and is also a result of lightning experienced in mid-July. The fire is located east of Moose Lake and estimated to be 6 acres. It is currently staffed and 75% contained.<br/> <br/> Today structure protection efforts will continue in the Moose Lake area. Easterly winds, green valley bottom fuels, and fuel treatments on the north slopes will aid structure protection efforts there. Crews and equipment will work to complete and improve fie line to the east, near road #5106.<br/> <br/> The current Fire Danger is VERY HIGH. Recreationists are reminded to use caution with any outdoor activity that may cause a spark. Never leave campfires unattended. Pour water and add dirt to your campfire until your campfire is cold. Remember: If it's too hot to touch, it's too hot to leave.<br/> <br/> <b style=\"mso-bidi-font-weight: normal;\">Smoke Forecast: </b>The smoke forecast for Philipsburg and the surrounding area residents should expect patchy smoke in the morning and a mostly sunny afternoon.<br/> <br/> <b style=\"mso-bidi-font-weight: normal;\">Evacuations: </b>The Granite County Sheriff issued EVACUTION notices for the FROG POND BASIN, COPPER CREEK CAMPGROUND, AND MOOSE LAKE areas.<br/> <br/> <b style=\"mso-bidi-font-weight: normal;\">Fire Restrictions: </b>Granite County has implemented Stage II Fire restrictions for private lands within Granite County. </p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font><p><b style=\"mso-bidi-font-weight: normal;\">Closures: </b>An emergency Closure Order, dated July 22, 2017, is in place for Copper Creek road #80 closed at the junction with Moose Lake road #5106. The Copper Creek Campground is closed.<br/><br/><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p><b style=\"mso-bidi-font-weight: normal;\">Temporary Flight Restrictions (TFR): </b>A TFR encompasses the area over both fires.<b style=\"mso-bidi-font-weight: normal;\"> </b>For<b style=\"mso-bidi-font-weight: normal;\"> </b>more information<b style=\"mso-bidi-font-weight: normal;\"> </b><a href=\"http://tfr.faa.gov/\"><font color=\"#0000ff\">http://</font>tfr<font color=\"#0000ff\">.faa.gov/</font></a></p><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p><u>This will be the last update for the Whetstone Ridge fire. For current information: </u><a href=\"http://inciweb.nwcg.gov/incident/5397\"><font color=\"#0000ff\">http://inciweb.nwcg.gov/incident/5397</font></a><u> </u></p><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font><br/><br/><br/> <br/><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 0in 0in 0pt -0.5in;\"><font face=\"Times New Roman\"><b style=\"mso-bidi-font-weight: normal;\"><font color=\"#000000\">Temp</font></b></font></p><p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font><p><br/> </p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-08-03T09:58:47-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Thursday July 13th, 2017 approx.   08:30 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">25 air miles SW of Philipsburg, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Mike Almas, ICT2</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Wildfire</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Size</th><td class=\"cell3\">11,593 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Saturday October 21st, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber (Litter and Understory) Most significant fuel is mixed conifer dominated by lodgepole pine with a heavy dead component from beetle kill. ERC's in the 70's, suggesting that both fine fuels and heavy dead fuels are very dry.</p>\n<p></p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Fire behavior: active, torching, spotting, creeping. Fire remains active along yesterday's new perimeter gains. Cooler, more stable conditions reducing potential for crown fire.</p>\n<p></p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Implement structure protection measures.  Scout fuel breaks and utilize heavy equipment to implement control lines. Implement a direct suppression strategy where it is the most viable option, taking advantage of favorable conditions. Tomorrow's focus will continue to widen fuel breaks from DIV R, south through DIV E (north and east side of fire).</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>12 hours: Mostly clear. Patchy smoke in the valleys. Low temperatures in the lower 40s in the valleys and low 60s on the mid-slopes. Winds will be down valley and down drainage at around 4 to 7 mph with wind on the ridges from the east at 5 to 10 gusting to 15 mph. Max relative humidity values from 60% to 70% in the valleys and 35% to 45% on ridges.</p>\n<p>24 hours: Areas of smoke in the morning. Sunny in the afternoon. High temperatures around 82 to 87 in the valleys and 75 to 80 on the ridges. Winds will be upslope and up-valley 5 to 9 mph with the valleys and 75 to 80 on the ridges. Winds will be upslope and up-valley 5 to 9 mph with gust up to 15 mph in the valleys with north to northwest flow returning to the ridges at 8 to 12 gusting to 18 mph. Min relative humidity values from 14% to 19% in the valleys and 30% to 35% on ridges.</p>\n<p></p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>. (7)For today and going forward, the Meyers acreage will include 3621 acres formerly attributed to the Whetstone Ridge fire.</p>\n<p>(8)The team is constructing indirect contingency fire breaks. The focus of this effort is protecting private development, primarily on the east side of the fire. Currently the total length of fire break completed is as follows: 2 miles of hand line, 9 miles of dozer line and 17 miles of shaded fuel break. This constitutes 82% of the planned primary and contingency fire break. In addition direct line construction has started where the fire has slopped over containment lines. The structure group has triaged and/or prepared 82 structures nearest to the fire. These numbers are for both the Meyers and Whetstone Ridge fires.</p>\n<p>(45) Cost for the Whetstone Ridge fire is currently captured under the Meyers fire.</p>\n<p></p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>24-36 Hour Summary:  With a cold front passing southeast along the Divide overnight cooler and less drier conditions have settled across the incident. Easterly winds have set up slightly weaker with some 5 to 10 knot winds and a few gusts to 15. The ridge building again to the west will reorganize the northwest flow again and drier conditions will return for Thursday.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Whetstone Ridge and Meyers fires grew together on Tuesday, August 1, 2017, and as of today are designated as the Meyers Fire. The critical fire of Tuesday did not return yesterday. As a result, structure protection efforts in the Moose Lake area made significant progress and will continue today with continued favorable weathers. Weather today is expected to be cooler like yesterday with north northwest winds. NO STRUCTURES WERE LOST.  Crews also continued to reinforce the lines and seek opportunities to utilize timber management equipment to improve the value of road #5106 as a containment line. Crews continued to monitor for spotting outside the fire perimeter threatening values at risk and implemented structure protection and initial attach actions as needed.  A new start, Old Dominion fire, was detected on July 31, 2017, and is also a result of lightning experienced in mid-July. The fire is located east of Moose Lake and estimated to be 6 acres. It is currently staffed and 75%...", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5363/", "type": "text/html", "rel": "alternate"}], "title": "Whetstone Ridge Fire (Wildfire)", "geo_lat": "46.048888888889", "summary": "The Whetstone Ridge and Meyers fires grew together on Tuesday, August 1, 2017, and as of today are designated as the Meyers Fire. The critical fire of Tuesday did not return yesterday. As a result, structure protection efforts in the Moose Lake area made significant progress and will continue today with continued favorable weathers. Weather today is expected to be cooler like yesterday with north northwest winds. NO STRUCTURES WERE LOST.  Crews also continued to reinforce the lines and seek opportunities to utilize timber management equipment to improve the value of road #5106 as a containment line. Crews continued to monitor for spotting outside the fire perimeter threatening values at risk and implemented structure protection and initial attach actions as needed.  A new start, Old Dominion fire, was detected on July 31, 2017, and is also a result of lightning experienced in mid-July. The fire is located east of Moose Lake and estimated to be 6 acres. It is currently staffed and 75%...", "county": "Granite County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Whetstone Ridge Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5363/", "published": "Thu, 03 Aug 2017 13:53:07 -05:00", "geo_long": "-113.64666666667", "where": {"type": "Point", "coordinates": [-113.64666666667, 46.048888888889]}, "id": "https://inciweb.nwcg.gov/incident/5363/"}, "5417": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 8/24/2017</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Little Hogback Fire\";\r\n\tvar defLat =  46.446666666667;\r\n\tvar defLng =  -113.68861111111;\r\n\tvar defLon =  -113.68861111111;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  46.446666666667;\r\n\tvar detailLng =  -113.68861111111;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  46.447 latitude, -113.689 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><p><font size=\"5\">As of July 24th, the Sliderock, Goat Creek, and Little Hogback Fires are known as the Sapphire Complex. All information on the Goat Creek Fire is available on the Sapphire Complex page at https://inciweb.nwcg.gov/incident/5364/</font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-08-24T10:02:31-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Thursday July 13th, 2017 approx.   05:51 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">27 miles southeast of Missoula</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Northern Rockies Pearson IMT 2</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Lightning Ignited Fire Burning In Remote Terrain</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Size</th><td class=\"cell3\">29,654 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">25%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Tuesday October 31st, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber, litter, grass, and understory. </p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p> </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p> </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p> </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "As of July 24th, the Sliderock, Goat Creek, and Little Hogback Fires are known as the Sapphire Complex. All information on the Goat Creek Fire is available on the Sapphire Complex page at", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5417/", "type": "text/html", "rel": "alternate"}], "title": "Little Hogback Fire (Wildfire)", "geo_lat": "46.446666666667", "summary": "As of July 24th, the Sliderock, Goat Creek, and Little Hogback Fires are known as the Sapphire Complex. All information on the Goat Creek Fire is available on the Sapphire Complex page at", "county": "Granite County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Little Hogback Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5417/", "published": "Thu, 24 Aug 2017 10:02:31 -05:00", "geo_long": "-113.68861111111", "where": {"type": "Point", "coordinates": [-113.68861111111, 46.446666666667]}, "id": "https://inciweb.nwcg.gov/incident/5417/"}, "5401": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">ANNOUNCEMENT</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Additional Trail Closures as of August 1st, 2017</strong><br/>Flathead NF trail closures in the Danaher area due to the Monahan Fire, August 1st, 2017:Trail #143, in its entirety from the junction with Danaher Creek Trail #126 (NE \u00bc of Section 20, R 11W, T... <a class=\"more\" href=\"/incident/article/5401/37216/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 1:28 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Monahan Fire\";\r\n\tvar defLat =  47.273055555556;\r\n\tvar defLng =  -113.13833333333;\r\n\tvar defLon =  -113.13833333333;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  47.273055555556;\r\n\tvar detailLng =  -113.13833333333;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.273 latitude, -113.138 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Danaher Cabin Structure Protection\" src=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-21-1555-Monahan-Fire/highlight/2017_08_07-17.44.43.825-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-21-1555-Monahan-Fire/picts/2017_08_07-17.44.43.825-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-21-1555-Monahan-Fire/picts/2017_08_07-17.44.43.825-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p>The Monahan Fire was reported at approximately 5:30pm on Sunday July, 16th. The incident is located between Monahan Mountain on the Lolo National Forest and Little Apex Mountain on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role with consideration for public and firefighter safety and point protection of historic resources and trail infrastructure. The Flathead National Forest, based out of the Spotted Bear Ranger District office, assumed responsibility for the management of the fire on July 23rd at 8pm. <br/><br/><br/> Limited visibility. No update available. Early morning IR flight on 9-2 detected minimal growth. </p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T21:28:13-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning/ Natural</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Sunday July 16th, 2017 approx.   05:30 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">Powell County</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Greg Gulan</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">The Fire Management Strategy Is 75% Monitor And 25% Point Protection</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">4</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">2,324 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Sunday October 01st, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>The fire is burning in timber(grass and understory), short grass, subalpine fir, and in heavy dead and down woody fuel. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Limited visibility. No update available. Early morning IR flight on 9-2 detected minimal growth. </p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Reconnaissance by air to monitor fire activity will continue.  Structure protection equipment and supplies are in place for cabins and storage shed. Trapline and communication with outfitters and guides in the wilderness will continue.  </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>Aerial, lookout and ground reconnaissance. Continued structure protection.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>Trail Closures include: </p>\n<p>Flathead NF:</p>\n<p>Trail #143, in its entirety from the junction with Danaher Creek Trail #126 to Limestone Pass.</p>\n<p>Trail #277, in its entirety from the junction with Blackfoot Divide Trail #278 to the junction with Alloy Creek Trail #265.</p>\n<p>Trail #265, in its entirety from the junction with Hahn Creek Trail #125 to the junction with Danaher Creek Trail #126.</p>\n<p>Trail #142, in its entirety from the junction with Alloy Creek Trail #265 to the junction with Danaher Creek Trail #126.</p>\n<p>Trail #278, from Limestone Pass to the junction with the Calf Creek Trail #277.</p>\n<p> </p>\n<p>Trail #140, in its entirety from the junction with Danaher Creek Trail #126 to Observation Pt.</p>\n<p>Trail #144, in its entirety from the junction with Bar Creek Trail #140 to the junction with Danaher Creek Trail #126.</p>\n<p>Trail #126, from the Dry Fork Flathead Divide to the junction with Rapid Creek Trail #139.</p>\n<p>Lolo NF:</p>\n<p>Trail #402, from the intersection of Monture Creek #27 and #402 to Limestone Pass.</p>\n<p>Trail #31, from its junction with Dwight Creek Trail #414 north to its terminus.</p>\n<p>Trail #414, from its junction with Dry Fork Trail #31 to its junction with Conger Point Trail #468.</p>\n<p></p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Hot and dry conditions are forecast to continue. </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Monahan Fire was reported at approximately 5:30pm on Sunday July, 16th. The incident is located between Monahan Mountain on the Lolo National Forest and Little Apex Mountain on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role with consideration for public and firefighter safety and point protection of historic resources and trail infrastructure. The Flathead National Forest, based out of the Spotted Bear Ranger District office, assumed responsibility for the management of the fire on July 23rd at 8pm.  Limited visibility. No update available. Early morning IR flight on 9-2 detected minimal growth.", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5401/", "type": "text/html", "rel": "alternate"}], "title": "Monahan Fire (Wildfire)", "geo_lat": "47.273055555556", "summary": "The Monahan Fire was reported at approximately 5:30pm on Sunday July, 16th. The incident is located between Monahan Mountain on the Lolo National Forest and Little Apex Mountain on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role with consideration for public and firefighter safety and point protection of historic resources and trail infrastructure. The Flathead National Forest, based out of the Spotted Bear Ranger District office, assumed responsibility for the management of the fire on July 23rd at 8pm.  Limited visibility. No update available. Early morning IR flight on 9-2 detected minimal growth.", "county": "Powell County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Monahan Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5401/", "published": "Sat, 02 Sep 2017 21:29:52 -05:00", "geo_long": "-113.13833333333", "where": {"type": "Point", "coordinates": [-113.13833333333, 47.273055555556]}, "id": "https://inciweb.nwcg.gov/incident/5401/"}, "5400": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">ANNOUNCEMENT</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>The Goat Creek Fire is part of the Sapphire Complex</strong><br/>As of July 24th, the Sliderock, Goat Creek, and Little Hogback Fires are known as the Sapphire Complex. All information on the Goat Creek Fire is available on the Sapphire Complex page at... <a class=\"more\" href=\"/incident/article/5400/36890/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 8/24/2017</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Goat Creek Fire\";\r\n\tvar defLat =  46.649722222222;\r\n\tvar defLng =  -113.63527777778;\r\n\tvar defLon =  -113.63527777778;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  46.649722222222;\r\n\tvar detailLng =  -113.63527777778;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  46.65 latitude, -113.635 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Goat Creek &amp; Sliderock PM Fire Activity 7/23/17\" src=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-21-0749-Goat-Creek-Fire/highlight/2017_07_23-20.39.32.732-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-21-0749-Goat-Creek-Fire/picts/2017_07_23-20.39.32.732-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTLNF/2017-07-21-0749-Goat-Creek-Fire/picts/2017_07_23-20.39.32.732-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font size=\"5\">As of July 24th, the Sliderock, Goat Creek, and Little Hogback Fires are known as the Sapphire Complex. All information on the Goat Creek Fire is available on the Sapphire Complex page at https://inciweb.nwcg.gov/incident/5364/</font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-08-24T10:03:16-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Wednesday July 19th, 2017 approx.   04:37 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">Six miles south of Bonita Guard Station and one mile east of Rock Creek Road on the Missoula Ranger District.</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Northern Rockies Pearson IMT 2</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Lightning Ignited Fire Burning In Remote Terrain</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Size</th><td class=\"cell3\">8,323 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">95%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Tuesday October 31st, 2017 approx.   12:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber, litter, grass, and understory. </p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Projected Incident Activity</th><td class=\"cell3\"><p> </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p> </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "As of July 24th, the Sliderock, Goat Creek, and Little Hogback Fires are known as the Sapphire Complex. All information on the Goat Creek Fire is available on the Sapphire Complex page at", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5400/", "type": "text/html", "rel": "alternate"}], "title": "Goat Creek Fire (Wildfire)", "geo_lat": "46.649722222222", "summary": "As of July 24th, the Sliderock, Goat Creek, and Little Hogback Fires are known as the Sapphire Complex. All information on the Goat Creek Fire is available on the Sapphire Complex page at", "county": "Granite County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Goat Creek Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5400/", "published": "Thu, 24 Aug 2017 10:03:16 -05:00", "geo_long": "-113.63527777778", "where": {"type": "Point", "coordinates": [-113.63527777778, 46.649722222222]}, "id": "https://inciweb.nwcg.gov/incident/5400/"}, "5576": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 1 DAY AGO</div><h3>Incident Overview</h3><div><p>Contained 9/1/2017 @ 946</p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-01T11:55:30-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Contained 9/1/2017 @", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5576/", "type": "text/html", "rel": "alternate"}], "title": "Ridgetop (Wildfire)", "geo_lat": "", "summary": "Contained 9/1/2017 @", "county": null, "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Ridgetop (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5576/", "published": "Fri, 01 Sep 2017 11:55:30 -05:00", "geo_long": "-", "where": {}, "id": "https://inciweb.nwcg.gov/incident/5576/"}, "5575": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 1 DAY AGO</div><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-01T11:34:17-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr></table>\n</div>", "summary_detail": null, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5575/", "type": "text/html", "rel": "alternate"}], "title": "Grassy Mountain (Wildfire)", "geo_lat": "", "summary": null, "county": null, "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Grassy Mountain (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5575/", "published": "Fri, 01 Sep 2017 11:49:45 -05:00", "geo_long": "-", "where": {}, "id": "https://inciweb.nwcg.gov/incident/5575/"}, "5574": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">CLOSURE</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>8-29-17 Trail Closure due to Strawberry Fire, Order #D04-150-S-17</strong><br/> D04-150-S-17FLATHEAD NATIONAL FOREST 650 Wolfpack Way Kalispell, MT 59901 Forest Supervisor\u2019s Order   TRAIL RESTRICTION ORDER   East Fork Strawberry Creek Trail #371, is closed due to fire... <a class=\"more\" href=\"/incident/article/5574/39799/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 4 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Strawberry Fire\";\r\n\tvar defLat =  48.089166666667;\r\n\tvar defLng =  -113.015;\r\n\tvar defLon =  -113.015;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  48.089166666667;\r\n\tvar detailLng =  -113.015;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  48.089 latitude, -113.015 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Looking Southeast, August 28th, 2017\" src=\"https://inciweb.nwcg.gov/photos/MTFNF/2017-08-31-1811-Strawberry-Fire/highlight/2017_09_01-21.20.10.779-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTFNF/2017-08-31-1811-Strawberry-Fire/picts/2017_09_01-21.20.10.779-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTFNF/2017-08-31-1811-Strawberry-Fire/picts/2017_09_01-21.20.10.779-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p>The Strawberry Fire was reported on August 25th at approximately 12:00pm. The incident is located 2 miles north of Sabido Cabin, between Strawberry Creek and East Fork Strawberry Creek, in the Bob Marshall Wilderness, on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role, with consideration for public and firefighter safety as well as point protection of infrastructure. The fire is being managed by the Spotted Bear Ranger District.</p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-08-31T19:59:51-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning/ Natural</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Friday August 25th, 2017 approx.   12:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">8 Miles Southwest of Swift Reservoir on the Flathead National Forest in the Bob Marshall Wilderness.</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Mike Mansson</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">The Fire Management Strategy Is 60% Monitor, 30% Confine And 10% Point Protection.</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">3</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">747 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Wednesday November 01st, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Subalpine fir and grass</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Active torching.</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Monitor using air and ground resources. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>Helicopter bucket work to prevent fire spread across the continental divide if necessary.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>Fire is being managed to allow its natural ecological role in the Wilderness. </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Hot and dry weather is expected to continue. Gusty southwest winds. Cold front passage forecast.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Strawberry Fire was reported on August 25th at approximately 12:00pm. The incident is located 2 miles north of Sabido Cabin, between Strawberry Creek and East Fork Strawberry Creek, in the Bob Marshall Wilderness, on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role, with consideration for public and firefighter safety as well as point protection of infrastructure. The fire is being managed by the Spotted Bear Ranger", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5574/", "type": "text/html", "rel": "alternate"}], "title": "Strawberry Fire (Wildfire)", "geo_lat": "48.089166666667", "summary": "The Strawberry Fire was reported on August 25th at approximately 12:00pm. The incident is located 2 miles north of Sabido Cabin, between Strawberry Creek and East Fork Strawberry Creek, in the Bob Marshall Wilderness, on the Flathead National Forest. The fire is being managed for resource benefit including allowing the fire to play its natural ecological role, with consideration for public and firefighter safety as well as point protection of infrastructure. The fire is being managed by the Spotted Bear Ranger", "county": "Flathead County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Strawberry Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5574/", "published": "Sat, 02 Sep 2017 18:41:17 -05:00", "geo_long": "-113.015", "where": {"type": "Point", "coordinates": [-113.015, 48.089166666667]}, "id": "https://inciweb.nwcg.gov/incident/5574/"}, "5573": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">NEWS RELEASE</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Saturday, September 2 Evening Update</strong><br/>Saturday, September 2, 2017 Evening Update  Firefighters in conjunction with local ranchers put in another hard day of work and are making great progress in putting this fire to bed. In preparation... <a class=\"more\" href=\"/incident/article/5573/39805/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 4 MIN. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Sartin Draw Fire\";\r\n\tvar defLat =  45.738611111111;\r\n\tvar defLng =  -106.00888888889;\r\n\tvar defLon =  -106.00888888889;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  45.738611111111;\r\n\tvar detailLng =  -106.00888888889;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  45.739 latitude, -106.009 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Firing operations\" src=\"https://inciweb.nwcg.gov/photos/MTMTS/2017-08-31-1726-Sartin-Draw-Fire/highlight/2017_09_02-11.25.04.471-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTMTS/2017-08-31-1726-Sartin-Draw-Fire/picts/2017_09_02-11.25.04.471-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTMTS/2017-08-31-1726-Sartin-Draw-Fire/picts/2017_09_02-11.25.04.471-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p align=\"left\"><font face=\"Arial\" size=\"3\"><br/></font></p><p align=\"left\"><font face=\"Arial\" size=\"3\">The Sartin Draw fire was reported at around 5 a.m. on August 30, 2017. Local, State and Federal fire resources were dispatched to the fire. The fire started in Powder River County on US Forest Service land. The fire cause is natural.<br/><br/></font><font face=\"Arial\" size=\"3\"><a href=\"http://firerestrictions.us\"><b></b></a><b> </b><b></b></font> </p> <p align=\"left\"><font face=\"Arial\" size=\"3\"> Drought conditions along with hot and windy weather fueled the fire. The fire spread rapidly making it difficult for fire resources to slow it down. There have been fire resources on the fire since the initial report. The Montana Department of Natural Resources and Conservation\u2019s County Assist Team assumed management of the fire on August 31, 2017 at 4:30 pm. </font></p><p align=\"left\"><font face=\"Arial\" size=\"3\"><br/>Severe drought with hot and windy conditions has given zero relief for firefighters. In addition to the Sartin Draw Fire firefighters have been chasing and suppressing numerous fires in the area for the last seven days from a series of lightning storms that rolled through the area. This is on top of the extremely busy fire season this summer in Eastern Montana, due to severe drought conditions.</font><font face=\"Arial\" size=\"3\"><br/> <br/><br/>Stage I Fire Restrictions are in effect in Eastern Montana <br/></font></p><p align=\"left\"><font face=\"Arial\" size=\"3\"><b>CAMPFIRES </b>and other fires are <b>prohibited </b>except in approved recreation sites, as <b>designated on the fire prevention order</b>. Liquid petroleum and LPG stoves that can be turned on and off are allowed<b>.</b><b> </b></font><font face=\"Arial\" size=\"3\"><b>SMOKING </b>is <b>prohibited </b>outside of vehicles, buildings, and developed recreation sites, unless you are in a 3-foot-diameter area cleared of all burnable vegetation. For more information about fire restrictions, go to: <a href=\"http://firerestrictions.us\" target=\"_blank\">http://firerestrictions.us</a></font><br/> <br/> </p><p align=\"left\"><font face=\"Arial\" size=\"3\"> </font></p><p align=\"left\"><font face=\"Arial\" size=\"3\"><br/><a href=\"https://www.facebook.com/sartindrawfire/\" target=\"_blank\">CLICK HERE TO VIEW OUR SARTIN DRAW FIRE FACEBOOK PAGE</a> </font> </p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T20:10:07-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Natural</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Wednesday August 30th, 2017 approx.   05:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">20 miles NE of Ashland</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">David Hamilton, MT DNRC County Assist Team</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Full Suppression Management Strategy.</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">212</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">91,142 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">45%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Saturday September 09th, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Pine, heavy dead and down, sage brush, and grass.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Fire behavior was moderate with surface fire burning interior pockets of unburned fuel.</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Patrol western flank of the fire along the Tongue River Road and Beaver Creek Road. Improve line and mop-up containment lines on the southern flank of the fire in division Alpha. Hold and improve line and mop-up 1 chain (66 feet)in on the eastern flank of division Bravo. On the northern side in division Charlie and Tango, hold and improve line along Foster Creek Road and burn out pockets of unburned vegetation that are well in the interior of the containment lines.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>The fire has containment lines (dozer, black line and road systems) along the perimeter of the fire. Interior islands will continue to burn and portions of the fire with larger diameter fuels with continue to smolder.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>The Montana Department of Natural Resources and Conservation\u2019s County Assist Team assumed management of the fire on August 31, 2017 at 4:30 pm.</p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Red Flag Warning in effect from 9 AM Sunday to 9 PM Monday. Sunday will be hot and very dry. High temperatures will approach 100 degrees in spots and humidities will fall to around 10% in the afternoon. West to northwest winds will increase by late Sunday morning, with gusts of 25-35 mph expected.</p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "The Sartin Draw fire was reported at around 5 a.m. on August 30, 2017. Local, State and Federal fire resources were dispatched to the fire. The fire started in Powder River County on US Forest Service land. The fire cause is natural.    Drought conditions along with hot and windy weather fueled the fire. The fire spread rapidly making it difficult for fire resources to slow it down. There have been fire resources on the fire since the initial report. The Montana Department of Natural Resources and Conservation\u2019s County Assist Team assumed management of the fire on August 31, 2017 at 4:30 pm. Severe drought with hot and windy conditions has given zero relief for firefighters. In addition to the Sartin Draw Fire firefighters have been chasing and suppressing numerous fires in the area for the last seven days from a series of lightning storms that rolled through the area. This is on top of the extremely busy fire season this summer in Eastern Montana, due to severe drought conditions....", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5573/", "type": "text/html", "rel": "alternate"}], "title": "Sartin Draw Fire (Wildfire)", "geo_lat": "45.738611111111", "summary": "The Sartin Draw fire was reported at around 5 a.m. on August 30, 2017. Local, State and Federal fire resources were dispatched to the fire. The fire started in Powder River County on US Forest Service land. The fire cause is natural.    Drought conditions along with hot and windy weather fueled the fire. The fire spread rapidly making it difficult for fire resources to slow it down. There have been fire resources on the fire since the initial report. The Montana Department of Natural Resources and Conservation\u2019s County Assist Team assumed management of the fire on August 31, 2017 at 4:30 pm. Severe drought with hot and windy conditions has given zero relief for firefighters. In addition to the Sartin Draw Fire firefighters have been chasing and suppressing numerous fires in the area for the last seven days from a series of lightning storms that rolled through the area. This is on top of the extremely busy fire season this summer in Eastern Montana, due to severe drought conditions....", "county": "Powder River County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Sartin Draw Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5573/", "published": "Sat, 02 Sep 2017 22:53:47 -05:00", "geo_long": "-106.00888888889", "where": {"type": "Point", "coordinates": [-106.00888888889, 45.738611111111]}, "id": "https://inciweb.nwcg.gov/incident/5573/"}, "5583": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 5 MIN. AGO</div><h3>Incident Overview</h3><div><p><b id=\"docs-internal-guid-cca4cf5a-45d7-0858-d55a-6263bd3cb8b9\" style=\"font-weight: normal;\"><p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\">Location: Highway 200 corridor, near Thompson Falls, MT</p><p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\">Agency Jurisdiction: Lolo and Kootenai National Forests</p><p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\">Incident Command: Western Montana Type II Incident Management Team, Incident Commander - Rick Connell</p><p dir=\"ltr\" style=\"text-align: center; line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Overview</p><p dir=\"ltr\" style=\"line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Current Status: Late August 28th, the Plains and Thompson Falls, MT, areas experienced a lightning storm that ignited approximately 20 fires in the area. On August 29th, firefighters responded to and contained some of these fires. Seven of the fires, however, exceeded their initial attack efforts and have grown in size and severity. These fires include the Moose Peak, Miller Creek, Deep Creek, Reader, Reader 2, Cub Creek, and Sheep Gap Fires. To assist local resources, the Western Montana Type II Incident Management Team took command on Saturday evening and is managing these fires as a complex. Within this complex, the fires of greatest concern are the Sheep Gap and Reader Fires because they pose the most imminent threat to public safety.</p><p dir=\"ltr\" style=\"line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Outlook: Today will be a critical fire weather day. A Red Flag Warning is in place from 12:00-9:00 PM. High temperatures and low humidity are expected to be record breaking for this time of year. Additionally, the fire area may experience gusty and erratic winds making fire behavior more intense and less predictable. As always, firefighter and public safety remain the top priority. The current management objective is to protect values at risk, such as private property and infrastructure, while utilizing the limited resources most effectively. Available resources, including crews, heavy equipment, and aerial resources are being shared between the fires so they can be utilized where they are most needed and have the highest probability of success. </p><p dir=\"ltr\" style=\"line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Evacuations: The Sanders County Sheriff\u2019s Office is individually notifying residents within evacuation zones. As conditions change, the Sheriff\u2019s Office will be notifying affected residents by phone. So far, they have ordered several pre-evacuation warnings and implemented evacuations near the Sheep Gap Fire. East of Plains, mandatory evacuations are in place from the end of River Road West to Arnold Road, at the corner of Section 11. All residents in the Plains and Trout Creek areas should note that conditions are dynamic and will likely change quickly over the next few days. Please have an evacuation plan in place NOW for what you would do in the event of an emergency. Wildfires can grow very quickly and you may receive little to no notice before an evacuation takes place. </p><p dir=\"ltr\" style=\"line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Closures: Area closures are currently in place around the immediate fire areas and areas integral to safe fire operations. As hunting season continues, please respect area closures. The Forest Service is working to ensure that closures are kept to a minimum but are large enough for firefighter and public safety. Please see InciWeb and the Forest Service webpages for the latest closure area maps. </p><br/><p dir=\"ltr\" style=\"line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Percent Containment: 0%</p><p dir=\"ltr\" style=\"line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Size: 3347 acres</p><p dir=\"ltr\" style=\"line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Personnel: 211</p><br/><br/><p dir=\"ltr\" style=\"text-align: center; line-height: 1.2; margin-top: 0pt; margin-bottom: 0pt;\">Fire Details:</p><p dir=\"ltr\" style=\"text-align: center; line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Fires are listed in order of management priority, based on threat to values at risk.</p><p dir=\"ltr\" style=\"line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Sheep Gap - 2,224 acres: This fire is currently the top management priority due to its threat to private property and residences. Approximately 70 residences are threatened and have been notified of mandatory evacuations by the Sanders County Sheriff\u2019s Office. Firefighters are continuing to check for and secure spot fires on the northern edge of the fire. They are also working to put structure protection measures in place and establish contingency fire line where possible. Aerial resources will be assisting firefighters on the ground to slow fire spread and suppress any spot fires caused by wind-driven embers. </p><p dir=\"ltr\" style=\"line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Reader Fires \u2013 139 acres (total): The Reader and Reader 2 fires are being managed conjointly due to their close proximity. Firefighters are working to establish fire line around these two fires and hold the fire line already developed. Wind along the ridgetops will continue to challenge firefighting efforts. As these fires progress, pre-evacuation warnings are being issued to some residents in the areas of White Pine, Beaver Creek, and Little Beaver. All residents, please have an evacuation plan in place now and know what you would do in the event of an emergency. </p><p dir=\"ltr\" style=\"line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Cub Creek \u2013 371 acres: Firefighters will start direct and indirect line construction based on resource availability and priorities within the larger Highway 200 Complex. Much of the area surrounding this fire is roadless and will present access challenges to firefighters. The fire is expected to continue growing to the east, driven by winds. </p><p dir=\"ltr\" style=\"line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Deep Creek \u2013 529 acres: Firefighters will implement point protection strategies and look for opportunities to utilize direct tactics while minimizing firefighter exposure to hazards. Aircraft will continue to be utilized to keep the fire in check. The Cougar Peak Lookout is currently threatened but structure suppression actions have been implemented. With today\u2019s expected wind there is potential for spot fires over Graves Creek Road and Deep Creek. </p><p dir=\"ltr\" style=\"line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Moose Creek \u2013 234 acres: This fire is currently unstaffed due to limited resources, however, structure protection specialists assessed the area north of the fire to develop future suppression objectives if needed. </p><p dir=\"ltr\" style=\"line-height: 1.2; margin-top: 8.2pt; margin-bottom: 0pt;\">Miller Creek \u2013 84 acres: This fire is currently unstaffed due to limited resources. </p><br/></b></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T22:52:41-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Natural/ Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Monday August 28th, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">Highway 200 Corridor, near Thompson Falls, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Western Montana Incident Management Team,  Incident Commander- Rick Connell</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Fuels Involved</th><td class=\"cell3\"><p>Timber/Brush</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Late August 28th, the Plains and Thompson Falls, MT, areas experienced a lightning storm that ignited approximately 20 fires in the area. On August 29th, firefighters responded to and contained some of these fires. Seven of the fires, however, exceeded their initial attack efforts and have grown in size and severity. These fires include the Moose Peak, Miller Creek, Deep Creek, Reader, Reader 2, Cub Creek, and Sheep Gap Fires. To assist local resources, the Western Montana Type II Incident Management Team took command on Saturday evening and is managing these fires as a complex. Within this complex, the fires of greatest concern are the Sheep Gap and Reader Fires because they pose the most imminent threat to public safety.</p>\n<p></p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Projected Incident Activity</th><td class=\"cell3\"><p>The Sanders County Sheriff\u2019s Office is individually notifying residents within evacuation zones. As conditions change, the Sheriff\u2019s Office will be notifying affected residents by phone. So far, they have ordered several pre-evacuation warnings and implemented evacuations near the Sheep Gap Fire. East of Plains, mandatory evacuations are in place from the end of River Road West to Arnold Road, at the corner of Section 11. All residents in the Plains and Trout Creek areas should note that conditions are dynamic and will likely change quickly over the next few days. Please have an evacuation plan in place NOW for what you would do in the event of an emergency. Wildfires can grow very quickly and you may receive little to no notice before an evacuation takes place. </p>\n<p></p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p> Area closures are currently in place around the immediate fire areas and areas integral to safe fire operations. As hunting season continues, please respect area closures. The Forest Service is working to ensure that closures are kept to a minimum but are large enough for firefighter and public safety. Please see InciWeb and the Forest Service webpages for the latest closure area maps.  </p>\n<p></p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Today will be a critical fire weather day. A Red Flag Warning is in place from 12:00-9:00 PM. High temperatures and low humidity are expected to be record breaking for this time of year. Additionally, the fire area may experience gusty and erratic winds making fire behavior more intense and less predictable. As always, firefighter and public safety remain the top priority. The current management objective is to protect values at risk, such as private property and infrastructure, while utilizing the limited resources most effectively. Available resources, including crews, heavy equipment, and aerial resources are being shared between the fires so they can be utilized where they are most needed and have the highest probability of success. </p>\n<p></p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Location: Highway 200 corridor, near Thompson Falls, MTAgency Jurisdiction: Lolo and Kootenai National ForestsIncident Command: Western Montana Type II Incident Management Team, Incident Commander - Rick ConnellOverviewCurrent Status: Late August 28th, the Plains and Thompson Falls, MT, areas experienced a lightning storm that ignited approximately 20 fires in the area. On August 29th, firefighters responded to and contained some of these fires. Seven of the fires, however, exceeded their initial attack efforts and have grown in size and severity. These fires include the Moose Peak, Miller Creek, Deep Creek, Reader, Reader 2, Cub Creek, and Sheep Gap Fires. To assist local resources, the Western Montana Type II Incident Management Team took command on Saturday evening and is managing these fires as a complex. Within this complex, the fires of greatest concern are the Sheep Gap and Reader Fires because they pose the most imminent threat to public safety.Outlook: Today will be a...", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5583/", "type": "text/html", "rel": "alternate"}], "title": "Highway 200 Complex (Wildfire)", "geo_lat": "", "summary": "Location: Highway 200 corridor, near Thompson Falls, MTAgency Jurisdiction: Lolo and Kootenai National ForestsIncident Command: Western Montana Type II Incident Management Team, Incident Commander - Rick ConnellOverviewCurrent Status: Late August 28th, the Plains and Thompson Falls, MT, areas experienced a lightning storm that ignited approximately 20 fires in the area. On August 29th, firefighters responded to and contained some of these fires. Seven of the fires, however, exceeded their initial attack efforts and have grown in size and severity. These fires include the Moose Peak, Miller Creek, Deep Creek, Reader, Reader 2, Cub Creek, and Sheep Gap Fires. To assist local resources, the Western Montana Type II Incident Management Team took command on Saturday evening and is managing these fires as a complex. Within this complex, the fires of greatest concern are the Sheep Gap and Reader Fires because they pose the most imminent threat to public safety.Outlook: Today will be a...", "county": null, "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Highway 200 Complex (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5583/", "published": "Sat, 02 Sep 2017 22:52:41 -05:00", "geo_long": "-", "where": {}, "id": "https://inciweb.nwcg.gov/incident/5583/"}, "5379": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 2 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Sunrise Fire\";\r\n\tvar defLat =  47.036666666667;\r\n\tvar defLng =  -114.87888888889;\r\n\tvar defLon =  -114.87888888889;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  47.036666666667;\r\n\tvar detailLng =  -114.87888888889;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.037 latitude, -114.879 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><p><font color=\"#000000\">As fire activity in the Northern Rockies Region continues to increase, the Western Montana Team has been tasked with managing a complex of fires in the Thompson Falls and Plains area that will be known as the Highway 200 Complex. The Sunrise and Burdette fires are not included in that complex but will be managed by Connell\u2019s team. A Type 3 Southwest Montana All Hazard Incident Management Team will assist the Type 2 team and remain in the Superior area to continue suppression of the Sunrise Fire. <p style=\"margin: 8.2pt 0in 0pt 16pt;\"><font face=\"Times New Roman\" size=\"3\"> </font><b style=\"mso-bidi-font-weight: normal;\"><br/>Current Status: </b>The area between Quartz Creek and Fortysix Creek are still the most active area of the Sunrise Fire. The rugged area is being patrolled by firefighters on the ground and by air to make sure that no hot spots are detected in critical areas. Aircraft also continues to monitor the Burdette Fire daily and growth in acreage is not expected to occur. </p><p style=\"margin: 8.2pt 0in 0pt 16pt;\"><font face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 8.2pt 0in 0pt 16pt;\"><b style=\"mso-bidi-font-weight: normal;\">Outlook:</b> Suppression repair work continues all around the fire using heavy equipment to cover mechanized containment lines with the vegetation that was removed from the surface. Repair work was completed in the Cougar Gulch and Quartz Creek areas and residents were allowed back to their property. Personnel will continue to monitor the fire\u2019s activity and suppress hot spots or spot fires when necessary. </p><p style=\"margin: 8.2pt 0in 0pt 16pt;\"><font face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 8.2pt 0in 0pt 16pt;\"><b style=\"mso-bidi-font-weight: normal;\">Key Message:</b> Conditions continue to be hot and dry throughout the region. With the numerous fires that started from previous storms, resources are stretched thin. As you enjoy the area this Labor Day weekend please be mindful that Stage II Fire Restrictions are in place on the Lolo National Forest. </p><p style=\"margin: 8.2pt 0in 0pt 16pt;\"><font face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 8.2pt 0in 0pt 16pt;\"><b style=\"mso-bidi-font-weight: normal;\">Closures:</b> The Forest Service area closure remains in place for the areas immediately adjacent to Trout Creek road and around the fire area for firefighter and public safety. Some smoke may be seen as travelers pass through the Trout Creek road. Fire managers ask that the public traveling along the roadway do not stop and note that equipment and firefighters are still present in the area. </p><p style=\"margin: 8.2pt 0in 0pt 16pt;\"><font face=\"Times New Roman\" size=\"3\"> </font></p><p style=\"margin: 8.2pt 0in 0pt;\"> </p><p style=\"margin: 8.2pt 0in 0pt 16pt;\"><font face=\"Times New Roman\" size=\"3\"> </font></p></font><p style=\"margin: 8.2pt 0in 0pt 16pt;\"></p><font color=\"#000000\" face=\"Times New Roman\" size=\"3\"> </font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T20:46:03-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning/natural</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Sunday July 16th, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">11 miles southeast of Superior, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Rick Connell, Western Montana Type II IMT</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">35</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">25,975 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">90%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Monday October 30th, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber</p>\n<p>Closed Timber Litter</p>\n<p>Brush</p>\n<p>Fuel loading is variable and is dependent upon the aspect across the landscape. Primarily a surface fire burning in downed fuels. Fire scars to the west of the current fire perimeter and provide moderated fire behavior.   </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Today the fire made its way into an unburned pocket on the Division T/C break of the fire.  The fire made a run cleaning up this interior bowl, but also backed down closer to the primary containment line. Type 1 helicopters were used to hold it in check. </p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Continue skidding and decking logs along the contingency line. Finalize suppression repair to meet repair standards. Backhaul excess equipment. Monitor fire spread and check progression as appropriate. Patrol and mop up where needed to secure lines. Support the Lolo and Kootenai National Forests with suppression as needed on the Readers and Sheep Gap Fires.       </p>\n<p></p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>12 hours: Today, southwest portions of the fire remain the most active. Warm Dry and Breezy today with gusts up to 23 mph on ridgetops and aligned canyons. Fire continues to move on west and south facing slopes. Today the fire made a run on the South West flank of the fire in an interior bowl.  </p>\n<p>North: Div H/J</p>\n<p>Continued smoldering. Fire will continue to burn heavy downed fuels and stumps </p>\n<p>East: Div K/L/M</p>\n<p>Minimal fire activity anticipated. Fire will continue to burn heavy interior fuels</p>\n<p>South: Div T</p>\n<p>Continued ground fire in Fortysix and Quartz Creek basins.  Flanking and backing fire anticipated. West winds should push smoke over the black increasing visibility. </p>\n<p>Sunday- Hot and very dry conditions are forecasted with minimal to moderate fire behavior expected. Interior heavy fuels continue to consume on the north, east, and west.  The southwest portion of the fire Div T/C are expected to continue flanking and backing, but as shown today with, and with predicted winds and low humidity may hamper containment on the SW corner.</p>\n<p>Monday- Hot and very dry conditions are forecasted with minimal moderate fire behavior expected.  </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>An area closure remains in effect on the Lolo national Forest where fireline repairs are underway northwest of Trout Creek. </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>A strong high pressure over the fire area will result in hot and dry conditions.</p>\n<p>-Today (9-2): Hotter and drier conditions with a max temperature near 90 and a minimum RH in the mid teens. Winds 6-12 with gusts to 18 on ridgetops and upslope/upvalley 3-7. </p>\n<p>-Tomorrow,</p>\n<p>Temperatures warm to record highs by Sunday with very low afternoon relative humidity and increasingly poor nighttime humidity recovery.</p>\n<p>-Extended: Dry and warm conditions look to persist through the first half of next week as the high pressure ridge shifts slightly westward. No precipitation or significant cooling is anticipated. Gusty west winds with very warm and dry conditions will provide critical fire weather. </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "As fire activity in the Northern Rockies Region continues to increase, the Western Montana Team has been tasked with managing a complex of fires in the Thompson Falls and Plains area that will be known as the Highway 200 Complex. The Sunrise and Burdette fires are not included in that complex but will be managed by Connell\u2019s team. A Type 3 Southwest Montana All Hazard Incident Management Team will assist the Type 2 team and remain in the Superior area to continue suppression of the Sunrise Fire.  Current Status: The area between Quartz Creek and Fortysix Creek are still the most active area of the Sunrise Fire. The rugged area is being patrolled by firefighters on the ground and by air to make sure that no hot spots are detected in critical areas. Aircraft also continues to monitor the Burdette Fire daily and growth in acreage is not expected to occur.  Outlook: Suppression repair work continues all around the fire using heavy equipment to cover mechanized containment lines with the...", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5379/", "type": "text/html", "rel": "alternate"}], "title": "Sunrise Fire (Wildfire)", "geo_lat": "47.036666666667", "summary": "As fire activity in the Northern Rockies Region continues to increase, the Western Montana Team has been tasked with managing a complex of fires in the Thompson Falls and Plains area that will be known as the Highway 200 Complex. The Sunrise and Burdette fires are not included in that complex but will be managed by Connell\u2019s team. A Type 3 Southwest Montana All Hazard Incident Management Team will assist the Type 2 team and remain in the Superior area to continue suppression of the Sunrise Fire.  Current Status: The area between Quartz Creek and Fortysix Creek are still the most active area of the Sunrise Fire. The rugged area is being patrolled by firefighters on the ground and by air to make sure that no hot spots are detected in critical areas. Aircraft also continues to monitor the Burdette Fire daily and growth in acreage is not expected to occur.  Outlook: Suppression repair work continues all around the fire using heavy equipment to cover mechanized containment lines with the...", "county": "Mineral County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Sunrise Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5379/", "published": "Sat, 02 Sep 2017 20:46:03 -05:00", "geo_long": "-114.87888888889", "where": {"type": "Point", "coordinates": [-114.87888888889, 47.036666666667]}, "id": "https://inciweb.nwcg.gov/incident/5379/"}, "5313": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 7/19/2017</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"July Fire \";\r\n\tvar defLat =  47.908333333333;\r\n\tvar defLng =  -108.54805555556;\r\n\tvar defLon =  -108.54805555556;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  47.908333333333;\r\n\tvar detailLng =  -108.54805555556;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.908 latitude, -108.548 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Picture of updated July Fire perimeter map for July 15th\" src=\"https://inciweb.nwcg.gov/photos/MTMAD/2017-07-04-1308-July-Fire/highlight/2017_07_15-10.16.14.264-CDT.png\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTMAD/2017-07-04-1308-July-Fire/picts/2017_07_15-10.16.14.264-CDT.png\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTMAD/2017-07-04-1308-July-Fire/picts/2017_07_15-10.16.14.264-CDT.png\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p>Efforts transitioned to Emergency Stabilization &amp; Restoration to prevent potential flooding caused by future rain event rapid runoff from the fire area.</p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-07-19T18:44:50-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Suspected Human Caused</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Monday July 03rd, 2017 approx.   04:30 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">Zortman,MT, Landusky, MT, Southeast of Hays, MT and Southwest of Lodgepole, MT.</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Kevin Thell</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">16</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">11,699 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">100%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Wednesday July 19th, 2017 approx.   08:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Lodgepole and ponderosa pine timber with grasses. Open, rocky, and grassy areas that have mine rehabilitation activity have minimal fire behavior, but remain susceptible to spot fires. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p>Efforts transitioned to Emergency Stabilization &amp; Restoration to prevent potential flooding caused by future rain event rapid runoff from the fire area.    </p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Continue Emergency Stabilization &amp; Restoration efforts to prevent potential flooding caused by future rain event rapid runoff from the fire area. </p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p> </p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Efforts transitioned to Emergency Stabilization & Restoration to prevent potential flooding caused by future rain event rapid runoff from the fire", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5313/", "type": "text/html", "rel": "alternate"}], "title": "July Fire  (Wildfire)", "geo_lat": "47.908333333333", "summary": "Efforts transitioned to Emergency Stabilization & Restoration to prevent potential flooding caused by future rain event rapid runoff from the fire", "county": "Phillips County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "July Fire  (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5313/", "published": "Wed, 19 Jul 2017 18:44:50 -05:00", "geo_long": "-108.54805555556", "where": {"type": "Point", "coordinates": [-108.54805555556, 47.908333333333]}, "id": "https://inciweb.nwcg.gov/incident/5313/"}, "5364": {"content": "<div id=\"content\">\n<div id=\"modified\">INCIDENT UPDATED 1:10 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Sapphire Complex\";\r\n\tvar defLat =  46.562777777778;\r\n\tvar defLng =  -113.63416666667;\r\n\tvar defLon =  -113.63416666667;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  46.562777777778;\r\n\tvar detailLng =  -113.63416666667;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  46.563 latitude, -113.634 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><p><font size=\"4\">Mike Almas' Type 2 IMT began managing the Sapphire Complex (Little Hogback, Goat Creek, Sliderock Fires) Friday, August 25th. The complex includes parts of the Lolo National Forest and the Beaverhead-Deerlodge National Forest. The fires are burning in steep, rocky terrain between the Rock Creek Road and Upper Willow Creek drainage. Numerous pre-evacuation notices (Stage Yellow), as well as road and area closures remain in effect. No public access is allowed within the area closure boundary. See Sapphire Complex <a href=\"https://inciweb.nwcg.gov/incident/news/5364/\" target=\"_self\">daily updates</a> and <a href=\"https://inciweb.nwcg.gov/incident/maps/5364/\" target=\"_self\">maps</a> for more information.</font></p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T21:48:40-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Thursday July 13th, 2017 approx.   03:00 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">25 miles east of Missoula, south of I-90 in the Rock Creek drainage.</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Northern Rockies IMT2,  Mike Almas, IC</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Description</th><td class=\"cell2\">Lightning Ignited Fire Burning In Remote Terrain</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">358</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">40,658 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">53%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Tuesday October 31st, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Timber (Litter and Understory)</p>\n<p>Closed Timber Litter</p>\n<p>Tall Grass (2.5 feet)</p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Remarks</th><td class=\"cell3\"><p>The complex consists of the Goat Creek, Sliderock, and Little Hogback fires. </p>\n<p> </p>\n<p>&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;</p>\n<p>Stage 2 Fire Restrictions are in place for Bureau of Land Management (BLM), Private and State Lands in Granite County and the Lolo National Forest (Forest Service Land west of Sandstone Ridge)</p>\n<p>Stage 1 Fire Restrictions in place on the Beaverhead Deerlodge National Forest (Forest Service Land east of Sandstone Ridge) have been modified to also prohibit all campfires.</p>\n<p>For more information about fire restrictions, go to: http:firerestrictions.us</p>\n<p>&lt;&gt;&lt;&gt;&lt;&gt;&lt;&gt;</p>\n<p>Important \u2013 Drones are prohibited in the fire vicinity &amp; have the potential to shut down all air operations.</p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>Hot and dry conditions persisted across the region with high temperatures reaching into the upper 80s and lower 90s in the valleys and mid-80s in the higher elevations.  A very dry air mass brought minimum humidity down to between 10% and 15% with winds  out of the west at 12-16mph with gusts up to 25mph.  Winds are expected to continue Sunday with high temperatures in the lower 90s, a very low relative humidity, and an unstable air mass creating critical fire weather environment. </p>\n<p></p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Mike Almas' Type 2 IMT began managing the Sapphire Complex (Little Hogback, Goat Creek, Sliderock Fires) Friday, August 25th. The complex includes parts of the Lolo National Forest and the Beaverhead-Deerlodge National Forest. The fires are burning in steep, rocky terrain between the Rock Creek Road and Upper Willow Creek drainage. Numerous pre-evacuation notices (Stage Yellow), as well as road and area closures remain in effect. No public access is allowed within the area closure boundary. See Sapphire Complex daily updates and maps for more", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5364/", "type": "text/html", "rel": "alternate"}], "title": "Sapphire Complex (Wildfire)", "geo_lat": "46.562777777778", "summary": "Mike Almas' Type 2 IMT began managing the Sapphire Complex (Little Hogback, Goat Creek, Sliderock Fires) Friday, August 25th. The complex includes parts of the Lolo National Forest and the Beaverhead-Deerlodge National Forest. The fires are burning in steep, rocky terrain between the Rock Creek Road and Upper Willow Creek drainage. Numerous pre-evacuation notices (Stage Yellow), as well as road and area closures remain in effect. No public access is allowed within the area closure boundary. See Sapphire Complex daily updates and maps for more", "county": "Granite County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Sapphire Complex (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5364/", "published": "Sat, 02 Sep 2017 21:48:40 -05:00", "geo_long": "-113.63416666667", "where": {"type": "Point", "coordinates": [-113.63416666667, 46.562777777778]}, "id": "https://inciweb.nwcg.gov/incident/5364/"}, "5367": {"content": "<div id=\"content\">\n<h3 id=\"home_art_head\">NEWS RELEASE</h3><div id=\"home_art_text\"><p style=\"padding: 4px;\"><strong>Sucker Creek Road Opening Today, August 31, 2017</strong><br/>Effective August 31, 2017, Park Creek Fire closure has been adjusted to allow access to Sucker Creek <a class=\"more\" href=\"/incident/article/5367/39495/\">more</a></p></div><div id=\"modified\">INCIDENT UPDATED 12 HRS. AGO</div><h3>Approximate Location</h3><div>\n<!--  Commented out GoogleMaps API to change to ESRI Map Service\r\n\t\t\t<script type=\"text/javascript\"    src=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyDV7JiYnvlKzhGavFcXV7qhU28o4S8PC1k&sensor=false\">    </script>\r\n\t-->\n<script type=\"text/javascript\">\r\n\t\r\n\tvar toggleState = 1;\r\n\tvar gmap3;\r\n\tvar xml;\r\n\tvar mTypeid ;\r\n\tvar iname = \"Park Creek Fire\";\r\n\tvar defLat =  47.020833333333;\r\n\tvar defLng =  -112.69055555556;\r\n\tvar defLon =  -112.69055555556;\r\n\tvar defZom =  13;\r\n\t\r\n\tvar detailLat =  47.020833333333;\r\n\tvar detailLng =  -112.69055555556;\r\n\tvar ts = new Date().getTime(); //required when cache option is true\r\n\tvar cacheoption = \"\";\r\n\t//072715 change to use single fire perimeter when ActivePerimeterOverlay fails to render\r\n\tvar perimetersOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/GeoMAC-FSPortal.kml\";\r\n\tvar unitPerimetersOverlay = ' ';\r\n\tvar isSinglePerimeter = 0;\r\n\t//$complexPerimeter\r\n\tvar isComplexPerimeter = 0;\r\n\t//$unitPerimeters\r\n\tvar isUnitPerimeters = 0;\r\n\tvar isActivePerimeters = false;\r\n\tvar perimeterOverlay = \"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\";\r\n\t\t//PCR 06/12/12\r\n\t\t//Defect 5937: force no caching of ActiveFirePerimeters.kml by Goolge map rendering engine\r\n\t\t//add ?nocache=<timestamp> to the URL\r\n\tvar pOverlayURL = perimetersOverlay+cacheoption;\r\n\tvar pSinglePerimeterOverlayURL = perimeterOverlay+cacheoption;\r\n\t\r\n\tvar mapdiv = \"box_google_map\";\r\n\tvar markerIndex = 0;\r\n\tvar markers=[];\r\n\tvar infowindows=[];\r\n\tvar kmlActiveLayer;\r\n\tvar kmlSelectLayer;\r\n\tvar singleKmlLayer;\r\n\tvar kmlUnitLayers=[];\r\n\tvar kmlComplexLayers=[];\r\n\tvar unitLayerIndex = 0;\r\n\tvar complexLayerIndex = 0;\r\n\tvar numOverlays = 0;\r\n\t\r\n\r\n   \r\n   \r\n\r\n    function loadmap() {\r\n     //not supported in v3 if (GBrowserIsCompatible()) { \r\n     // }\r\n\t  \r\n\t  \tvar mapOptions = {\r\n\t  // Commented out the below to switch to the ESRI Service\r\n          // center: new google.maps.LatLng(defLat, defLng),\r\n\r\n          zoom: defZom,\r\n          panControl: true,\r\n\t\t  zoomControl: true,\r\n\t\t  mapTypeControl: true,\r\n\t\t  scaleControl: true,\r\n\t\t  streetViewControl: true,\r\n\t\t  overviewMapControl: true\r\n        };\r\n        gmap3 = new google.maps.Map(document.getElementById(mapdiv),  mapOptions);\r\n    \r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n\t\t\t\t\r\n\t\t\r\n\t\tloadKml();\r\n\t\t\r\n\t\t\r\n\t\t// Add the current incident point if it is set\r\n\t\tif (detailLat != 0) {\r\n\t\t\tvar detail = [];\r\n\t\t\tdetail[\"disable_click\"] = true;\r\n\t\t\tdetail[\"contained\"] =     0;\t\t\r\n\t\t\tdetail[\"name\"] =  iname  ;\r\n\t\t\tdetail[\"summary\"] = \"\"  ;\r\n\t\t\tdetail[\"url\"] = \"\" ;\r\n\t\t\tdetail[\"lat\"] = parseFloat(detailLat) ;\r\n\t\t\tdetail[\"lng\"] =  parseFloat(detailLng) ;\r\n\t\t\r\n\t\t\t\r\n     \t\tdetail[\"point\"]= new google.maps.LatLng(parseFloat(detailLat), parseFloat(detailLng));\r\n           \r\n     \t\t\r\n\t\t    createMarker(detail);\t\r\n\t\t\t\r\n\t\t}\t\r\n\t\tmTypeid = gmap3.getMapTypeId();\r\n\t\t//todo\r\n\t\tloadJson();\r\n\t\t\r\n\t\t\r\n\r\n    \r\n    }\r\n\t\r\n\tfunction loadJson() {\t\t\r\n\t\t// JSON Parser\t\r\n\t\tvar feedSource = \"/feeds/json/markers/\";\r\n\t\r\n\t\t $.ajax({\r\n\t\t\t    url: feedSource,\r\n\t\t\t    success: function(data){\r\n\t\t\t     try{\r\n\t\t\t\t     //console.log(\"feed \"+data);\r\n\t\t\t\t     //var jsonData = eval(\"(\" + data + \")\");\r\n\t\t\t\t     var jsonData = JSON.parse(data);\r\n\t\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < jsonData.markers.length; i++) {\t\t\t\r\n\t\t\t\t\t\t\tvar output = [];\t\t\t\r\n\t\t\t\t\t\t\toutput[\"name\"] =      jsonData.markers[i].name;\r\n\t\t\t\t\t\t\toutput[\"summary\"] =   jsonData.markers[i].summary;\r\n\t\t\t\t\t\t\toutput[\"url\"] =       jsonData.markers[i].url;\r\n\t\t\t\t\t\t\toutput[\"lat\"] =       Math.round(jsonData.markers[i].lat*100)/100;\r\n\t\t\t\t\t\t\toutput[\"lng\"] =       Math.round(jsonData.markers[i].lng*100)/100;\r\n\t\t\t\t\t\t\toutput[\"contained\"] = jsonData.markers[i].contained;\r\n\t\t\t\t\t\t\t//todo new google.maps.LatLng(defLat, defLng)\r\n\t\t\t\t\t\t\t//output[\"point\"] =     new GLatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t output[\"point\"] = new google.maps.LatLng(parseFloat(jsonData.markers[i].lat), parseFloat(jsonData.markers[i].lng));\r\n\t\t\t\t\t\t\t \r\n\t\t\t\t\t\t\t// skip over incident details point for current incident\r\n\t\t\t\t\t\t\tif (output[\"lat\"] != detailLat || output[\"lng\"] != detailLng) {\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\tvar marker = createMarker(output);\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t\t//if necessary createList of makers and windows if \r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (anErr){\r\n\t\t\t\t\t\tconsole.log(\"marker feed error \"+anErr);\r\n\t\t\t\t\t}\r\n\t\t\t   }\r\n \t\t\t });\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t}\r\n\r\n\t\t\r\n\tfunction loadKml() {\r\n\t\t\t//var kmlOptions = new google.maps.KmlLayerOptions();\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\tkmlActiveLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\r\n\t\t//In case you want to handle a KML mouse click event\r\n\t\t//google.maps.event.addListener(kmlActiveLayer, \"click\", function(kmlMouseEvent) {\r\n\t\t\t//google.maps.KmlMouseEvent\r\n \t\t\t //alert(\"You clicked a kml feature. \"+kmlMouseEvent.featureData); \t\t\t\r\n \t\t\r\n\t\t//});\r\n\t\tgoogle.maps.event.addListener(kmlActiveLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n \t\t\tconsole.log(\"Active Perimeter KML STATUS \"+kmlActiveLayer.getStatus()); \r\n \t\t\t//\r\n \t\t\tif (kmlActiveLayer.getStatus() == \"OK\"){\r\n \t\t\t\tisActivePerimeters = true;\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isSinglePerimeter){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadSinglePermiterKml(); \t\t\t\t\r\n \t\t\t}\t\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && isComplexPerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadComplexPermiterKmls(); \t\t\t\t\r\n \t\t\t}\r\n \t\t\tif (kmlActiveLayer.getStatus() != \"OK\" && !isComplexPerimeter && !isSinglePerimeter && isUnitPerimeters){\r\n \t\t\t\tkmlActiveLayer.setMap(null);\r\n \t\t\t\tloadUnitPermiterKmls(); \t\t\t\t\r\n \t\t\t}\t\t\r\n \t\t \r\n\t\t});\r\n\t\t\r\n\t}\r\n\t//call this when the ActiveFirePerimeters Overlay fails to render\r\n\t//this will render the single fire perimeter if one exists.\r\n\tfunction loadSinglePermiterKml(){\r\n\t\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl : pSinglePerimeterOverlayURL\r\n\t\t\t\t\t\t};\r\n\t\t\tsingleKmlLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\tnumOverlays++;\r\n\t\t\tgoogle.maps.event.addListener(singleKmlLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\tconsole.log(\"Single KML STATUS \"+this.status+\" complex=\"+isComplexPerimeter); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t});\t\r\n\t\t\t\r\n\t}\r\n\t\r\n\t//this will render all the perimeters for the unit and its neighbors\r\n\tfunction loadUnitPermiterKmls(){\r\n\t\t\t//var inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numUnitLayers =0;\r\n\t\t\tconsole.log(\"Unit KMLs load: =\"+numPerims);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\tx.id = \"unitperimetersid\";\r\n\t\t\tx.addEventListener(\"change\", addUnitLayerEvent);\t\t\r\n\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t//perimetersdescdiv\r\n\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\tpdes.innerHTML = \"<br><b>View nearby fire perimeters</b>\";\r\n\t\t\tpdiv.appendChild(x);\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-6);\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  console.log(\"Unit KML name to load: =\"+kmlname); \r\n\t\t\t\t  var option = document.createElement(\"option\");\r\n\t\t\t\t  option.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t  option.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  x.add(option);\r\n\t\t\t      if (numOverlays < 10){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlUnitLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlUnitLayers.push(kmlUnitLayer);\r\n\t\t\t\t\tnumUnitLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlUnitLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Unit KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\t\r\n\tfunction addUnitLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"unitperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlUnitLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\t\r\n\tfunction loadComplexPermiterKmls(){\r\n\t\t\tvar inameonly = iname.replace(\"Complex\",\"\");\r\n\t\t\tvar numPerims = unitPerimetersOverlay.length;\r\n\t\t\tvar numComplexLayers= 0;\r\n\t\t\tvar selectAdded = false;\r\n\t\t\tconsole.log(\"Complex KMLs load: complex=\"+isComplexPerimeter+\" \"+numPerims+\" \"+inameonly);\r\n\t\t\t//if (numPerims > 30){\r\n\t\t\t//\tnumPerims = 30;\r\n\t\t\t//}\r\n\t\t\tvar zoom=gmap3.getZoom();\r\n\t\t\tconsole.log(\"Unit KML :\"+zoom);\r\n\t\t\tgmap3.setZoom(zoom-3);\r\n\t\t\t\r\n\t\t\tfor (i = 0; i < numPerims; i++) { \r\n\t\t\t\t  var kmlname = decodeURIComponent(unitPerimetersOverlay[i]);\r\n\t\t\t\t  if (isComplexPerimeter && (kmlname.search(inameonly) > 0)){\r\n\t\t\t\t  \tif (!selectAdded){\r\n\t\t\t\t  \t\tselectAdded = true;\r\n\t\t\t\t  \t\tvar x = document.createElement(\"SELECT\");\t\r\n\t\t\t\t\t\tx.id = \"complexperimetersid\";\r\n\t\t\t\t\t\tx.addEventListener(\"change\", addComplexLayerEvent);\t\t\r\n\t\t\t\t\t\tvar pdiv = document.getElementById(\"perimetersdiv\");\r\n\t\t\t\t\t\tvar pdes = document.getElementById(\"perimetersdescdiv\");\r\n\t\t\t\t\t\tpdes.innerHTML = \"<br><b>View related fire perimeters</b>\";\r\n\t\t\t\t\t\tpdiv.appendChild(x);\r\n\t\t\t\t\t\t//remove single permiter\r\n\t\t\t\t\t\tsingleKmlLayer.setMap(null);\r\n\t\t\t\t  \t\t\r\n\t\t\t\t  \t}\r\n\t\t\t\t  \tvar option = document.createElement(\"option\");\r\n\t\t\t\t  \toption.text = kmlname.replace(\"https://rmgsc.cr.usgs.gov/outgoing/GeoMAC/\",\"\");\r\n\t\t\t\t \toption.value = unitPerimetersOverlay[i];\r\n\t\t\t\t  \tx.add(option);\r\n\t\t\t\t  \r\n\t\t\t\t  console.log(\"Complex KML name to load: =\"+kmlname+\" \"+kmlname.search(inameonly)); \r\n\t\t\t      if (numOverlays < 9){\r\n\t\t\t     \tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  unitPerimetersOverlay[i]\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\tvar kmlComplexLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\tkmlComplexLayers.push(kmlComplexLayer);\r\n\t\t\t\t\tconsole.log(\"Add Layer complex perimeter: \"+unitPerimetersOverlay[i]);\r\n\t\t\t\t\tnumComplexLayers++;\r\n\t\t\t\t\tnumOverlays++;\r\n\t\t\t\t\tgoogle.maps.event.addListener(kmlComplexLayer, \"status_changed\", function(kmlstatus) {\r\n\t\t\t\r\n\t\t \t\t\t\tconsole.log(\"Complex KML STATUS \"+this.status); \r\n\t\t \t\t\t\t\r\n\t\t \t\t\r\n\t\t\t\t\t});\t\r\n\t\t\t\t\t\r\n\t\t\t\t  }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\r\n\t\t\r\n\t}\r\n\tfunction addComplexLayerEvent(event){\r\n\t\tvar layer = event;\r\n\t\tvar kmlurl = document.getElementById(\"complexperimetersid\").value;\r\n\t\tif (kmlSelectLayer != null){\r\n\t\t\tkmlSelectLayer.setMap(null);\r\n\t\t}\r\n\t\tremoveKMLLayers(kmlComplexLayers);\r\n\t\tvar kmlOptions = {clickable:true,\r\n\t\t\t\t\t\tmap: gmap3,\r\n\t\t\t\t\t\tpreserveViewport: true,\r\n\t\t\t\t\t\tscreenOverlays: true,\r\n\t\t\t\t\t\tsuppressInfoWindows: false,\r\n\t\t\t\t\t\turl :  kmlurl\r\n\t\t\t\t\t\t};\r\n\t\tkmlSelectLayer = new google.maps.KmlLayer(kmlOptions);\r\n\t\t\t\t\t\r\n\t\tgoogle.maps.event.addListener(kmlSelectLayer, \"status_changed\", function(kmlstatus) {\t\t\r\n\t\t \tconsole.log(\"Add KML layer STATUS \"+this.status);\t \t\t\r\n\t\t});\t\r\n\t}\r\n\r\n\tfunction removeKMLLayers(layers){\r\n\t\tfor (i = 0; i < layers.length; i++) { \r\n    \t\tlayers[i].setMap(null);\r\n\t\t}\r\n\t}\r\n\tfunction makeIcon (input) {\r\n\t\t\r\n\t\tvar iconFlame = { \r\n\t\turl: \"/images/maps/flame.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\r\n\t\t\r\n\t\t/**/\r\n\t\tvar  iconSmoke = { \r\n\t\turl: \"/images/maps/smoke.png\",\r\n\t\tsize: new google.maps.Size(20, 34),\r\n\t\tscaledSize: new google.maps.Size(12, 20),\r\n\t\tanchor: new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\t\r\n\t\t\r\n\t\r\n\t\tvar customIcons = [];\r\n\t\tcustomIcons[\"0\"] = iconFlame;\r\n\t\tcustomIcons[\"1\"] = iconSmoke;\r\n\t\t\r\n\t\t\r\n\t\tvar icon = customIcons[input[\"contained\"]];\r\n\t\t\r\n\t\treturn icon;\r\n\t}\r\n\t\r\n\tfunction createMarker(input) {\t\t\r\n\t\r\n\t\tvar icon = makeIcon(input);\r\n\t\t/**/\r\n\t\tvar iconShadow = {\r\n\t\turl: \"http://labs.google.com/ridefinder/images/mm_20_shadow.png\",\r\n\t\tsize : new google.maps.Size(12, 10),\r\n\t\tanchor : new google.maps.Point(6, 20)\r\n\t\t};\r\n\t\tvar marker = new google.maps.Marker({\r\n            position: input.point,\r\n            icon :icon,\r\n            shadow : iconShadow,\r\n            flat: false,\r\n            title: input[\"name\"],\r\n            map: gmap3\r\n      \t\t});\r\n\t\t\r\n \r\n\t\tvar infwOptions = {\r\n \t\t\t \tcontent: formatTabOne(input),\r\n \t\t\t \tposition: input[\"point\"]\r\n\t\t\t\t};\r\n \t\tvar infw = new google.maps.InfoWindow(infwOptions);\r\n \t\t\r\n \t\tmarkers[markerIndex]=marker;\r\n \t\tinfowindows[markerIndex] = infw; \t\t\r\n \t\tmarkerIndex++;\r\n\t\t\r\n\t\tgoogle.maps.event.addListener(marker, \"click\", function() {\r\n \t\t\t //alert(\"You clicked the map. \"+infw.position);\r\n \t\t\t infw.open(gmap3,marker);\r\n \t\t\r\n\t\t});\r\n\t\t\r\n\r\n\t\t\r\n\t\treturn marker;\r\n\t}\r\n\t\t\t\r\n\tfunction formatTabOne (input) {\t\t\t\t\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p><strong><a href=\\\"\" + input[\"url\"] + \"\\\">\" + input[\"name\"] + \"</a></strong><br />\";\r\n\t\thtml \t\t+= \"Lat: \" + input[\"lat\"] + \"<br />\";\t\r\n\t\thtml \t\t+= \"Long: \" + input[\"lng\"] + \"</p>\";\t\t\t\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"</div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\t\r\n\tfunction formatTabTwo (input) {\r\n\t\tvar html \t = \"<div class=\\\"bubble\\\">\";\r\n\t\thtml \t\t+= \"<p>\" + input[\"summary\"] + \"</p>\";\r\n\t\thtml\t\t+= \"<p>\"\r\n\t\tif(input[\"acres\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Acres:</strong> \" + input[\"acres\"] + \"<br />\";\r\n\t\t}\t\t\r\n\t\tif(input[\"resources\"] != null) {\r\n\t\t\thtml \t+= \"<strong>Resources:</strong> \" + input[\"resources\"] + \"<br />\";\r\n\t\t}\r\n\t\thtml \t\t+= \"</p></div>\";\t\t\t\t\t\r\n\t\treturn html;\t\t\t\r\n\t}\r\n\t\r\n\tfunction resetMap() {\r\n      if (toggleState == 1) {\r\n        gmap3.setCenter(new google.maps.LatLng(defLat, defLng));\r\n        gmap3.setZoom(defZom);\r\n        gmap3.setMapTypeId(mTypeid);\r\n        var index;\r\n\t\t\r\n\t\tfor (index = 0; index < infowindows.length; ++index) {\r\n\t\t    //console.log(infowindows[index]);\r\n\t\t    var infow = infowindows[index];\r\n\t\t   \r\n\t\t    if (infow != null && typeof infow !== \"undefined\"){ \r\n\t\t    \tinfow.close();\r\n\t\t    }\r\n\t\t}\r\n\t\tvar nullMap = null;\r\n\t\t//clear the KML layer\r\n\t\tif (isActivePerimeters){\r\n\t\t\tkmlLayer.setMap(nullMap);\r\n\t\t\t//reset the KML layer\r\n\t\t\tkmlLayer.setMap(gmap3);\r\n\t\t}\r\n        toggleState = 0;\r\n      } else {\r\n        toggleState = 1;\r\n      }\r\n    }\r\n\t\r\n  \r\n  \r\n  </script>\r\n  \r\n  47.021 latitude, -112.691 longitude <input class=\"button\" onclick=\"resetMap();\" type=\"button\" value=\"zoom to incident\"/><div id=\"perimetersdescdiv\" style=\"display: inline;\"></div><div id=\"perimetersdiv\"></div><div class=\"tundra\" id=\"box_google_map\"></div></div><h3>Incident Overview</h3><div><div class=\"img_wrapper\" style=\"float:right; margin: 0 0 5px 10px;\"><img alt=\"Park Creek Public information map\" src=\"https://inciweb.nwcg.gov/photos/MTHLF/2017-07-15-1129-Park-Creek-Fire/highlight/2017_09_02-10.54.05.559-CDT.jpeg\"/><p><span class=\"bold\">Image options:</span> [ <a class=\"thickbox\" href=\"https://inciweb.nwcg.gov/photos/MTHLF/2017-07-15-1129-Park-Creek-Fire/picts/2017_09_02-10.54.05.559-CDT.jpeg\">Enlarge</a> ] [ <a href=\"https://inciweb.nwcg.gov/photos/MTHLF/2017-07-15-1129-Park-Creek-Fire/picts/2017_09_02-10.54.05.559-CDT.jpeg\" onmouseover=\"window.status=''; return true;\" target=\"_blank\" title=\"opens in new window\">Full Size</a> ]</p></div><p><font face=\"Arial\" size=\"2\"><b style=\"mso-bidi-font-weight: normal;\">Special Messages/Closures: </b> </font></p><p><font face=\"Arial\" size=\"2\"><u>Effective 8/31/2017, the closure has been adjusted to allow access to Sucker Creek Road.</u> To provide for firefighter and public safety during the fire, a temporary area closure of selected trails and roads remains place for the Park Creek Fire. There are no evacuations at this time.</font></p><font face=\"Arial\" size=\"2\"> </font><p><font face=\"Arial\" size=\"2\">Hunting season is upon the Helena Lewis and Clark National Forest. It will begin September 2. An area closure for public and firefighter safety is in place for the fire area. This will primarily affect Hunting Unit 281. The hunting unit is not closed. The only closures for this hunting unit are within the Park Creek Fire Closure and Alice Creek Fire Closure. Please be aware of these area closures when planning for hunting trips. More information about hunting units is available at: <a href=\"http://fwp.mt.gov/hunting/planahunt/\">http://fwp.mt.gov/hunting/planahunt/</a>. </font></p><font face=\"Arial\" size=\"2\"> </font><p><font face=\"Arial\" size=\"2\">The Helena-Lewis and Clark National Forest is in Stage 1 Fire Restrictions \u2013 Starting Saturday, September 2 at 12:01 AM, Stage 1 fire restrictions will be amended to ban all campfires. Smoking is prohibited outside of buildings, vehicles and developed recreation sites, unless you are in a 3-foot-diameter area cleared of all burnable vegetation.</font></p><font face=\"Arial\" size=\"2\"> </font><p><font face=\"Arial\" size=\"2\"><b style=\"mso-bidi-font-weight: normal;\">Fire Update and Fire Behavior: </b></font></p><font face=\"Arial\" size=\"2\"> </font><p><font face=\"Arial\" size=\"2\">Firefighters will continue mop-up operations to further secure lines. Fire activity is moderate and terrain driven with backing, creeping and occasional single tree torching. Steep, rugged terrain, large dead and down fuels and numerous snags continue to be the primary safety concerns for fire crews. </font><font face=\"Arial\"><u><font size=\"2\">The safety of fire personnel and human life remain the</font> highest priority.</u></font> </p></div><br style=\"clear: right;\"/><h4>Basic Information</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays basic incident information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Current as of</th><td class=\"cell3\"><script>var clientdate = new Date(\"2017-09-02T10:36:23-05:00\");document.write(clientdate.toLocaleString())</script></td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Type</th><td class=\"cell2\">Wildfire</td></tr><tr><th class=\"cell1\" scope=\"row\">Cause</th><td class=\"cell2\">Lightning/natural</td></tr><tr><th class=\"cell1\" scope=\"row\">Date of Origin</th><td class=\"cell2\">Friday July 14th, 2017 approx.   09:15 PM</td></tr><tr><th class=\"cell1\" scope=\"row\">Location</th><td class=\"cell2\">2 miles North of Lincoln, MT</td></tr><tr><th class=\"cell1\" scope=\"row\">Incident Commander</th><td class=\"cell2\">Rodney Weeks\nJerod Russell (T)</td></tr></table><h4>Current Situation</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays the situation information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Total Personnel</th><td class=\"cell3\">180</td></tr><tr><th class=\"cell1\" scope=\"row\">Size</th><td class=\"cell2\">13,693 Acres</td></tr><tr><th class=\"cell1\" scope=\"row\">Percent of Perimeter Contained</th><td class=\"cell2\">60%</td></tr><tr><th class=\"cell1\" scope=\"row\">Estimated Containment Date</th><td class=\"cell2\">Monday October 30th, 2017 approx.   12:00 AM</td></tr><tr><th class=\"cell1\" scope=\"row\">Fuels Involved</th><td class=\"cell2\"><p>Fire is burning in timber stands with high mortality with multiple snags and heavy dead and down fuels.</p></td></tr><tr><th class=\"cell1\" scope=\"row\">Significant Events</th><td class=\"cell2\"><p></p>\n<p>Pockets of interior, green vegetation continue to burn within containment lines.</p>\n<p>Steep rugged terrain, large dead fuels and numerous snags continue to be the primary safety concerns for fire crews. The safety of fire personnel and human life remain the highest priority. There has been minimal creeping, backing and smoldering.</p>\n<p></p></td></tr></table><h4>Outlook</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays outlook information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Planned Actions</th><td class=\"cell3\"><p>Crews will continue to hold and improve completed line. They will monitor for spread toward Management Action Points.</p>\n<p></p></td></tr><tr><th class=\"cell1\" scope=\"row\">Projected Incident Activity</th><td class=\"cell2\"><p>There has been moderate fire activity. With hotter and dryer conditions today's fire activity is expected to stay moderate. Interior smokes cannot be accessed due to danger of snags. </p></td></tr><tr><th class=\"cell1\" scope=\"row\">Remarks</th><td class=\"cell2\"><p>Arrastra Creek Fire and Park Creek Fire are now combined to be Park Creek Fire. All acreage and resource numbers have been added together and the containment has been adjusted to reflect percent containment of both fires</p>\n<p>An area closure is still in effect. An amendment to the Forest Order has been made to allow access to Copper Creek and Snowbank Lake. Sucker Creek Road is now open.</p>\n<p>Stage 1 Restrictions are in effect, with an amendment banning all camp fires in place, starting September 2 at 12:01 am. Smoking is restricted to vehicles, buildings and 3 foot areas void of vegetation.</p></td></tr></table><h4>Current Weather</h4><table cellpadding=\"0\" cellspacing=\"0\" class=\"data\" summary=\"This table displays weather information.\"><tr><th class=\"cell0\" scope=\"row\" style=\"width: 30%;\">Weather Concerns</th><td class=\"cell3\"><p>There is a red flag warning in effect from 3 pm this afternoon to 9 pm Monday for gusty winds, low humidity and the possibility of cold front wind shifts. </p>\n<p>Skies will remain mostly clear with continued very dry afternoon humidity, as temperatures warm to above normal again on Saturday. Winds will decrease into this weekend. </p>\n<p>A fire behavior analyst continues to monitor current weather and fire conditions.</p>\n<p></p></td></tr></table>\n</div>", "summary_detail": {"base": "", "type": "text/html", "value": "Special Messages/Closures:  Effective 8/31/2017, the closure has been adjusted to allow access to Sucker Creek Road. To provide for firefighter and public safety during the fire, a temporary area closure of selected trails and roads remains place for the Park Creek Fire. There are no evacuations at this time. Hunting season is upon the Helena Lewis and Clark National Forest. It will begin September 2. An area closure for public and firefighter safety is in place for the fire area. This will primarily affect Hunting Unit 281. The hunting unit is not closed. The only closures for this hunting unit are within the Park Creek Fire Closure and Alice Creek Fire Closure. Please be aware of these area closures when planning for hunting trips. More information about hunting units is available at: http://fwp.mt.gov/hunting/planahunt/.  The Helena-Lewis and Clark National Forest is in Stage 1 Fire Restrictions \u2013 Starting Saturday, September 2 at 12:01 AM, Stage 1 fire restrictions will be...", "language": null}, "published_parsed": null, "links": [{"href": "https://inciweb.nwcg.gov/incident/5367/", "type": "text/html", "rel": "alternate"}], "title": "Park Creek Fire (Wildfire)", "geo_lat": "47.020833333333", "summary": "Special Messages/Closures:  Effective 8/31/2017, the closure has been adjusted to allow access to Sucker Creek Road. To provide for firefighter and public safety during the fire, a temporary area closure of selected trails and roads remains place for the Park Creek Fire. There are no evacuations at this time. Hunting season is upon the Helena Lewis and Clark National Forest. It will begin September 2. An area closure for public and firefighter safety is in place for the fire area. This will primarily affect Hunting Unit 281. The hunting unit is not closed. The only closures for this hunting unit are within the Park Creek Fire Closure and Alice Creek Fire Closure. Please be aware of these area closures when planning for hunting trips. More information about hunting units is available at: http://fwp.mt.gov/hunting/planahunt/.  The Helena-Lewis and Clark National Forest is in Stage 1 Fire Restrictions \u2013 Starting Saturday, September 2 at 12:01 AM, Stage 1 fire restrictions will be...", "county": "Lewis and Clark County", "guidislink": false, "title_detail": {"base": "", "type": "text/plain", "value": "Park Creek Fire (Wildfire)", "language": null}, "link": "https://inciweb.nwcg.gov/incident/5367/", "published": "Sat, 02 Sep 2017 10:54:57 -05:00", "geo_long": "-112.69055555556", "where": {"type": "Point", "coordinates": [-112.69055555556, 47.020833333333]}, "id": "https://inciweb.nwcg.gov/incident/5367/"}}